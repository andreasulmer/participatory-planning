(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/layers/LayerView":1633,"esri/views/3d/layers/LayerView3D":1640,"esri/views/3d/layers/support/layerViewUpdatingProperties":1645,"esri/views/layers/support/popupUtils":1657,"esri/layers/graphics/data/QueryEngineCapabilities":1680,"esri/views/3d/layers/support/attributeUtils":1681,"esri/views/3d/layers/graphics/QueryEngine":1688,"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":1692,"esri/libs/draco/DracoDecoder":1735,"esri/views/3d/layers/graphics/Graphics3DFeatureLikeLayerView":1743,"esri/views/3d/layers/graphics/Graphics3DFilterVisibility":1744,"esri/layers/graphics/controllers/I3SOnDemandController":1750,"esri/views/3d/layers/i3s/I3SFrameTask":1751,"esri/views/3d/layers/i3s/I3SIndex":1752,"esri/views/3d/layers/i3s/I3SLodHandling":1753,"esri/views/3d/layers/i3s/I3SNodeLoader":1754,"esri/views/3d/layers/i3s/I3SMaterialUtil":1755,"esri/views/3d/layers/i3s/I3SStreamDataController":1756,"esri/views/3d/layers/i3s/I3SViewportQueries":1757,"esri/views/3d/layers/support/DefinitionExpressionSceneLayerView":1760,"esri/views/3d/layers/support/fieldProperties":1761,"esri/views/3d/layers/support/PopupSceneLayerView":1762,"esri/views/3d/layers/graphics/Graphics3DVerticalScale":1830,"esri/views/3d/layers/SceneLayerGraphicsView3D":2556,"esri/views/3d/support/GraphicsMap":2557})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1633:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(16),r(49),r(282),r(284),r(6),r(225),r(7),r(0)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d){return function(e){function t(t){var r=e.call(this)||this;return r.layer=null,r.parent=null,r}return r(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var r=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";return u.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+n+"', id: '"+r+"')",t),p.reject(t)}})},t.prototype.destroy=function(){this.layer=this.parent=null},Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},n([d.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),n([d.property()],t.prototype,"layer",void 0),n([d.property()],t.prototype,"parent",void 0),n([d.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),n([d.property({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],t.prototype,"updating",null),n([d.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),n([d.subclass("esri.views.layers.LayerView")],t)}(d.declared(a.HandleOwnerMixin(s.IdentifiableMixin(l.EsriPromiseMixin(o.EventedMixin(i))))))}.apply(null,n))||(e.exports=i)},1640:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(7),r(25),r(0),r(408)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0}),t.LayerView3D=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slicePlaneEnabled=!1,t.supportsHeightUnitConversion=!1,t}return r(t,e),t.prototype.destroy=function(){this.view=null},t.prototype.postscript=function(e){this.inherited(arguments),s.mayHaveHeightModelInfo(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())},t.prototype._validateHeightModelInfo=function(){var e=this;return i.create(function(t,r){o.whenFalseOnce(e.view.defaultsFromMap,"isHeightModelInfoSearching",function(){var n=s.rejectLayerError(e.layer,e.view.heightModelInfo,e.supportsHeightUnitConversion);n?r(n):t()})})},n([a.property()],t.prototype,"view",void 0),n([a.property()],t.prototype,"slicePlaneEnabled",void 0),n([a.subclass("esri.views.3d.layers.LayerView3D")],t)}(a.declared(e))}}.apply(null,n))||(e.exports=i)},1645:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updatingPercentageValue={value:100,readOnly:!0},t.updatingPercentage={dependsOn:["updating","updatingPercentageValue"],readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}}.apply(null,n))||(e.exports=i)},1657:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(11),r(229),r(9),r(117)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.getRequiredFields=function(e,t){return void 0===t&&(t=e.popupTemplate),n(this,void 0,void 0,function(){var n,s,u,l,p,d,c,h,f,y,_;return r(this,function(r){switch(r.label){case 0:return o.isSome(t)?[4,t.getRequiredFields(e.fields)]:[2,[]];case 1:return n=r.sent(),s=t.lastEditInfoEnabled,u=e.objectIdField,l=e.typeIdField,i.includes(n,"*")?[2,["*"]]:(d=a.fixFields,c=[e.fields],f=(h=n).concat,y=[[l]],(_=s)?[4,a.getFeatureEditFields(e)]:[3,3]);case 2:_=r.sent(),r.label=3;case 3:return(p=d.apply(void 0,c.concat([f.apply(h,y.concat([_||null]))])))&&u&&a.hasField(e.fields,u)&&-1===p.indexOf(u)&&p.push(u),[2,p]}})})},t.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:o.isSome(t)&&t.defaultPopupTemplateEnabled&&o.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}.apply(null,n))||(e.exports=i)},1680:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,n))||(e.exports=i)},1681:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.attributeLookup=function(e,t){for(var r=t.toLowerCase(),n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];if(o.toLowerCase()===r)return e[o]}return null}}.apply(null,n))||(e.exports=i)},1688:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(2),r(10),r(11),r(36),r(16),r(9),r(0),r(37),r(1679),r(1575),r(402)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d,c,h){Object.defineProperty(t,"__esModule",{value:!0});var f=d.default,y=function(e){function t(t){var r=e.call(this)||this;return r._dataQueryEngineInstance=null,r}return n(t,e),Object.defineProperty(t.prototype,"queryGeometryType",{get:function(){switch(this.layer.geometryType){case"multipoint":case"point":case"polygon":case"polyline":return this.layer.geometryType;case"mesh":return"polygon";default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultQueryJSON",{get:function(){return new h({outSpatialReference:this.spatialReference}).toJSON()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataQueryEngine",{get:function(){return this.ensureDataQueryEngine()},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.clear()},t.prototype.clear=function(){return!!this._dataQueryEngineInstance&&(this._dataQueryEngineInstance.destroy(),this._dataQueryEngineInstance=null,!0)},t.prototype.executeQueryForIdSet=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.dataQueryEngine.executeQueryForIdSet(this._ensureQueryJSON(e),t)]})})},t.prototype.executeQueryForCount=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(e),t)]})})},t.prototype.executeQueryForExtent=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,a;return i(this,function(i){switch(i.label){case 0:return[4,this.dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(e),t)];case 1:return r=i.sent(),n=r.count,o=r.extent,a=p.fromJSON(o),[2,{count:n,extent:a}]}})})},t.prototype.executeQueryForIds=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(e),t)]})})},t.prototype.executeQuery=function(e,t){return o(this,void 0,void 0,function(){var r,n,o=this;return i(this,function(i){switch(i.label){case 0:return[4,this.dataQueryEngine.executeQuery(this._ensureQueryJSON(e),t)];case 1:return r=i.sent(),(n=c.fromJSON(r)).features.forEach(function(e){e.layer=o.layer,e.sourceLayer=o.layer}),[2,n]}})})},t.prototype._ensureQueryJSON=function(e){return u.isNone(e)?this.defaultQueryJSON:("outSpatialReference"in e&&!e.outSpatialReference&&(e.outSpatialReference=this.spatialReference),e.toJSON())},t.prototype.ensureDataQueryEngine=function(){if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;var e="timeInfo"in this.layer&&this.layer.timeInfo&&this.layer.timeInfo.toJSON()||null,t=this.layer.objectIdField,r=a.featureGeometryTypeKebabDictionary.toJSON(this.queryGeometryType),n=this.layer.fields.map(function(e){return e.toJSON()}),i=this.layerView.view.resourceController.scheduler,o=this.task,s=this.spatialReference.toJSON(),u=this.layerView.graphics3d.graphicsCore.featureStore,l=this.layerView,p=l.hasZ,d=l.hasM;return this._dataQueryEngineInstance=new f({hasZ:p,hasM:d,geometryType:r,fields:n,timeInfo:e,spatialReference:s,objectIdField:t,featureStore:u,scheduler:i,task:o}),this._dataQueryEngineInstance},r([l.property({constructOnly:!0})],t.prototype,"layerView",void 0),r([l.property({constructOnly:!0})],t.prototype,"task",void 0),r([l.property({readOnly:!0,aliasOf:"layerView.view.spatialReference"})],t.prototype,"spatialReference",void 0),r([l.property({readOnly:!0,aliasOf:"layerView.layer"})],t.prototype,"layer",void 0),r([l.property({readOnly:!0,dependsOn:["layer.geometryType"]})],t.prototype,"queryGeometryType",null),r([l.property({readOnly:!0,dependsOn:["spatialReference"]})],t.prototype,"defaultQueryJSON",null),r([l.subclass("esri.views.3d.layers.graphics.QueryEngine")],t)}(l.declared(s));t.QueryEngine=y,t.default=y}.apply(null,n))||(e.exports=i)},1692:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(16),r(22),r(25),r(0),r(56),r(656),r(145)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p){var d=-.3*u.earthRadius;return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suspended=!1,t.extent=null,t.extentIntersectionDirty=!0,t._isVisibleBelowSurface=!1,t.handles=new o,t.layerView=null,t.updating=!0,t}return r(t,e),t.prototype.setup=function(e){var t=this;this.layerView=e,this.extentIntersection=new l.FrustumExtentIntersection({renderCoordsHelper:e.view.renderCoordsHelper});var r=e.view,n=r.basemapTerrain,i=r.resourceController.scheduler;this.handles.add([r.on("resize",function(){return t.viewChange()}),r.state.watch("camera",function(){return t.viewChange()},!0),i.registerTask(p.Task.FRUSTUM_VISIBILITY,function(){return t.update()},function(){return t.updating}),n.on("elevation-bounds-change",function(){return t.elevationBoundsChange()})]),"local"===r.viewingMode?this.isVisibleBelowSurface=!0:this.handles.add([a.init(n,["opacity","wireframe"],function(){return t.updateIsVisibleBelowSurface()}),a.init(r,"map.ground.navigationConstraint.type",function(){return t.updateIsVisibleBelowSurface()})])},t.prototype.destroy=function(){this.layerView=null,this.extent=null,this.extentIntersection=null,this.handles&&(this.handles.destroy(),this.handles=null)},t.prototype._setDirty=function(){this.updating||this._set("updating",!0)},t.prototype.setExtent=function(e){this.extent=e,this.extentIntersectionDirty=!0,this._setDirty()},t.prototype.viewChange=function(){this._setDirty()},t.prototype.elevationBoundsChange=function(){this._setDirty(),this.extentIntersectionDirty=!0},Object.defineProperty(t.prototype,"isVisibleBelowSurface",{set:function(e){this._isVisibleBelowSurface=e,this._setDirty(),this.extentIntersectionDirty=!0},enumerable:!0,configurable:!0}),t.prototype.updateIsVisibleBelowSurface=function(){var e=this.layerView.view,t=e.basemapTerrain,r="local"===e.viewingMode,n=e.map.ground&&e.map.ground.navigationConstraint&&"none"===e.map.ground.navigationConstraint.type;this.isVisibleBelowSurface=r||!t.isOpaque()||n},t.prototype.updateExtentIntersection=function(){if(this.extentIntersectionDirty){this.extentIntersectionDirty=!1;var e,t=this.layerView.view;if(this._isVisibleBelowSurface)e=d;else{var r=t.basemapTerrain.elevationBounds,n=r.min,i=r.max;e=n-Math.max(1,(i-n)*(1.2-1))}this.extentIntersection.update(this.extent,t.spatialReference,e)}},t.prototype.update=function(){if(this._set("updating",!1),this.extent){this.updateExtentIntersection();var e=this.layerView.view.frustum;this._set("suspended",!this.extentIntersection.isVisibleInFrustum(e))}else this._set("suspended",!1)},n([s.property({readOnly:!0})],t.prototype,"suspended",void 0),n([s.property({readOnly:!0})],t.prototype,"updating",void 0),n([s.subclass("esri.views.3d.layers.graphics.Graphics3DFrustumVisibility")],t)}(s.declared(i))}.apply(null,n))||(e.exports=i)},1735:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(18),r(7),r(1736)],void 0===(i=function(e,t,n,i,o){function a(){return!!n("esri-wasm")}function s(){return e.toUrl("./draco_decoder.wasm")}var u,l;Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(o),t.isSupported=a,t.getDecoderModule=function(){return a()?(u||(u=i.create(function(e,t){return Promise.resolve().then(function(){var t=[r(1736)];(function(t){l=t({locateFile:s}),e(l)}).apply(null,t)}).catch(r.oe)}).catch(function(e){return i.reject(e)})),u):i.reject(new Error("Draco decompression not available, missing WebAssembly support"))}}.apply(null,n))||(e.exports=i)},1736:function(e,t,r){(function(t){var n=function(){var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return function(n){function i(e,t){e||g("Assertion failed: "+t)}function o(e,t){return e?function(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.subarray&&pe)return pe.decode(e.subarray(t,i));for(var o="";t<i;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var u=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|u:(7&a)<<18|s<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var l=a-65536;o+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}(se,e,t):""}function a(e,t){return e%t>0&&(e+=t-e%t),e}function s(){k.HEAP8=ae=new Int8Array(oe),k.HEAP16=new Int16Array(oe),k.HEAP32=ue=new Int32Array(oe),k.HEAPU8=se=new Uint8Array(oe),k.HEAPU16=new Uint16Array(oe),k.HEAPU32=new Uint32Array(oe),k.HEAPF32=new Float32Array(oe),k.HEAPF64=new Float64Array(oe)}function u(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?k.dynCall_v(r):k.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}function l(e){ce.unshift(e)}function p(e){ye.unshift(e)}function d(e){return String.prototype.startsWith?e.startsWith(ve):0===e.indexOf(ve)}function c(){try{if(k.wasmBinary)return new Uint8Array(k.wasmBinary);if(k.readBinary)return k.readBinary(xe);throw"both async and sync fetching of the wasm failed"}catch(e){g(e)}}function h(e){function t(e,t){var r=e.exports;k.asm=r,function(e){if(me--,k.monitorRunDependencies&&k.monitorRunDependencies(me),0==me&&(null!==ge&&(clearInterval(ge),ge=null),be)){var t=be;be=null,t()}}()}function r(e){t(e.instance)}function n(e){(k.wasmBinary||!Z&&!K||"function"!=typeof fetch?new Promise(function(e,t){e(c())}):fetch(xe,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+xe+"'";return e.arrayBuffer()}).catch(function(){return c()})).then(function(e){return WebAssembly.instantiate(e,i)}).then(e,function(e){re("failed to asynchronously prepare wasm: "+e),g(e)})}var i={env:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:ne};if(me++,k.monitorRunDependencies&&k.monitorRunDependencies(me),k.instantiateWasm)try{return k.instantiateWasm(i,t)}catch(e){return re("Module.instantiateWasm callback failed with error: "+e),!1}return k.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||d(xe)||"function"!=typeof fetch?n(r):WebAssembly.instantiateStreaming(fetch(xe,{credentials:"same-origin"}),i).then(r,function(e){re("wasm streaming compile failed: "+e),re("falling back to ArrayBuffer instantiation"),n(r)}),{}}function f(){return!!f.uncaught_exception}function y(){return ae.length}function _(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function m(e){function t(){k.calledRun||(k.calledRun=!0,le||(_e||(_e=!0,u(he)),u(fe),k.onRuntimeInitialized&&k.onRuntimeInitialized(),function(){if(k.postRun)for("function"==typeof k.postRun&&(k.postRun=[k.postRun]);k.postRun.length;)p(k.postRun.shift());u(ye)}()))}e=e||k.arguments,me>0||(function(){if(k.preRun)for("function"==typeof k.preRun&&(k.preRun=[k.preRun]);k.preRun.length;)l(k.preRun.shift());u(ce)}(),me>0||k.calledRun||(k.setStatus?(k.setStatus("Running..."),setTimeout(function(){setTimeout(function(){k.setStatus("")},1),t()},1)):t()))}function g(e){throw k.onAbort&&k.onAbort(e),void 0!==e?(te(e),re(e),e=JSON.stringify(e)):e="",le=!0,1,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}function b(){}function v(e){return(e||b).__cache__}function x(e,t){var r=v(t),n=r[e];return n||((n=Object.create((t||b).prototype)).ptr=e,r[e]=n)}function A(e){if("string"==typeof e){var t=function(e,t,r){var n=r>0?r:function(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++r)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}(e)+1,i=new Array(n),o=function(e,t,r,n){if(!(n>0))return 0;for(var i=r,o=r+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(r>=o)break;t[r++]=s}else if(s<=2047){if(r+1>=o)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(r+2>=o)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(r+3>=o)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-i}(e,i,0,i.length);return t&&(i.length=o),i}(e),r=nn.alloc(t,ae);return nn.copy(t,ae,r),r}return e}function w(){throw"cannot construct a Status, no constructor in IDL"}function I(){this.ptr=Gt(),v(I)[this.ptr]=this}function D(){this.ptr=Er(),v(D)[this.ptr]=this}function S(){this.ptr=Wt(),v(S)[this.ptr]=this}function E(){this.ptr=Bt(),v(E)[this.ptr]=this}function P(){this.ptr=De(),v(P)[this.ptr]=this}function C(){this.ptr=mr(),v(C)[this.ptr]=this}function O(){this.ptr=Re(),v(O)[this.ptr]=this}function N(){this.ptr=Ce(),v(N)[this.ptr]=this}function F(){this.ptr=Ft(),v(F)[this.ptr]=this}function T(){this.ptr=dr(),v(T)[this.ptr]=this}function M(){this.ptr=At(),v(M)[this.ptr]=this}function R(){this.ptr=mt(),v(R)[this.ptr]=this}function V(){this.ptr=Xt(),v(V)[this.ptr]=this}function G(){this.ptr=je(),v(G)[this.ptr]=this}function j(){this.ptr=ke(),v(j)[this.ptr]=this}function L(){this.ptr=er(),v(L)[this.ptr]=this}function U(){throw"cannot construct a VoidPtr, no constructor in IDL"}function q(){this.ptr=Et(),v(q)[this.ptr]=this}function B(){this.ptr=fr(),v(B)[this.ptr]=this}var k=void 0!==(n=n||{})?n:{},Q=!1,z=!1;k.onRuntimeInitialized=function(){Q=!0,z&&"function"==typeof k.onModuleLoaded&&k.onModuleLoaded(k)},k.onModuleParsed=function(){z=!0,Q&&"function"==typeof k.onModuleLoaded&&k.onModuleLoaded(k)},k.isVersionSupported=function(e){if("string"!=typeof e)return!1;var t=e.split(".");return!(t.length<2||t.length>3)&&(1==t[0]&&t[1]>=0&&t[1]<=3||!(0!=t[0]||t[1]>10))};var H,W={};for(H in k)k.hasOwnProperty(H)&&(W[H]=k[H]);k.arguments=[],k.thisProgram="./this.program",k.quit=function(e,t){throw t},k.preRun=[],k.postRun=[];var J,Y,Z=!1,K=!1;Z="object"==typeof window,K="function"==typeof importScripts,J="object"==typeof process&&!Z&&!K,Y=!Z&&!J&&!K;var X,$,ee="";J?(ee=t+"/",k.read=function(e,t){var n;return X||(X=r(1737)),$||($=r(1738)),e=$.normalize(e),n=X.readFileSync(e),t?n:n.toString()},k.readBinary=function(e){var t=k.read(e,!0);return t.buffer||(t=new Uint8Array(t)),i(t.buffer),t},process.argv.length>1&&(k.thisProgram=process.argv[1].replace(/\\/g,"/")),k.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof _))throw e}),process.on("unhandledRejection",g),k.quit=function(e){process.exit(e)},k.inspect=function(){return"[Emscripten Module object]"}):Y?("undefined"!=typeof read&&(k.read=function(e){return read(e)}),k.readBinary=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(i("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?k.arguments=scriptArgs:void 0!==arguments&&(k.arguments=arguments),"function"==typeof quit&&(k.quit=function(e){quit(e)})):(Z||K)&&(K?ee=self.location.href:document.currentScript&&(ee=document.currentScript.src),e&&(ee=e),ee=0!==ee.indexOf("blob:")?ee.substr(0,ee.lastIndexOf("/")+1):"",k.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},K&&(k.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),k.readAsync=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)},k.setWindowTitle=function(e){document.title=e});var te=k.print||("undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null),re=k.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||te);for(H in W)W.hasOwnProperty(H)&&(k[H]=W[H]);W=void 0;var ne={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0),"object"!=typeof WebAssembly&&re("no native wasm support detected");var ie,oe,ae,se,ue,le=!1,pe="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,de=("undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),k.TOTAL_MEMORY||16777216);de<5242880&&re("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+de+"! (TOTAL_STACK=5242880)"),k.buffer?oe=k.buffer:"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(ie=new WebAssembly.Memory({initial:de/65536}),oe=ie.buffer):oe=new ArrayBuffer(de),s(),ue[4088]=5259264;var ce=[],he=[],fe=[],ye=[],_e=!1,me=0,ge=null,be=null;k.preloadedImages={},k.preloadedAudios={};var ve="data:application/octet-stream;base64,",xe="draco_decoder.wasm";d(xe)||(xe=function(e){return k.locateFile?k.locateFile(e,ee):ee+e}(xe)),k.asm=function(e,t,r){return t.memory=ie,t.table=new WebAssembly.Table({initial:490,maximum:490,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0,h(t)};var Ae={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||Ae.infos[e])return e;for(var t in Ae.infos)for(var r=+t,n=Ae.infos[r].adjusted,i=n.length,o=0;o<i;o++)if(n[o]===e)return r;return e},addRef:function(e){e&&Ae.infos[e].refcount++},decRef:function(e){if(e){var t=Ae.infos[e];i(t.refcount>0),t.refcount--,0!==t.refcount||t.rethrown||(t.destructor&&k.dynCall_vi(t.destructor,e),delete Ae.infos[e],function(e){try{tn(e)}catch(e){}}(e))}},clearRef:function(e){e&&(Ae.infos[e].refcount=0)}},we={e:g,d:function(e){return rn(e)},k:function(){throw le=!0,"Pure virtual function called!"},c:function(e,t,r){throw Ae.infos[e]={ptr:e,adjusted:[e],type:t,destructor:r,refcount:0,caught:!1,rethrown:!1},Ae.last=e,"uncaught_exception"in f?f.uncaught_exception++:f.uncaught_exception=1,e},f:function(e){return k.___errno_location&&(ue[k.___errno_location()>>2]=e),e},b:function(){k.abort()},j:y,i:function(e,t,r){se.set(se.subarray(t,t+r),e)},h:function(e){var t=y();if(e>2147418112)return!1;for(var r=Math.max(t,16777216);r<e;)r=r<=536870912?a(2*r,65536):Math.min(a((3*r+2147483648)/4,65536),2147418112);return!!function(e){e=a(e,65536);var t=oe.byteLength;try{return-1!==ie.grow((e-t)/65536)&&(oe=ie.buffer,!0)}catch(e){return!1}}(r)&&(s(),!0)},g:function(){g("trap!")},l:function(e){g("OOM")},a:16352},Ie=k.asm({},we,oe);k.asm=Ie;var De=k._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=function(){return k.asm.m.apply(null,arguments)},Se=k._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=function(){return k.asm.n.apply(null,arguments)},Ee=k._emscripten_bind_AttributeOctahedronTransform___destroy___0=function(){return k.asm.o.apply(null,arguments)},Pe=k._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=function(){return k.asm.p.apply(null,arguments)},Ce=k._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=function(){return k.asm.q.apply(null,arguments)},Oe=k._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=function(){return k.asm.r.apply(null,arguments)},Ne=k._emscripten_bind_AttributeQuantizationTransform___destroy___0=function(){return k.asm.s.apply(null,arguments)},Fe=k._emscripten_bind_AttributeQuantizationTransform_min_value_1=function(){return k.asm.t.apply(null,arguments)},Te=k._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=function(){return k.asm.u.apply(null,arguments)},Me=k._emscripten_bind_AttributeQuantizationTransform_range_0=function(){return k.asm.v.apply(null,arguments)},Re=k._emscripten_bind_AttributeTransformData_AttributeTransformData_0=function(){return k.asm.w.apply(null,arguments)},Ve=k._emscripten_bind_AttributeTransformData___destroy___0=function(){return k.asm.x.apply(null,arguments)},Ge=k._emscripten_bind_AttributeTransformData_transform_type_0=function(){return k.asm.y.apply(null,arguments)},je=k._emscripten_bind_DecoderBuffer_DecoderBuffer_0=function(){return k.asm.z.apply(null,arguments)},Le=k._emscripten_bind_DecoderBuffer_Init_2=function(){return k.asm.A.apply(null,arguments)},Ue=k._emscripten_bind_DecoderBuffer___destroy___0=function(){return k.asm.B.apply(null,arguments)},qe=k._emscripten_bind_Decoder_DecodeBufferToMesh_2=function(){return k.asm.C.apply(null,arguments)},Be=k._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=function(){return k.asm.D.apply(null,arguments)},ke=k._emscripten_bind_Decoder_Decoder_0=function(){return k.asm.E.apply(null,arguments)},Qe=k._emscripten_bind_Decoder_GetAttributeByUniqueId_2=function(){return k.asm.F.apply(null,arguments)},ze=k._emscripten_bind_Decoder_GetAttributeFloatArrayForAllPoints_4=function(){return k.asm.G.apply(null,arguments)},He=k._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=function(){return k.asm.H.apply(null,arguments)},We=k._emscripten_bind_Decoder_GetAttributeFloat_3=function(){return k.asm.I.apply(null,arguments)},Je=k._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=function(){return k.asm.J.apply(null,arguments)},Ye=k._emscripten_bind_Decoder_GetAttributeIdByName_2=function(){return k.asm.K.apply(null,arguments)},Ze=k._emscripten_bind_Decoder_GetAttributeId_2=function(){return k.asm.L.apply(null,arguments)},Ke=k._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=function(){return k.asm.M.apply(null,arguments)},Xe=k._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=function(){return k.asm.N.apply(null,arguments)},$e=k._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=function(){return k.asm.O.apply(null,arguments)},et=k._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=function(){return k.asm.P.apply(null,arguments)},tt=k._emscripten_bind_Decoder_GetAttributeMetadata_2=function(){return k.asm.Q.apply(null,arguments)},rt=k._emscripten_bind_Decoder_GetAttributeUInt16ArrayForAllPoints_4=function(){return k.asm.R.apply(null,arguments)},nt=k._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=function(){return k.asm.S.apply(null,arguments)},it=k._emscripten_bind_Decoder_GetAttributeUInt32ArrayForAllPoints_4=function(){return k.asm.T.apply(null,arguments)},ot=k._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=function(){return k.asm.U.apply(null,arguments)},at=k._emscripten_bind_Decoder_GetAttributeUInt8ArrayForAllPoints_4=function(){return k.asm.V.apply(null,arguments)},st=k._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=function(){return k.asm.W.apply(null,arguments)},ut=k._emscripten_bind_Decoder_GetAttribute_2=function(){return k.asm.X.apply(null,arguments)},lt=k._emscripten_bind_Decoder_GetEncodedGeometryType_1=function(){return k.asm.Y.apply(null,arguments)},pt=k._emscripten_bind_Decoder_GetFaceFromMesh_3=function(){return k.asm.Z.apply(null,arguments)},dt=k._emscripten_bind_Decoder_GetMetadata_1=function(){return k.asm._.apply(null,arguments)},ct=k._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=function(){return k.asm.$.apply(null,arguments)},ht=k._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=function(){return k.asm.aa.apply(null,arguments)},ft=k._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=function(){return k.asm.ba.apply(null,arguments)},yt=k._emscripten_bind_Decoder_SkipAttributeTransform_1=function(){return k.asm.ca.apply(null,arguments)},_t=k._emscripten_bind_Decoder___destroy___0=function(){return k.asm.da.apply(null,arguments)},mt=k._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=function(){return k.asm.ea.apply(null,arguments)},gt=k._emscripten_bind_DracoFloat32Array_GetArray_2=function(){return k.asm.fa.apply(null,arguments)},bt=k._emscripten_bind_DracoFloat32Array_GetValue_1=function(){return k.asm.ga.apply(null,arguments)},vt=k._emscripten_bind_DracoFloat32Array___destroy___0=function(){return k.asm.ha.apply(null,arguments)},xt=k._emscripten_bind_DracoFloat32Array_size_0=function(){return k.asm.ia.apply(null,arguments)},At=k._emscripten_bind_DracoInt16Array_DracoInt16Array_0=function(){return k.asm.ja.apply(null,arguments)},wt=k._emscripten_bind_DracoInt16Array_GetArray_2=function(){return k.asm.ka.apply(null,arguments)},It=k._emscripten_bind_DracoInt16Array_GetValue_1=function(){return k.asm.la.apply(null,arguments)},Dt=k._emscripten_bind_DracoInt16Array___destroy___0=function(){return k.asm.ma.apply(null,arguments)},St=k._emscripten_bind_DracoInt16Array_size_0=function(){return k.asm.na.apply(null,arguments)},Et=k._emscripten_bind_DracoInt32Array_DracoInt32Array_0=function(){return k.asm.oa.apply(null,arguments)},Pt=k._emscripten_bind_DracoInt32Array_GetArray_2=function(){return k.asm.pa.apply(null,arguments)},Ct=k._emscripten_bind_DracoInt32Array_GetValue_1=function(){return k.asm.qa.apply(null,arguments)},Ot=k._emscripten_bind_DracoInt32Array___destroy___0=function(){return k.asm.ra.apply(null,arguments)},Nt=k._emscripten_bind_DracoInt32Array_size_0=function(){return k.asm.sa.apply(null,arguments)},Ft=k._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return k.asm.ta.apply(null,arguments)},Tt=k._emscripten_bind_DracoInt8Array_GetArray_2=function(){return k.asm.ua.apply(null,arguments)},Mt=k._emscripten_bind_DracoInt8Array_GetValue_1=function(){return k.asm.va.apply(null,arguments)},Rt=k._emscripten_bind_DracoInt8Array___destroy___0=function(){return k.asm.wa.apply(null,arguments)},Vt=k._emscripten_bind_DracoInt8Array_size_0=function(){return k.asm.xa.apply(null,arguments)},Gt=k._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=function(){return k.asm.ya.apply(null,arguments)},jt=k._emscripten_bind_DracoUInt16Array_GetArray_2=function(){return k.asm.za.apply(null,arguments)},Lt=k._emscripten_bind_DracoUInt16Array_GetValue_1=function(){return k.asm.Aa.apply(null,arguments)},Ut=k._emscripten_bind_DracoUInt16Array___destroy___0=function(){return k.asm.Ba.apply(null,arguments)},qt=k._emscripten_bind_DracoUInt16Array_size_0=function(){return k.asm.Ca.apply(null,arguments)},Bt=k._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=function(){return k.asm.Da.apply(null,arguments)},kt=k._emscripten_bind_DracoUInt32Array_GetArray_2=function(){return k.asm.Ea.apply(null,arguments)},Qt=k._emscripten_bind_DracoUInt32Array_GetValue_1=function(){return k.asm.Fa.apply(null,arguments)},zt=k._emscripten_bind_DracoUInt32Array___destroy___0=function(){return k.asm.Ga.apply(null,arguments)},Ht=k._emscripten_bind_DracoUInt32Array_size_0=function(){return k.asm.Ha.apply(null,arguments)},Wt=k._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=function(){return k.asm.Ia.apply(null,arguments)},Jt=k._emscripten_bind_DracoUInt8Array_GetArray_2=function(){return k.asm.Ja.apply(null,arguments)},Yt=k._emscripten_bind_DracoUInt8Array_GetValue_1=function(){return k.asm.Ka.apply(null,arguments)},Zt=k._emscripten_bind_DracoUInt8Array___destroy___0=function(){return k.asm.La.apply(null,arguments)},Kt=k._emscripten_bind_DracoUInt8Array_size_0=function(){return k.asm.Ma.apply(null,arguments)},Xt=k._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return k.asm.Na.apply(null,arguments)},$t=k._emscripten_bind_GeometryAttribute___destroy___0=function(){return k.asm.Oa.apply(null,arguments)},er=k._emscripten_bind_Mesh_Mesh_0=function(){return k.asm.Pa.apply(null,arguments)},tr=k._emscripten_bind_Mesh___destroy___0=function(){return k.asm.Qa.apply(null,arguments)},rr=k._emscripten_bind_Mesh_num_attributes_0=function(){return k.asm.Ra.apply(null,arguments)},nr=k._emscripten_bind_Mesh_num_faces_0=function(){return k.asm.Sa.apply(null,arguments)},ir=k._emscripten_bind_Mesh_num_points_0=function(){return k.asm.Ta.apply(null,arguments)},or=k._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=function(){return k.asm.Ua.apply(null,arguments)},ar=k._emscripten_bind_MetadataQuerier_GetEntryName_2=function(){return k.asm.Va.apply(null,arguments)},sr=k._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=function(){return k.asm.Wa.apply(null,arguments)},ur=k._emscripten_bind_MetadataQuerier_GetIntEntry_2=function(){return k.asm.Xa.apply(null,arguments)},lr=k._emscripten_bind_MetadataQuerier_GetStringEntry_2=function(){return k.asm.Ya.apply(null,arguments)},pr=k._emscripten_bind_MetadataQuerier_HasEntry_2=function(){return k.asm.Za.apply(null,arguments)},dr=k._emscripten_bind_MetadataQuerier_MetadataQuerier_0=function(){return k.asm._a.apply(null,arguments)},cr=k._emscripten_bind_MetadataQuerier_NumEntries_1=function(){return k.asm.$a.apply(null,arguments)},hr=k._emscripten_bind_MetadataQuerier___destroy___0=function(){return k.asm.ab.apply(null,arguments)},fr=k._emscripten_bind_Metadata_Metadata_0=function(){return k.asm.bb.apply(null,arguments)},yr=k._emscripten_bind_Metadata___destroy___0=function(){return k.asm.cb.apply(null,arguments)},_r=k._emscripten_bind_PointAttribute_GetAttributeTransformData_0=function(){return k.asm.db.apply(null,arguments)},mr=k._emscripten_bind_PointAttribute_PointAttribute_0=function(){return k.asm.eb.apply(null,arguments)},gr=k._emscripten_bind_PointAttribute___destroy___0=function(){return k.asm.fb.apply(null,arguments)},br=k._emscripten_bind_PointAttribute_attribute_type_0=function(){return k.asm.gb.apply(null,arguments)},vr=k._emscripten_bind_PointAttribute_byte_offset_0=function(){return k.asm.hb.apply(null,arguments)},xr=k._emscripten_bind_PointAttribute_byte_stride_0=function(){return k.asm.ib.apply(null,arguments)},Ar=k._emscripten_bind_PointAttribute_data_type_0=function(){return k.asm.jb.apply(null,arguments)},wr=k._emscripten_bind_PointAttribute_normalized_0=function(){return k.asm.kb.apply(null,arguments)},Ir=k._emscripten_bind_PointAttribute_num_components_0=function(){return k.asm.lb.apply(null,arguments)},Dr=k._emscripten_bind_PointAttribute_size_0=function(){return k.asm.mb.apply(null,arguments)},Sr=k._emscripten_bind_PointAttribute_unique_id_0=function(){return k.asm.nb.apply(null,arguments)},Er=k._emscripten_bind_PointCloud_PointCloud_0=function(){return k.asm.ob.apply(null,arguments)},Pr=k._emscripten_bind_PointCloud___destroy___0=function(){return k.asm.pb.apply(null,arguments)},Cr=k._emscripten_bind_PointCloud_num_attributes_0=function(){return k.asm.qb.apply(null,arguments)},Or=k._emscripten_bind_PointCloud_num_points_0=function(){return k.asm.rb.apply(null,arguments)},Nr=k._emscripten_bind_Status___destroy___0=function(){return k.asm.sb.apply(null,arguments)},Fr=k._emscripten_bind_Status_code_0=function(){return k.asm.tb.apply(null,arguments)},Tr=k._emscripten_bind_Status_error_msg_0=function(){return k.asm.ub.apply(null,arguments)},Mr=k._emscripten_bind_Status_ok_0=function(){return k.asm.vb.apply(null,arguments)},Rr=k._emscripten_bind_VoidPtr___destroy___0=function(){return k.asm.wb.apply(null,arguments)},Vr=k._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=function(){return k.asm.xb.apply(null,arguments)},Gr=k._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=function(){return k.asm.yb.apply(null,arguments)},jr=k._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=function(){return k.asm.zb.apply(null,arguments)},Lr=k._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=function(){return k.asm.Ab.apply(null,arguments)},Ur=k._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return k.asm.Bb.apply(null,arguments)},qr=k._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return k.asm.Cb.apply(null,arguments)},Br=k._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return k.asm.Db.apply(null,arguments)},kr=k._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return k.asm.Eb.apply(null,arguments)},Qr=k._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return k.asm.Fb.apply(null,arguments)},zr=k._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return k.asm.Gb.apply(null,arguments)},Hr=k._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return k.asm.Hb.apply(null,arguments)},Wr=k._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return k.asm.Ib.apply(null,arguments)},Jr=k._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return k.asm.Jb.apply(null,arguments)},Yr=k._emscripten_enum_draco_StatusCode_ERROR=function(){return k.asm.Kb.apply(null,arguments)},Zr=k._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=function(){return k.asm.Lb.apply(null,arguments)},Kr=k._emscripten_enum_draco_StatusCode_IO_ERROR=function(){return k.asm.Mb.apply(null,arguments)},Xr=k._emscripten_enum_draco_StatusCode_OK=function(){return k.asm.Nb.apply(null,arguments)},$r=k._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=function(){return k.asm.Ob.apply(null,arguments)},en=k._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=function(){return k.asm.Pb.apply(null,arguments)},tn=k._free=function(){return k.asm.Qb.apply(null,arguments)},rn=k._malloc=function(){return k.asm.Rb.apply(null,arguments)};if(k.dynCall_v=function(){return k.asm.Sb.apply(null,arguments)},k.dynCall_vi=function(){return k.asm.Tb.apply(null,arguments)},k.asm=Ie,k.then=function(e){if(k.calledRun)e(k);else{var t=k.onRuntimeInitialized;k.onRuntimeInitialized=function(){t&&t(),e(k)}}return k},_.prototype=new Error,_.prototype.constructor=_,be=function e(){k.calledRun||m(),k.calledRun||(be=e)},k.run=m,k.abort=g,k.preInit)for("function"==typeof k.preInit&&(k.preInit=[k.preInit]);k.preInit.length>0;)k.preInit.pop()();k.noExitRuntime=!0,m(),b.prototype=Object.create(b.prototype),b.prototype.constructor=b,b.prototype.__class__=b,b.__cache__={},k.WrapperObject=b,k.getCache=v,k.wrapPointer=x,k.castObject=function(e,t){return x(e.ptr,t)},k.NULL=x(0),k.destroy=function(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete v(e.__class__)[e.ptr]},k.compare=function(e,t){return e.ptr===t.ptr},k.getPointer=function(e){return e.ptr},k.getClass=function(e){return e.__class__};var nn={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(nn.needed){for(var e=0;e<nn.temps.length;e++)k._free(nn.temps[e]);nn.temps.length=0,k._free(nn.buffer),nn.buffer=0,nn.size+=nn.needed,nn.needed=0}nn.buffer||(nn.size+=128,nn.buffer=k._malloc(nn.size),i(nn.buffer)),nn.pos=0},alloc:function(e,t){i(nn.buffer);var r,n=t.BYTES_PER_ELEMENT,o=e.length*n;return o=o+7&-8,nn.pos+o>=nn.size?(i(o>0),nn.needed+=o,r=k._malloc(o),nn.temps.push(r)):(r=nn.buffer+nn.pos,nn.pos+=o),r},copy:function(e,t,r){var n=r;switch(t.BYTES_PER_ELEMENT){case 2:n>>=1;break;case 4:n>>=2;break;case 8:n>>=3}for(var i=0;i<e.length;i++)t[n+i]=e[i]}};return w.prototype=Object.create(b.prototype),w.prototype.constructor=w,w.prototype.__class__=w,w.__cache__={},k.Status=w,w.prototype.code=w.prototype.code=function(){var e=this.ptr;return Fr(e)},w.prototype.ok=w.prototype.ok=function(){var e=this.ptr;return!!Mr(e)},w.prototype.error_msg=w.prototype.error_msg=function(){var e=this.ptr;return o(Tr(e))},w.prototype.__destroy__=w.prototype.__destroy__=function(){var e=this.ptr;Nr(e)},I.prototype=Object.create(b.prototype),I.prototype.constructor=I,I.prototype.__class__=I,I.__cache__={},k.DracoUInt16Array=I,I.prototype.GetValue=I.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Lt(t,e)},I.prototype.size=I.prototype.size=function(){var e=this.ptr;return qt(e)},I.prototype.GetArray=I.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!jt(r,e,t)},I.prototype.__destroy__=I.prototype.__destroy__=function(){var e=this.ptr;Ut(e)},D.prototype=Object.create(b.prototype),D.prototype.constructor=D,D.prototype.__class__=D,D.__cache__={},k.PointCloud=D,D.prototype.num_attributes=D.prototype.num_attributes=function(){var e=this.ptr;return Cr(e)},D.prototype.num_points=D.prototype.num_points=function(){var e=this.ptr;return Or(e)},D.prototype.__destroy__=D.prototype.__destroy__=function(){var e=this.ptr;Pr(e)},S.prototype=Object.create(b.prototype),S.prototype.constructor=S,S.prototype.__class__=S,S.__cache__={},k.DracoUInt8Array=S,S.prototype.GetValue=S.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Yt(t,e)},S.prototype.size=S.prototype.size=function(){var e=this.ptr;return Kt(e)},S.prototype.GetArray=S.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!Jt(r,e,t)},S.prototype.__destroy__=S.prototype.__destroy__=function(){var e=this.ptr;Zt(e)},E.prototype=Object.create(b.prototype),E.prototype.constructor=E,E.prototype.__class__=E,E.__cache__={},k.DracoUInt32Array=E,E.prototype.GetValue=E.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Qt(t,e)},E.prototype.size=E.prototype.size=function(){var e=this.ptr;return Ht(e)},E.prototype.GetArray=E.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!kt(r,e,t)},E.prototype.__destroy__=E.prototype.__destroy__=function(){var e=this.ptr;zt(e)},P.prototype=Object.create(b.prototype),P.prototype.constructor=P,P.prototype.__class__=P,P.__cache__={},k.AttributeOctahedronTransform=P,P.prototype.InitFromAttribute=P.prototype.InitFromAttribute=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!Se(t,e)},P.prototype.quantization_bits=P.prototype.quantization_bits=function(){var e=this.ptr;return Pe(e)},P.prototype.__destroy__=P.prototype.__destroy__=function(){var e=this.ptr;Ee(e)},C.prototype=Object.create(b.prototype),C.prototype.constructor=C,C.prototype.__class__=C,C.__cache__={},k.PointAttribute=C,C.prototype.size=C.prototype.size=function(){var e=this.ptr;return Dr(e)},C.prototype.GetAttributeTransformData=C.prototype.GetAttributeTransformData=function(){var e=this.ptr;return x(_r(e),O)},C.prototype.attribute_type=C.prototype.attribute_type=function(){var e=this.ptr;return br(e)},C.prototype.data_type=C.prototype.data_type=function(){var e=this.ptr;return Ar(e)},C.prototype.num_components=C.prototype.num_components=function(){var e=this.ptr;return Ir(e)},C.prototype.normalized=C.prototype.normalized=function(){var e=this.ptr;return!!wr(e)},C.prototype.byte_stride=C.prototype.byte_stride=function(){var e=this.ptr;return xr(e)},C.prototype.byte_offset=C.prototype.byte_offset=function(){var e=this.ptr;return vr(e)},C.prototype.unique_id=C.prototype.unique_id=function(){var e=this.ptr;return Sr(e)},C.prototype.__destroy__=C.prototype.__destroy__=function(){var e=this.ptr;gr(e)},O.prototype=Object.create(b.prototype),O.prototype.constructor=O,O.prototype.__class__=O,O.__cache__={},k.AttributeTransformData=O,O.prototype.transform_type=O.prototype.transform_type=function(){var e=this.ptr;return Ge(e)},O.prototype.__destroy__=O.prototype.__destroy__=function(){var e=this.ptr;Ve(e)},N.prototype=Object.create(b.prototype),N.prototype.constructor=N,N.prototype.__class__=N,N.__cache__={},k.AttributeQuantizationTransform=N,N.prototype.InitFromAttribute=N.prototype.InitFromAttribute=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!Oe(t,e)},N.prototype.quantization_bits=N.prototype.quantization_bits=function(){var e=this.ptr;return Te(e)},N.prototype.min_value=N.prototype.min_value=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Fe(t,e)},N.prototype.range=N.prototype.range=function(){var e=this.ptr;return Me(e)},N.prototype.__destroy__=N.prototype.__destroy__=function(){var e=this.ptr;Ne(e)},F.prototype=Object.create(b.prototype),F.prototype.constructor=F,F.prototype.__class__=F,F.__cache__={},k.DracoInt8Array=F,F.prototype.GetValue=F.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Mt(t,e)},F.prototype.size=F.prototype.size=function(){var e=this.ptr;return Vt(e)},F.prototype.GetArray=F.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!Tt(r,e,t)},F.prototype.__destroy__=F.prototype.__destroy__=function(){var e=this.ptr;Rt(e)},T.prototype=Object.create(b.prototype),T.prototype.constructor=T,T.prototype.__class__=T,T.__cache__={},k.MetadataQuerier=T,T.prototype.HasEntry=T.prototype.HasEntry=function(e,t){var r=this.ptr;return nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),!!pr(r,e,t)},T.prototype.GetIntEntry=T.prototype.GetIntEntry=function(e,t){var r=this.ptr;return nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),ur(r,e,t)},T.prototype.GetIntEntryArray=T.prototype.GetIntEntryArray=function(e,t,r){var n=this.ptr;nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),r&&"object"==typeof r&&(r=r.ptr),sr(n,e,t,r)},T.prototype.GetDoubleEntry=T.prototype.GetDoubleEntry=function(e,t){var r=this.ptr;return nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),or(r,e,t)},T.prototype.GetStringEntry=T.prototype.GetStringEntry=function(e,t){var r=this.ptr;return nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),o(lr(r,e,t))},T.prototype.NumEntries=T.prototype.NumEntries=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),cr(t,e)},T.prototype.GetEntryName=T.prototype.GetEntryName=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),o(ar(r,e,t))},T.prototype.__destroy__=T.prototype.__destroy__=function(){var e=this.ptr;hr(e)},M.prototype=Object.create(b.prototype),M.prototype.constructor=M,M.prototype.__class__=M,M.__cache__={},k.DracoInt16Array=M,M.prototype.GetValue=M.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),It(t,e)},M.prototype.size=M.prototype.size=function(){var e=this.ptr;return St(e)},M.prototype.GetArray=M.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!wt(r,e,t)},M.prototype.__destroy__=M.prototype.__destroy__=function(){var e=this.ptr;Dt(e)},R.prototype=Object.create(b.prototype),R.prototype.constructor=R,R.prototype.__class__=R,R.__cache__={},k.DracoFloat32Array=R,R.prototype.GetValue=R.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),bt(t,e)},R.prototype.size=R.prototype.size=function(){var e=this.ptr;return xt(e)},R.prototype.GetArray=R.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!gt(r,e,t)},R.prototype.__destroy__=R.prototype.__destroy__=function(){var e=this.ptr;vt(e)},V.prototype=Object.create(b.prototype),V.prototype.constructor=V,V.prototype.__class__=V,V.__cache__={},k.GeometryAttribute=V,V.prototype.__destroy__=V.prototype.__destroy__=function(){var e=this.ptr;$t(e)},G.prototype=Object.create(b.prototype),G.prototype.constructor=G,G.prototype.__class__=G,G.__cache__={},k.DecoderBuffer=G,G.prototype.Init=G.prototype.Init=function(e,t){var r=this.ptr;nn.prepare(),"object"==typeof e&&(e=function(e){if("object"==typeof e){var t=nn.alloc(e,ae);return nn.copy(e,ae,t),t}return e}(e)),t&&"object"==typeof t&&(t=t.ptr),Le(r,e,t)},G.prototype.__destroy__=G.prototype.__destroy__=function(){var e=this.ptr;Ue(e)},j.prototype=Object.create(b.prototype),j.prototype.constructor=j,j.prototype.__class__=j,j.__cache__={},k.Decoder=j,j.prototype.GetEncodedGeometryType=j.prototype.GetEncodedGeometryType=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),lt(t,e)},j.prototype.DecodeBufferToPointCloud=j.prototype.DecodeBufferToPointCloud=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),x(Be(r,e,t),w)},j.prototype.DecodeBufferToMesh=j.prototype.DecodeBufferToMesh=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),x(qe(r,e,t),w)},j.prototype.GetAttributeId=j.prototype.GetAttributeId=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Ze(r,e,t)},j.prototype.GetAttributeIdByName=j.prototype.GetAttributeIdByName=function(e,t){var r=this.ptr;return nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),Ye(r,e,t)},j.prototype.GetAttributeIdByMetadataEntry=j.prototype.GetAttributeIdByMetadataEntry=function(e,t,r){var n=this.ptr;return nn.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:A(t),r=r&&"object"==typeof r?r.ptr:A(r),Je(n,e,t,r)},j.prototype.GetAttribute=j.prototype.GetAttribute=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),x(ut(r,e,t),C)},j.prototype.GetAttributeByUniqueId=j.prototype.GetAttributeByUniqueId=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),x(Qe(r,e,t),C)},j.prototype.GetMetadata=j.prototype.GetMetadata=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),x(dt(t,e),B)},j.prototype.GetAttributeMetadata=j.prototype.GetAttributeMetadata=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),x(tt(r,e,t),B)},j.prototype.GetFaceFromMesh=j.prototype.GetFaceFromMesh=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!pt(n,e,t,r)},j.prototype.GetTriangleStripsFromMesh=j.prototype.GetTriangleStripsFromMesh=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),ct(r,e,t)},j.prototype.GetTrianglesUInt16Array=j.prototype.GetTrianglesUInt16Array=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!ht(n,e,t,r)},j.prototype.GetTrianglesUInt32Array=j.prototype.GetTrianglesUInt32Array=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!ft(n,e,t,r)},j.prototype.GetAttributeFloat=j.prototype.GetAttributeFloat=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!We(n,e,t,r)},j.prototype.GetAttributeFloatForAllPoints=j.prototype.GetAttributeFloatForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!He(n,e,t,r)},j.prototype.GetAttributeFloatArrayForAllPoints=j.prototype.GetAttributeFloatArrayForAllPoints=function(e,t,r,n){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),!!ze(i,e,t,r,n)},j.prototype.GetAttributeIntForAllPoints=j.prototype.GetAttributeIntForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!et(n,e,t,r)},j.prototype.GetAttributeInt8ForAllPoints=j.prototype.GetAttributeInt8ForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!$e(n,e,t,r)},j.prototype.GetAttributeUInt8ForAllPoints=j.prototype.GetAttributeUInt8ForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!st(n,e,t,r)},j.prototype.GetAttributeUInt8ArrayForAllPoints=j.prototype.GetAttributeUInt8ArrayForAllPoints=function(e,t,r,n){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),!!at(i,e,t,r,n)},j.prototype.GetAttributeInt16ForAllPoints=j.prototype.GetAttributeInt16ForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Ke(n,e,t,r)},j.prototype.GetAttributeUInt16ForAllPoints=j.prototype.GetAttributeUInt16ForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!nt(n,e,t,r)},j.prototype.GetAttributeUInt16ArrayForAllPoints=j.prototype.GetAttributeUInt16ArrayForAllPoints=function(e,t,r,n){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),!!rt(i,e,t,r,n)},j.prototype.GetAttributeInt32ForAllPoints=j.prototype.GetAttributeInt32ForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Xe(n,e,t,r)},j.prototype.GetAttributeUInt32ForAllPoints=j.prototype.GetAttributeUInt32ForAllPoints=function(e,t,r){var n=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!ot(n,e,t,r)},j.prototype.GetAttributeUInt32ArrayForAllPoints=j.prototype.GetAttributeUInt32ArrayForAllPoints=function(e,t,r,n){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),!!it(i,e,t,r,n)},j.prototype.SkipAttributeTransform=j.prototype.SkipAttributeTransform=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),yt(t,e)},j.prototype.__destroy__=j.prototype.__destroy__=function(){var e=this.ptr;_t(e)},L.prototype=Object.create(b.prototype),L.prototype.constructor=L,L.prototype.__class__=L,L.__cache__={},k.Mesh=L,L.prototype.num_faces=L.prototype.num_faces=function(){var e=this.ptr;return nr(e)},L.prototype.num_attributes=L.prototype.num_attributes=function(){var e=this.ptr;return rr(e)},L.prototype.num_points=L.prototype.num_points=function(){var e=this.ptr;return ir(e)},L.prototype.__destroy__=L.prototype.__destroy__=function(){var e=this.ptr;tr(e)},U.prototype=Object.create(b.prototype),U.prototype.constructor=U,U.prototype.__class__=U,U.__cache__={},k.VoidPtr=U,U.prototype.__destroy__=U.prototype.__destroy__=function(){var e=this.ptr;Rr(e)},q.prototype=Object.create(b.prototype),q.prototype.constructor=q,q.prototype.__class__=q,q.__cache__={},k.DracoInt32Array=q,q.prototype.GetValue=q.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Ct(t,e)},q.prototype.size=q.prototype.size=function(){var e=this.ptr;return Nt(e)},q.prototype.GetArray=q.prototype.GetArray=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),!!Pt(r,e,t)},q.prototype.__destroy__=q.prototype.__destroy__=function(){var e=this.ptr;Ot(e)},B.prototype=Object.create(b.prototype),B.prototype.constructor=B,B.prototype.__class__=B,B.__cache__={},k.Metadata=B,B.prototype.__destroy__=B.prototype.__destroy__=function(){var e=this.ptr;yr(e)},function(){function e(){k.OK=Xr(),k.ERROR=Yr(),k.IO_ERROR=Kr(),k.INVALID_PARAMETER=Zr(),k.UNSUPPORTED_VERSION=en(),k.UNKNOWN_VERSION=$r(),k.INVALID_GEOMETRY_TYPE=Ur(),k.POINT_CLOUD=qr(),k.TRIANGULAR_MESH=Br(),k.ATTRIBUTE_INVALID_TRANSFORM=Vr(),k.ATTRIBUTE_NO_TRANSFORM=Gr(),k.ATTRIBUTE_QUANTIZATION_TRANSFORM=Lr(),k.ATTRIBUTE_OCTAHEDRON_TRANSFORM=jr(),k.INVALID=zr(),k.POSITION=Wr(),k.NORMAL=Hr(),k.COLOR=kr(),k.TEX_COORD=Jr(),k.GENERIC=Qr()}_e?e():function(e){fe.unshift(e)}(e)}(),"function"==typeof k.onModuleParsed&&k.onModuleParsed(),n}}();e.exports=n}).call(this,"/")},1737:function(e,t){},1738:function(e,t){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}t.resolve=function(){for(var e="",t=!1,i=arguments.length-1;i>=-1&&!t;i--){var o=i>=0?arguments[i]:process.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,t="/"===o.charAt(0))}return e=r(n(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},t.normalize=function(e){var o=t.isAbsolute(e),a="/"===i(e,-1);return(e=r(n(e.split("/"),function(e){return!!e}),!o).join("/"))||o||(e="."),e&&a&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var i=n(e.split("/")),o=n(r.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var l=[];for(u=s;u<i.length;u++)l.push("..");return(l=l.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,i=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!i){n=o;break}}else i=!1;return-1===n?r?"/":".":r&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var r=function(e){"string"!=typeof e&&(e+="");var t,r=0,n=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){r=t+1;break}}else-1===n&&(i=!1,n=t+1);return-1===n?"":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===n&&(i=!1,n=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){r=a+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n)};var i="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}},1743:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(10),r(11),r(97),r(16),r(58),r(24),r(22),r(25),r(0),r(63),r(653),r(402),r(413),r(1717),r(1718),r(1744),r(1692),r(1719),r(1721),r(84),r(1681),r(292)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d,c,h,f,y,_,m,g,b,v,x,A,w,I,D){var S=function(e){function t(t){var r=e.call(this)||this;return r._handles=new p,r.highlights=new x,r.watchUpdatingTracking=new D.WatchUpdatingTracking,r.suspendResumeExtentMode="computed",r.dataExtent=null,r.suspendResumeExtent=null,r}return r(t,e),Object.defineProperty(t.prototype,"suspended",{get:function(){return this.scaleVisibility&&this.scaleVisibility.suspended||this.frustumVisibility&&this.frustumVisibility.suspended},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.graphicsCore&&this.graphicsCore.updating||this.frustumVisibility&&this.frustumVisibility.updating||this.watchUpdatingTracking&&this.watchUpdatingTracking.updating)},enumerable:!0,configurable:!0}),t.prototype.normalizeCtorArgs=function(e){var t=e.frustumVisibilityEnabled?new v:null,r=e.scaleVisibilityEnabled?new A:null,n=(e.filterVisibilityEnabled||e.timeExtentVisibilityEnabled)&&"multipatch"!==e.layer.geometryType?new b.Graphics3DFilterVisibility:null,i=e.elevationAlignmentEnabled?new g:null;return{graphicsCore:new m({owner:e.owner,layer:e.layer,preferredUpdatePolicy:e.preferredUpdatePolicy,elevationFeatureExpressionEnabled:e.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1,hasZ:e.owner.hasZ,hasM:e.owner.hasM}),frustumVisibility:t,scaleVisibility:r,filterVisibility:n,elevationAlignment:i,updateClippingExtent:e.updateClippingExtent,suspendResumeExtentMode:e.suspendResumeExtentMode,dataExtent:e.dataExtent}},t.prototype.initialize=function(){var e=this;this.scaleVisibility&&this.watchUpdatingTracking.add(this.layer,"scaleRangeId",function(){return e.scaleVisibility.layerMinMaxScaleChangeHandler()}),this.filterVisibility&&(this.watchUpdatingTracking.add(this.owner,"filter",function(){return e.filterVisibility.filterChanged()}),this.watchUpdatingTracking.add(this.owner,"timeExtent",function(){return e.filterVisibility.filterChanged()})),this.elevationAlignment&&this.watchUpdatingTracking.add(this.layer,"elevationInfo",function(t,r){f.diff(t,r)&&e.graphicsCore.elevationInfoChange()}),this.watchUpdatingTracking.add(this.layer,"labelsVisible",function(){return e.graphicsCore.updateVisibilityInfo()}),this.watchUpdatingTracking.add(this.layer,"labelingInfo",function(t,r){f.diff(t,r)&&e.graphicsCore.updateLabelingInfo()})},t.prototype.setup=function(){return o(this,void 0,void 0,function(){var e,t,r,n,o=this;return i(this,function(i){switch(i.label){case 0:return this.frustumVisibility&&this.frustumVisibility.setup(this.owner),e=this.owner,t=this.owner.view.basemapTerrain,r=function(e,t,r){return o.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(e,t,r)},this.scaleVisibility&&this.scaleVisibility.setup(e,this.layer,r,this.graphicsCore,t),this.filterVisibility&&("filter"in e||"timeExtent"in e)&&this.filterVisibility.setup(e,this.graphicsCore),this.elevationAlignment&&(n=e.view.elevationProvider,this.elevationAlignment.setup(e,r,this.graphicsCore,n)),this.highlights&&this.highlights.setup(this.graphicsCore),this._set("labeling",this.owner.view.labeler.addGraphicsOwner(this.graphicsCore,this.scaleVisibility)),this._set("deconfliction",e.view.deconflictor.addGraphicsOwner(this.graphicsCore)),[4,u.result(this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,filterVisibility:this.filterVisibility,deconflictor:this.deconfliction,labeler:this.labeling,highlights:this.highlights}))];case 1:return i.sent(),this._handles.add([this.layer.watch("renderer",function(e){return o.graphicsCore.rendererChange(e)}),e.watch("fullOpacity",function(){return o.graphicsCore.opacityChange()})]),this.setupSuspendResumeExtent(),this.updateClippingExtent&&(this._handles.add(e.view.watch("clippingArea",function(){return o._updateClippingExtent()})),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),this.graphicsCore.labelsEnabled?[4,u.result(this.graphicsCore.updateLabelingInfo())]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null);for(var e=0,t=["watchUpdatingTracking","frustumVisibility","scaleVisibility","filterVisibility","elevationAlignment","highlights","graphicsCore"];e<t.length;e++){var r=t[e],n=this[r];n&&(n.destroy(),this._set(r,null))}this._set("layer",null),this._set("owner",null)},t.prototype.highlight=function(e,t,r){var n=this;if(e instanceof y){var i=this.highlights.acquireSet(t,r),o=i.set,s=i.handle;return this.owner.queryObjectIds(e).then(function(e){return n.highlights.setObjectIds(o,e)}),s}if("number"==typeof e)return this.highlight([e],t,r);if(e instanceof a)return this.highlight([e],t,r);if("toArray"in e&&(e=e.toArray()),Array.isArray(e)&&e.length>0){if(e[0]instanceof a){var u=e;if(!r||!u[0].attributes||null===I.attributeLookup(u[0].attributes,r)){var l=u.map(function(e){return e.uid}),p=this.highlights.acquireSet(t,null),d=p.set;s=p.handle;return this.highlights.setUids(d,l),s}e=u.map(function(e){return I.attributeLookup(e.attributes,r)})}if("number"==typeof e[0]){var c=e,h=this.highlights.acquireSet(t,r);d=h.set,s=h.handle;return this.highlights.setObjectIds(d,c),s}}return P},t.prototype._updateClippingExtent=function(){var e=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.owner.view.spatialReference)&&(this.updateClippingExtent(e)||this.graphicsCore.recreateAllGraphics())},t.prototype.setupSuspendResumeExtent=function(){var e=this;(this.frustumVisibility||this.scaleVisibility)&&this._handles.add(d.init(this,"suspendResumeExtentMode",function(){switch(e._handles.remove(E),e.suspendResumeExtentMode){case"computed":e._handles.add(d.init(e.graphicsCore,"computedExtent",function(t){return e.updateSuspendResumeExtent(t)}),E);break;case"data":e._handles.add(d.init(e,"dataExtent",function(t){return e.updateSuspendResumeExtent(t)}),E);break;default:l.neverReached(e.suspendResumeExtentMode)}}))},t.prototype.updateSuspendResumeExtent=function(e){e?this.suspendResumeExtentChanged(this.extentToSuspendResumeRect(e,this.suspendResumeExtent)):this.suspendResumeExtentChanged(null)},t.prototype.extentToSuspendResumeRect=function(e,t){var r=this.owner.view.spatialReference;if(!e.spatialReference.equals(r)){if(!h.canProject(e,r))return;e=h.project(e,r)}return w.enlargeExtent(e,t,_.SUSPEND_RESUME_EXTENT_OPTIMISM)},t.prototype.suspendResumeExtentChanged=function(e){this.frustumVisibility&&this.frustumVisibility.setExtent(e),this.scaleVisibility&&this.scaleVisibility.setExtent(e)},n([c.property({aliasOf:"graphicsCore.layer"})],t.prototype,"layer",void 0),n([c.property({aliasOf:"graphicsCore.owner"})],t.prototype,"owner",void 0),n([c.property({constructOnly:!0})],t.prototype,"updateClippingExtent",void 0),n([c.property({constructOnly:!0})],t.prototype,"graphicsCore",void 0),n([c.property({constructOnly:!0})],t.prototype,"scaleVisibility",void 0),n([c.property({constructOnly:!0})],t.prototype,"filterVisibility",void 0),n([c.property({constructOnly:!0})],t.prototype,"elevationAlignment",void 0),n([c.property({constructOnly:!0})],t.prototype,"frustumVisibility",void 0),n([c.property({readOnly:!0})],t.prototype,"deconfliction",void 0),n([c.property({readOnly:!0})],t.prototype,"labeling",void 0),n([c.property({readOnly:!0})],t.prototype,"highlights",void 0),n([c.property({readOnly:!0})],t.prototype,"watchUpdatingTracking",void 0),n([c.property()],t.prototype,"suspendResumeExtentMode",void 0),n([c.property()],t.prototype,"dataExtent",void 0),n([c.property({readOnly:!0,dependsOn:["scaleVisibility.suspended","frustumVisibility.suspended"]})],t.prototype,"suspended",null),n([c.property({readOnly:!0,dependsOn:["graphicsCore.updating","frustumVisibility.updating","watchUpdatingTracking.updating"]})],t.prototype,"updating",null),n([c.subclass("esri.views.3d.layers.graphics.Graphics3DFeatureLikeLayerView")],t)}(c.declared(s)),E="suspendResumeExtentMode",P={remove:function(){},pause:function(){},resume:function(){}};return S}.apply(null,n))||(e.exports=i)},1744:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(16),r(22),r(6),r(9),r(25),r(0),r(1688),r(643),r(145)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d,c){Object.defineProperty(t,"__esModule",{value:!0});var h=a.getLogger("esri.views.3d.layers.graphics.Graphics3DFilterVisibility"),f=function(e){function t(){var t=e.call(this)||this;return t.filter=null,t._dirty=!1,t._querying=!1,t._handles=new o,t}return r(t,e),Object.defineProperty(t.prototype,"updating",{get:function(){return this._dirty||this._querying||null!=this._queryResult},enumerable:!0,configurable:!0}),t.prototype.setup=function(e,t){var r=this;this._layerView=e,this._core=t,this._objectIdField=e.layer.objectIdField,this._queryEngine=new p.default({layerView:this._layerView,task:c.Task.FILTER_VISIBILITY});var n=this._layerView.view.resourceController.scheduler;this._handles.add(n.registerTask(c.Task.FILTER_VISIBILITY,function(e){return r._update(e)},function(){return r._needsUpdate()})),this._handles.add(u.on(t.owner,"loadedGraphics","after-changes",function(e){return r._graphicsChanged(e)},function(){return r.dirty=!0}))},t.prototype.destroy=function(){this._handles.destroy(),this._handles=null,this.clear(),this._layerView=null,this._core=null},t.prototype.clear=function(){this._queryEngine.clear()&&(this._core.modifyGraphics3DGraphicVisibilities(function(e){return e.clearVisibilityFlag(2)}),this._queryResult=null,this._querying=!1),this.dirty=!1,this.notifyChange("updating")},t.prototype._graphicsChanged=function(e){this._queryEngine&&0==(1&e.type)||(this.dirty=!0)},t.prototype.updateVisibility=function(e){this.active&&(e.hasVisibilityFlag(2,0)||e.setVisibilityFlag(2,!1,0),this.dirty=!0)},t.prototype.filterChanged=function(){this.filter=this.recomputeFilter(),this.dirty=!0},Object.defineProperty(t.prototype,"active",{get:function(){return this.filter&&this._core.graphics3DGraphics.size>0},enumerable:!0,configurable:!0}),t.prototype.recomputeFilter=function(){var e="filter"in this._layerView?this._layerView.filter:null,t="timeExtent"in this._layerView?this._layerView.timeExtent:null;if(!t)return e;var r=s.isSome(e)?e.clone():new d;return r.timeExtent=r.timeExtent?r.timeExtent.intersection(t):t,r},t.prototype._needsUpdate=function(){return this._dirty&&!this._querying||null!=this._queryResult},t.prototype._update=function(e){var t=this;this.active?(!this._dirty||this._querying||e.done||(this._querying=!0,this.dirty=!1,this._queryEngine.executeQueryForIdSet(this.filter).then(function(e){t._queryResult=e,t._querying=!1}).catch(function(e){h.warn("FeatureFilter query failed: "+e),t._queryResult=new Set,t._core.graphics3DGraphics.forEach(function(e){return t._queryResult.add(t._getFeatureId(e.graphic))}),t._querying=!1}),e.madeProgress()),this._queryResult&&!e.done&&(this._core.modifyGraphics3DGraphicVisibilities(function(r){if(e.done)return!1;var n=t._queryResult.has(t._getFeatureId(r.graphic));return!!r.setVisibilityFlag(2,n,0)&&(e.madeProgress(),!0)}),e.done||(this._queryResult=null)),this.notifyChange("updating")):this.clear()},t.prototype._getFeatureId=function(e){return null==e.objectId?e.attributes[this._objectIdField]:e.objectId},Object.defineProperty(t.prototype,"dirty",{set:function(e){this._dirty!==e&&(this._dirty=e,this.notifyChange("updating"))},enumerable:!0,configurable:!0}),n([l.property({readOnly:!0})],t.prototype,"updating",null),n([l.subclass("esri.views.3d.layers.graphics.Graphics3DFilterVisibility")],t)}(l.declared(i));t.Graphics3DFilterVisibility=f}.apply(null,n))||(e.exports=i)},1750:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(16),r(43),r(58),r(22),r(18),r(6),r(75),r(225),r(7),r(25),r(0),r(8),r(5),r(45),r(33),r(103),r(1687),r(1751),r(1752),r(1753),r(1754),r(1756),r(1641),r(1757),r(41),r(651)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d,c,h,f,y,_,m,g,b,v,x,A,w,I,D,S,E,P,C){function O(e,t){return e.length===t.length&&e.every(function(e){return N(t,e.name)>=0})}function N(e,t){for(var r=t.toLowerCase(),n=0;n<e.length;n++)if(e[n].name.toLowerCase()===r)return n;return-1}function F(e){return null!=e&&null!=e.loadedAttributes&&null!=e.attributeData}var T=l.getLogger("esri.layers.graphics.controllers.I3SOnDemandController"),M=function(e){function t(t){var r=e.call(this,t)||this;return r.screenSizeFactor=0,r.featureTarget=5e4,r.fixedFeatureTarget=!1,r.updating=!0,r.updatingPercentage=0,r.leafsReached=!1,r.scaleVisibilityEnabled=!0,r.uncompressedTextureDownsamplingEnabled=!1,r._featureLOD=1,r._stableFeatureLOD=!1,r._isIdle=!1,r._cameraDirty=!0,r._invisibleDirty=!1,r._newLoadingNodes=new p({deallocator:null}),r._loadedNodeScales=new Map,r._abortController=c.createAbortController(),r._downloadingNodes=new Set,r._loadingNodeRevisions=new Map,r._nextLoadingNodeRevision=0,r._updatingNodes=new Set,r._progressMaxNumNodes=1,r._poi=_.vec3f64.create(),r._requiredAttributes=[],r._requiredAttributesDirty=!0,r._updatesDisabled=!1,r.disableIDBCache=!1,r.disableMemCache=!1,r._restartNodeLoading=!1,r._fields=null,r._attributeStorageInfo=null,r._handles=new s,r._idleQueue=new v.PromiseQueue,r._errorCount=0,r}return r(t,e),Object.defineProperty(t.prototype,"isMeshPyramid",{get:function(){return"mesh-pyramids"===this.layer.profile||"MeshPyramid"===this.layer.store.lodType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGraphics3D",{get:function(){return"points"===this.layer.profile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"streamDataController",{get:function(){var e=this.layerView.view.resourceController.createStreamDataRequester(1);return new D.default(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crsVertex",{get:function(){return S.getVertexCrs(this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crsIndex",{get:function(){return S.getIndexCrs(this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootNodeVisible",{get:function(){var e=this._index&&this._index.rootNode;return!e||(this._updateViewData(),this._index.isNodeVisible(e.index))},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var e=this;this._lodHandling=new w(this.layerView);var t=this.layerView.layer;this.layer=t,this._defaultGeometrySchema=t.store.defaultGeometrySchema,this.disableIDBCache=u("disable-feature:idb-cache"),"fields"in t&&(this._fields=t.fields,this._attributeStorageInfo=t.attributeStorageInfo);var r=c.all([this.layer.when(),this.layerView.when()]).then(function(){if(!e.destroyed&&e.layerView&&!e.layerView.destroyed){var r=e.layerView.view;e._setClippingArea(r.clippingArea),e._centerOnSurface=r.pointsOfInterest.centerOnSurfaceFrequent;var n=e.layerView.view.resourceController;e._handles.add([e._centerOnSurface.watch("renderLocation",function(){return e._pointOfInterestChanged()}),n.memoryController.events.on("quality-changed",function(){return e._setCameraDirty()}),h.init(e.layerView,"suspended",function(t){var r=t?function(){return e._updateViewData()}:function(){return e._updateIdleState(!0)},i=t?function(){}:function(){return e._updateIdleState(!1)};e._idleStateCallbacks?(t&&e.cancelNodeLoading(),e.restartNodeLoading(),e._idleStateCallbacks.idleBegin=r,e._idleStateCallbacks.idleEnd=i):e._idleStateCallbacks=n.scheduler.registerIdleStateCallbacks(r,i)}),x.addTask(e.layerView.view.resourceController.scheduler,{update:function(t,r){return e._frame(t,r)},needsUpdate:function(){return e.updating}}),e.watch("uncompressedTextureDownsamplingEnabled",function(){return e.restartNodeLoading()}),e.watch(["featureTarget","fixedFeatureTarget"],function(){e._setCameraDirty(),e._stableFeatureLOD=!1}),r.state.watch("camera",function(){return e._setCameraDirty()}),e.layer.watch("elevationInfo",function(){return e._elevationInfoChanged()}),e.layer.watch(["minScale","maxScale"],function(){return e._scaleBoundsChanged()}),e.layerView.watch("lodFactor",function(){return e._setCameraDirty()}),e.layerView.watch("availableFields?",function(){return e._requiredFieldsChange()})]),e._updateScaleHandles(),e._viewportQueries=new E(e.crsIndex,r.renderCoordsHelper,r.state.camera,e._clippingArea,r.elevationProvider,e.layer,{progressiveLoadFactor:e._getProgressiveLoadFactor(e.layer),screenspaceErrorBias:e.lod,angleDependentLoD:e.lod<.5}),e._index=new A.I3SIndex(t,e.streamDataController,e._viewportQueries,T,function(t){return e.layerView.isNodeLoaded(t)},function(t){return e._shouldLoadNode(t)},function(t){return e._enableFromGPUCache(t,"leaf")},function(t){return e._needsUpdate(t)},function(){return!e.streamDataController.busy})}});this._tmpPoint=b.makeDehydratedPoint(0,0,0,this.crsIndex),this.addResolvingPromise(r),this.when(function(){return e._startNodeLoading()})},t.prototype.destroy=function(){this._abortController.abort(),this._abortController=null,this._idleStateCallbacks&&(this._isIdle=!1,this._idleStateCallbacks.remove(),this._idleStateCallbacks=null),this._handles.destroy(),this._nodeLoader=null,R.prune()},t.prototype._getRequiredAttributes=function(){if(null==this._attributeStorageInfo||!this._fields||!this.layerView.availableFields)return[];var e=this._attributeStorageInfo,t=this._fields,r=this.layer.objectIdField;return this.layerView.availableFields.map(function(r){var n=N(e,r),i=N(t,r);return n>=0&&i>=0?{index:n,name:t[i].name,field:t[i],attributeStorageInfo:e[n]}:null}).filter(function(e){return null!=e&&e.name!==r})},t.prototype._requiredFieldsChange=function(){O(this._requiredAttributes,this._getRequiredAttributes())||this.requestUpdate()},t.prototype.requestUpdate=function(){this._requiredAttributesDirty=!0,this.restartNodeLoading()},t.prototype._setClippingArea=function(e){var t=m.create();P.extentToBoundingBox(e,t,this.layerView.view.renderSpatialReference)?this._clippingArea=t:this._clippingArea=null},t.prototype._pointOfInterestChanged=function(){this._poi&&(this._calculatePointOfInterest(this._poi),this._viewportQueries&&(this._viewportQueries.setPointOfInterest(this._poi),this._index&&(this._index.progressiveLoadPenalty=V.distancePenalty*this._viewportQueries.distCameraToPOI(),this._index.requestUpdate())))},t.prototype._calculatePointOfInterest=function(e){var t=this._centerOnSurface.renderLocation,r=_.vec3f64.create();y.vec3.subtract(r,t,this.camPos);var n=this.layerView.view.renderCoordsHelper,i=_.vec3f64.create();n.worldUpAtPosition(t,i);var o=y.vec3.angle(i,r)-.5*Math.PI;return y.vec3.lerp(e,this.camPos,t,Math.max(0,Math.min(1,o/(.5*Math.PI)))),e},t.prototype.updateClippingArea=function(e){this._setClippingArea(e),this._viewportQueries&&this._index&&(this._viewportQueries.updateExtent(this._clippingArea),this._index.invalidateVisibilityCache()),this._setCameraDirty()},t.prototype._setCameraDirty=function(){this._cameraDirty=!0,this.notifyChange("rootNodeVisible"),this._lodHandling.setLodGlobalDirty(),this._evaluateUpdating()},t.prototype.updateElevationChanged=function(e,t){if(null!=this._index){null==this._elevationUpdateNodes&&(this._elevationUpdateNodes=new p({deallocator:null}));var r=this._elevationUpdateNodes;r.clear();var n=this._index.rootNode;null!=n&&S.findIntersectingNodes(e,t,n,this.crsIndex,this._index,function(e){return r.push(e.index)});for(var i=0;i<r.length;i++){var o=r.data[i];this._index.invalidateBoundingVolumeCache(o),o===n.index&&this.notifyChange("rootNodeVisible")}r.length&&this.restartNodeLoading()}},t.prototype.getParentIndex=function(e){return this._index.getParentIndex(e)},t.prototype._elevationInfoChanged=function(){this._index.updateElevationInfo(this.layer.elevationInfo),this._setCameraDirty()},t.prototype._updateScaleHandles=function(){var e=this;this._handles.remove("scale-bounds"),this.areScaleBoundsActive&&this._handles.add(this.layerView.view.basemapTerrain.on("scale-change",function(t){return e._scaleUpdateHandler(t)}),"scale-bounds")},t.prototype._scaleBoundsChanged=function(){this.areScaleBoundsActive||this._loadedNodeScales.clear(),this._updateScaleHandles(),this._setCameraDirty()},t.prototype._scaleUpdateHandler=function(e){this._updateScaleInBoundingRect(e.scale,e.extent,e.spatialReference),this._setCameraDirty()},t.prototype._updateScaleInBoundingRect=function(e,t,r){var n=this;null!=this._index.rootNode&&P.boundingRectToBoundingRect(t,r,G,this.crsIndex)&&this._loadedNodeScales.forEach(function(t,r){var i=n._index.getNode(r);g.containsPoint(G,i.mbs)&&n._loadedNodeScales.set(r,e)})},t.prototype.restartNodeLoading=function(){this._restartNodeLoading=!0,this.cancelNodeLoading(),this._evaluateUpdating()},t.prototype.schedule=function(e,t){var r=this;return this._idleQueue.push(t).then(function(t){if(!r._loadingNodeRevisions.has(e)&&!r._updatingNodes.has(e))throw c.createAbortError();return t})},t.prototype.reschedule=function(e,t){var r=this;return this._idleQueue.unshift(t).then(function(t){if(!r._loadingNodeRevisions.has(e)&&!r._updatingNodes.has(e))throw c.createAbortError();return t})},Object.defineProperty(t.prototype,"isIntegratedMesh",{get:function(){return"integrated-mesh"===this.layer.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"areScaleBoundsActive",{get:function(){var e=C.extractSafeScaleBounds(this.layer),t=e.minScale,r=e.maxScale;return this.scaleVisibilityEnabled&&(t>0||r>0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unloadedMemoryEstimate",{get:function(){return!this._index||this.layerView.suspended?0:this._index.getUnloadedMemoryEstimate()*this.lodDropFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"indexDepth",{get:function(){return this._index?this._index.maxLevel:0},enumerable:!0,configurable:!0}),t.prototype._frame=function(e,t){return this.layerView.suspended?(this._updateViewData(),this._evaluateUpdating(),-1/0):this.layerView.visible?(this._processLogError(e,t),this._index.getPriority()):-1/0},t.prototype._processLogError=function(e,t){try{this._process(e,t)}catch(e){this._errorCount<50?T.error("Error during processing: "+e):50===this._errorCount&&T.error("Too many errors for this layer. Further errors will not be displayed."),this._errorCount++}},t.prototype._process=function(e,t){var r=this;if(this._restartNodeLoading&&this._startNodeLoading(),null!=this._nodeLoader&&null!=this._index){for(this._updateViewData(),this._invisibleDirty&&this._removeInvisibleNodes(e)&&(this._invisibleDirty=!1),this.isIntegratedMesh&&(e.enabled=!1),e.run(function(){return r._processIndex(t,e)}),this._updateFeatureLOD(),e.run(function(){return r._processCache(e,t)}),this.isIntegratedMesh&&(e.enabled=!0),e.run(function(){return r._processNodes(e,t)});!e.done&&this._idleQueue.process();)e.madeProgress();e.run(function(){return r._prefetchIndex(t)}),t.numIndexLoading+=this._index.getIndexLoading(),t.numNodesLoading+=this._downloadingNodes.size,e.run(function(){return r._lodHandling.lodGlobalHandling(e)}),this._evaluateUpdating()}},t.prototype._processIndex=function(e,t){if(this._index.dirty){this._newLoadingNodes.clear(),this._index.update(o.keysOfMap(this._loadingNodeRevisions),t),!this.disableMemCache&&this.layerView.loadCachedGPUData&&this.layerView.addCachedGPUData&&(this._newLoadingNodes.pushArray(this._index.updates.add.data,this._index.updates.add.length),this._newLoadingNodes.pushArray(this._index.updates.missing.data,this._index.updates.missing.length));var r=this._index.getFeatureEstimate().leafsReached;this._index.isLoading()||r===this._get("leafsReached")||this._set("leafsReached",r)}return this._index.load()},t.prototype._prefetchIndex=function(e){return!(this._loadingNodeRevisions.size>0||this._index.updates.add.length>0)&&this._index.prefetch()},t.prototype._updateFeatureLOD=function(){if(this.isGraphics3D){var e=!this._index.isLoading(),t=this.featureTarget*this.baseLOD,r=this._index.getFeatureEstimate();if(r.estimate=r.estimate||t/2,this._index.getIndexMissing()>500){if(this._featureLOD<=1e-4)return;this._featureLOD/=1.5,this._stableFeatureLOD=!1}else if(e&&r.estimate<t){if(r.leafsReached||this._featureLOD>=1e4||this._stableFeatureLOD)return;var n=Math.min(10,Math.max(t/r.estimate,1.001));this._featureLOD*=n;var i=this.lod,o=this._index.checkFeatureTarget(t,i);o!==i&&(this._featureLOD=o/this.baseLOD,this._stableFeatureLOD=!0)}else{if(!(r.estimate>1.2*t||e&&r.estimate>t))return;if(this._featureLOD<=1e-4)return;this._featureLOD/=1+.25*(r.estimate/t-1),this._stableFeatureLOD=!1}this._featureLOD=Math.min(1e4,Math.max(1e-4,this._featureLOD)),this._viewportQueries.updateScreenSpaceErrorBias(this.lod),this._index.requestUpdate()}},t.prototype._processCache=function(e,t){for(;this._newLoadingNodes.length>0&&!e.done;)for(var r=this._newLoadingNodes.pop(),n=this._index.getParent(r);n&&!this.layerView.isNodeLoaded(n.index)&&this._isNodeInScaleBounds(n);n=this._index.getParent(n.index))if(this._enableFromGPUCache(n,"hole")){e.madeProgress();break}return e.hasProgressed},t.prototype._processNodes=function(e,t){var r=(this._isIdle?100:2)-this._loadingNodeRevisions.size,n=this._index.updates;for(n.cancel.forEach(this._cancelNode,this),n.cancel=[];n.update.length>0&&!e.done;){var i=this._index.getNode(n.update.pop());this._updateLoadedNode(i),e.madeProgress()}for(;n.add.length>0&&!e.done&&r>0;){if(--r,2!==(i=this._index.getNode(n.add.back())).cacheState&&!this._hasNodeLoadToken(t))break;n.add.pop(),this._loadNode(i),e.madeProgress()}return e.hasProgressed},t.prototype._cancelAllNodes=function(){this._loadingNodeRevisions.clear(),this._downloadingNodes.clear(),this._updatingNodes.clear(),this._abortController.abort(),this._abortController=new AbortController},t.prototype._cancelNode=function(e){this._loadingNodeRevisions.delete(e),this._downloadingNodes.delete(e)},t.prototype._hasNodeLoadToken=function(e){return!(!this._isIdle&&e.numNodesLoading+this._loadingNodeRevisions.size>=2||this.streamDataController.busy)},t.prototype._evaluateUpdating=function(){var e=!1,t=0;if(this.layerView.suspended)t=(e=this._cameraDirty)?100:0;else{var r=(this._index?this._index.getIndexMissing():0)+3*(this._index?this._index.updates.add.length:0)+2*this._loadingNodeRevisions.size;e=!!(r>0||this._updatingNodes.size>0||this._restartNodeLoading||this._cameraDirty||this._idleQueue.length>0||this._lodHandling&&this._lodHandling.requiresLODGlobalHandling),0===r&&(this._progressMaxNumNodes=1),this._progressMaxNumNodes=Math.max(r,this._progressMaxNumNodes),t=100*r/this._progressMaxNumNodes}e!==this.updating&&this._set("updating",e),t!==this.updatingPercentage&&this._set("updatingPercentage",t)},t.prototype._updateViewData=function(){if(this._cameraDirty&&this._index){var e=this.layerView.view,t=e.state.camera;this.camPos=_.vec3f64.clone(e.pointsOfInterest.renderPointOfView),this.screenSizeFactor=1/(t.perScreenPixelRatio/2),this._poi=this._calculatePointOfInterest(this._poi),this._viewportQueries.updateCamera(t),this._viewportQueries.setPointOfInterest(this._poi),this._viewportQueries.updateScreenSpaceErrorBias(this.lod),this._index.invalidateVisibilityCache(),this._index.progressiveLoadPenalty=V.distancePenalty*this._viewportQueries.distCameraToPOI(),this._index.requestUpdate(),this._stableFeatureLOD=!1,this._invisibleDirty=!0,this._cameraDirty=!1,this.notifyChange("rootNodeVisible")}},t.prototype._getProgressiveLoadFactor=function(e){return this.layerView.view.resourceController.memoryController.memoryFactor<1?1:this.layerView.progressiveLoadFactor},Object.defineProperty(t.prototype,"lod",{get:function(){return this._featureLOD*this.baseLOD},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseLOD",{get:function(){var e=this.layerView.lodFactor,t=this.layerView.view.resourceController.memoryController.memoryFactor;return this.fixedFeatureTarget?1:(e>0?e:1)*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lodDropFactor",{get:function(){if(this.fixedFeatureTarget)return 1;var e=this.layerView.view.resourceController.memoryController;return(Math.min(e.memoryFactor,.5)-e.minQuality)/(.5-e.minQuality)},enumerable:!0,configurable:!0}),t.prototype.isGeometryVisible=function(e){return this._index.isGeometryVisible(e.index)},t.prototype.updateVisibility=function(e){return this._index.invalidateVisibilityCache(e)},t.prototype._shouldLoadNode=function(e){return!(!this._lodHandling.shouldLoadNode(e)||this._shouldDropNode(e)||!this._isNodeInScaleBounds(e))&&(!e.obb||this._index.isGeometryVisible(e.index))},t.prototype._shouldDropNode=function(e){var t=this.lodDropFactor;return!(t>=1||!this._lodHandling.childrenEmpty(e))&&Math.abs(this._viewportQueries.calcCameraDistanceToCenter(e))-this._viewportQueries.minDistance>(this._viewportQueries.maxDistance-this._viewportQueries.minDistance)*t},t.prototype._startNodeLoading=function(){var e=this;if(this._restartNodeLoading=!1,!this._updatesDisabled&&null!=this.streamDataController){this._updateViewData(),this._requiredAttributesDirty&&(this._requiredAttributes=this._getRequiredAttributes(),this._requiredAttributesDirty=!1);var t=I.TextureFormat.Normal;this.layerView.useCompressedTextures?t=I.TextureFormat.Compressed:this.uncompressedTextureDownsamplingEnabled&&(t=I.TextureFormat.Downsampled);var r={textureFormat:t,textureUsageMask:this.layerView.rendererTextureUsage,loadFeatureData:!this.isMeshPyramid};this._nodeLoader=new I(this.layer,this.streamDataController,T,this._defaultGeometrySchema,this._requiredAttributes,r);var n=this.layerView.view.renderSpatialReference,i=this.crsIndex.equals(n)||this.crsIndex.isWGS84&&n.equals(P.SphericalECEFSpatialReference);this._index.ignoreServiceOBB=!i,this._index.requestUpdate(),this._lodHandling.startNodeLoading(function(t){return e._index.isNodeVisible(t)},function(t){return e._index.isGeometryVisible(t)},function(t){return e._isNodeInScaleBounds(t)},function(t){return e._index.nodeTraversalState(t)},function(t,r){return e._removeNodes(t,r)},this._index,{maxLodLevel:this._viewportQueries.maxLodLevel}),this._evaluateUpdating()}},t.prototype.isNodeLoading=function(){return null!=this._nodeLoader&&null!=this._index},t.prototype.cancelNodeLoading=function(){this.isNodeLoading()&&(this.streamDataController.cancelAll(),this._idleQueue.cancelAll(),this._cancelAllNodes(),this._nodeLoader=null,this._evaluateUpdating())},t.prototype._removeInvisibleNodes=function(e){var t=this;R.clear(),this.layerView.getLoadedNodeIndices(R);var r=0===this._viewportQueries.maxDistance,n=r?function(){return!1}:function(e){return t._shouldDropNode(e)};return R.filterInPlace(function(e){var r=t._index.getNode(e);return!t._index.isGeometryVisible(e)||n(r)||!t._isNodeInScaleBounds(r)}),R.length>0&&this._lodHandling.setLodGlobalDirty(),this._removeNodes(R,e),!(r&&this.lodDropFactor<1||0!==R.length&&(R.clear(),1))},t.prototype._removeNodes=function(e,t){e.length>0&&this._index.requestUpdate();var r=e.length;if(this.layerView.removeNodeData(e,t),this._loadedNodeScales.size>0)for(var n=e.length;n<r;n++){var i=e.data[n];this._loadedNodeScales.delete(i)}},t.prototype._needsUpdate=function(e){if(!e.resources.hasFeatureData||this._updatingNodes.has(e.index))return!1;var t=this.layerView.getLoadedAttributes(e.index);return null!=t&&t!==this._requiredAttributes},t.prototype._updateLoadedNode=function(e){var t=this,r=O(this.layerView.getLoadedAttributes(e.index),this._requiredAttributes)?c.resolve(this.layerView.getAttributeData(e.index)):this._nodeLoader.loadAttributes(e,this._requiredAttributes,this._abortController.signal);this._updatingNodes.add(e.index),r.then(function(r){return t.schedule(e.index).then(function(){return t.layerView.setAttributeData(e.index,{loadedAttributes:t._requiredAttributes,attributeData:r})})}).catch(function(r){c.isAbortError(r)||t.layerView.setAttributeData(e.index,{loadedAttributes:t._requiredAttributes,attributeData:{}})}).catch(function(){}).then(function(){t._updatingNodes.delete(e.index),t._evaluateUpdating()}),this._evaluateUpdating()},t.prototype._loadNode=function(e){var t=this,r=this._nextLoadingNodeRevision++;this._loadingNodeRevisions.set(e.index,r),this._evaluateUpdating(),this._loadAndAddNode(e).catch(function(e){return e}).then(function(){t._loadingNodeRevisions.get(e.index)===r&&t._loadingNodeRevisions.delete(e.index),t._evaluateUpdating()})},t.prototype._loadAndAddNode=function(e){var t=this;return 1===e.cacheState?this._loadUncached(e):this._loadCached(e).then(function(r){r||(e.cacheState=1,t._index.updates.add.push(e.index))}).catch(function(t){c.isAbortError(t)||(e.cacheState=1)})},t.prototype._enableFromGPUCache=function(e,t){if(this.disableMemCache||!this.layerView.loadCachedGPUData||!this.layerView.addCachedGPUData)return!1;var r=this._loadCachedGPUData(e);return!!r&&(this.layerView.addCachedGPUData(e,r,t),this._nodeAdded(e),!0)},t.prototype._loadCachedGPUData=function(e){var t=this.layerView.loadCachedGPUData(e);return t&&F(t.attributeInfo)&&O(t.attributeInfo.loadedAttributes,this._requiredAttributes)?t:null},t.prototype._nodeAdded=function(e){this._index.requestUpdate(),this._lodHandling.setLodGlobalDirty(),this._evaluateUpdating()},t.prototype._loadCached=function(e){var t=this;if(this._enableFromGPUCache(e,"leaf"))return c.resolve(!0);var r=this.layerView;return!this.disableIDBCache&&r.loadCachedNodeData&&r.addCachedNodeData?this.schedule(e.index).then(function(){return r.loadCachedNodeData(e,t._abortController.signal,function(r,n){return t._nodeLoader.loadTextures(e,r,n)})}).then(function(n){if(null==n)return!1;var i=t._requiredAttributes;return F(n)&&O(n.loadedAttributes,i)?t.reschedule(e.index).then(function(){return r.addCachedNodeData(e,n,n)}).then(function(){return t._nodeAdded(e),!0}):t.reschedule(e.index).then(function(){return t._nodeLoader.loadAttributes(e,i,t._abortController.signal)}).then(function(r){return t.reschedule(e.index,{loadedAttributes:i,attributeData:r})}).then(function(t){return r.addCachedNodeData(e,n,t)}).then(function(){return t._nodeAdded(e),!0})}):c.resolve(!1)},t.prototype._loadUncached=function(e){var t=this;return this._downloadingNodes.add(e.index),a.safeCast(this._nodeLoader.loadNodeData(e,this._abortController.signal)).then(function(r){return t._downloadingNodes.delete(e.index),t.schedule(e.index,r)}).then(function(r){return t.layerView.addNodeData(e,r)}).then(function(){t._nodeAdded(e),e.cacheState=2}).catch(function(r){c.isAbortError(r)||(T.error("Failed to load node '"+e.id+"': "+r),e.failed=!0,t._index.requestUpdate())})},t.prototype._updateIdleState=function(e){e!==this._isIdle&&(this._isIdle=e,this._evaluateUpdating(),e&&this._index&&this._index.resetFailedNodes())},t.prototype._getScale=function(e){if(this._loadedNodeScales.has(e.index))return this._loadedNodeScales.get(e.index);var t=e.mbs;this._tmpPoint.x=t[0],this._tmpPoint.y=t[1],this._tmpPoint.z=t[2];var r=this.layerView.view.basemapTerrain.getScale(this._tmpPoint);return this.layerView.isNodeLoaded(e.index)&&this._loadedNodeScales.set(e.index,r),r},t.prototype._isNodeInScaleBounds=function(e){if(!this.areScaleBoundsActive)return!0;var t=this._getScale(e),r=C.extractSafeScaleBounds(this.layer),n=r.minScale,i=r.maxScale;return C.scaleBoundsPredicate(t,n,i)},t.prototype.updateStats=function(e){e.index=this._index?this._index.size:0,this.isGraphics3D&&(e.detail=this._featureLOD,e.target=this.featureTarget*this.baseLOD),this._index&&this._index.updateStats(e)},Object.defineProperty(t.prototype,"test",{get:function(){var e=this;return{set disableIDBCache(t){e.disableIDBCache=t},set ignoreServiceOBB(t){e._index.ignoreServiceOBB=t}}},enumerable:!0,configurable:!0}),n([f.property({readOnly:!0})],t.prototype,"isMeshPyramid",null),n([f.property({readOnly:!0})],t.prototype,"isGraphics3D",null),n([f.property({readOnly:!0})],t.prototype,"streamDataController",null),n([f.property({readOnly:!0})],t.prototype,"crsVertex",null),n([f.property({readOnly:!0})],t.prototype,"crsIndex",null),n([f.property()],t.prototype,"camPos",void 0),n([f.property()],t.prototype,"screenSizeFactor",void 0),n([f.property()],t.prototype,"featureTarget",void 0),n([f.property()],t.prototype,"fixedFeatureTarget",void 0),n([f.property()],t.prototype,"layerView",void 0),n([f.property()],t.prototype,"layer",void 0),n([f.property({readOnly:!0})],t.prototype,"updating",void 0),n([f.property({readOnly:!0})],t.prototype,"updatingPercentage",void 0),n([f.property({readOnly:!0})],t.prototype,"leafsReached",void 0),n([f.property({constructOnly:!0})],t.prototype,"scaleVisibilityEnabled",void 0),n([f.property({readOnly:!0})],t.prototype,"rootNodeVisible",null),n([f.property({aliasOf:"layerView.uncompressedTextureDownsamplingEnabled?"})],t.prototype,"uncompressedTextureDownsamplingEnabled",void 0),n([f.subclass("esri.layers.graphics.controllers.I3SOnDemandController")],t)}(f.declared(d.EsriPromiseMixin(i))),R=new p({deallocator:null}),V={factorIM:.2,factor3dObject:.05,distancePenalty:10},G=g.create();return M}.apply(null,n))||(e.exports=i)},1751:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(43),r(145)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.referenceCount=0,this.callbacks=[],this.runIndex=0,this.handle=e.registerTask(n.Task.I3S_CONTROLLER,function(e){return t.update(e)},function(){return t.needsUpdate()})}return e.prototype.destroy=function(){this.handle&&(this.handle.remove(),this.handle=null)},e.prototype.needsUpdate=function(){for(var e=0,t=this.callbacks;e<t.length;e++)if(t[e].needsUpdate())return!0;return!1},e.prototype.update=function(e){this.sort();for(var t=this.callbacks,r={numIndexLoading:0,numNodesLoading:0},n=0;n<t.length&&!e.done;++n)t[n].priority=t[n].update(e,r),this.runIndex=n},e.prototype.sort=function(){for(var e=this.callbacks,t=e.length,r=this.runIndex;r>0;r--){for(var n=e[r-1],i=r;i<e.length&&n.priority<=e[i].priority&&(i!==t||n.priority<e[i].priority);)e[i-1]=e[i],i++;e[i-1]=n,t=i-1}this.runIndex=0},e.prototype.add=function(e){this.sort(),e.priority=1/0,this.callbacks.unshift(e)},e.prototype.remove=function(e){r.removeUnordered(this.callbacks,e),this.runIndex=this.callbacks.length,this.sort()},e}(),o=new Map;t.addTask=function(e,t){var r=o.get(e);return null==r&&(r=new i(e),o.set(e,r)),r.add(t),{remove:function(){if(null!=r){if(r.remove(t),r.callbacks.length>0)return void(r=null);o.delete(e),r.destroy(),r=null}}}}}.apply(null,n))||(e.exports=i)},1752:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(9),r(75),r(7),r(8),r(35),r(1641),r(1655)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l){function p(e){e.node?(e.node.renderMbs[3]=-1,e.node.renderObb.halfSize[0]=-1):e.ref&&(e.ref.renderMbs[3]=-1,e.ref.renderObb.halfSize[0]=-1)}function d(e){return u.addWraparound(e,-2)}function c(e){return u.addWraparound(e,2)}function h(e,t){return 0===t?0:e/t|0}function f(e,t){return 0===t?e:e%t}function y(e){if(e)for(var t=0;t<e.length;t++)for(var r=0,n=v;r<n.length;r++){var i=n[r];if(i[0]===e[t].metricType)return{lodMetric:i[1],maxError:e[t].maxError}}return{lodMetric:0,maxError:0}}function _(e){return Math.sqrt(e*(4/Math.PI))}Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t,r,n,o,a,s,u,l){this.streamDataController=t,this.viewportQueries=r,this.logger=n,this._isLoaded=o,this._isSelected=a,this._enable=s,this._needsUpdate=u,this._canRequest=l,this._dirty=!0,this.nodePages=[],this.nodeCount=0,this.nodesPerPage=0,this.rootIndex=0,this.lodMetric=0,this.lodConversion=function(e){return e},this._loading=new Set,this._failedNodes=new Set,this._failedPages=new Set,this._indexMissing=1,this._maxUnloadedPrio=Number.NEGATIVE_INFINITY,this._maxProcessingPrio=Number.POSITIVE_INFINITY,this._nodeTraversalState={},this._version=0,this._visibilityCacheGeneration=c(0),this._maxLevel=1,this._featureEstimate={estimate:0,leafsReached:!1},this._unloadedMemoryEstimate=0,this._missing=new i({deallocator:null}),this._prefetch=new i({deallocator:null}),this._updates=new b,this.ignoreServiceOBB=!1,this.progressiveLoadPenalty=0,this.layerUrl=e.parsedUrl.path,this.rootId=e.rootNode&&e.rootNode.split("/").pop(),e.serviceUpdateTimeStamp&&e.serviceUpdateTimeStamp.lastUpdate&&(this.lastUpdate=""+e.serviceUpdateTimeStamp.lastUpdate),this._maxLodLevel=this.viewportQueries?this.viewportQueries.maxLodLevel:1,e.nodePages?this.initNodePages(e.nodePages):this.initNodeDocuments(this.rootId)}return e.prototype.initNodePages=function(e){switch(this.nodesPerPage=e.nodesPerPage,this.rootIndex=e.rootIndex,e.lodSelectionMetricType){case"maxScreenThreshold":this.lodMetric=1;break;case"maxScreenThresholdSQ":this.lodMetric=1,this.lodConversion=_}},e.prototype.initNodeDocuments=function(e){this.nodesPerPage=0,this.rootIndex=0,this.nodePages.push({nodes:[],children:[],parents:[]}),this.makeRefNode({id:e,mbs:null},-1)},e.prototype.loadPage=function(e){var t=this;this._loading.add(e);var r=this.layerUrl+"/nodepages/"+e;return this.streamDataController.request(r,"json").then(function(r){t._loading.delete(e),t.addPage(e,r)}).catch(function(r){return t._loading.delete(e),o.isAbortError(r)?o.reject(r):(t._failedPages.add(e),0===t.nodePages.length&&t.initNodeDocuments(t.rootId),o.reject(r))})},e.prototype.addPage=function(e,t){for(var r=this,n=this.nodePages.length;n<e;n++)this.nodePages[n]=null;var i=[],o=[],u=t.nodes.map(function(t,n){var u=i.length,p=t.children?t.children.length:0;o.push(-1);for(var c=0;c<p;c++)i.push(t.children[c]);var h=""+t.index,f=l.clone(t.obb),y=s.vec4f64.fromArray([f.center[0],f.center[1],f.center[2],a.vec3.length(f.halfSize)]),_=t.mesh&&t.mesh.attribute,m=t.mesh&&t.mesh.geometry,g=t.mesh&&t.mesh.material,b={hasSharedResource:!1,hasFeatureData:!!m,attributes:_&&null!=_.resource?""+_.resource:null,geometry:m&&null!=m.resource?""+m.resource:null,texture:g&&null!=g.resource&&g.texelCountHint>0?""+g.resource:null,geometryDefinition:m?m.definition:-1,materialDefinition:g?g.definition:-1},v={id:h,index:e*r.nodesPerPage+n,childCount:p,failed:!1,cacheState:0,obb:f,mbs:y,level:0,resources:b,lodMetric:r.lodMetric,maxError:r.lodConversion(t.lodThreshold),renderMbs:s.vec4f64.fromArray([0,0,0,-1]),renderObb:l.create([0,0,0],[-1,-1,-1],[0,0,0,1]),numFeatures:m?m.featureCount:null,vertexCount:m?m.vertexCount:null,version:r.lastUpdate};return{childOffset:u,childCount:p,visibilityCache:d(r._visibilityCacheGeneration),ref:null,node:v}});this.nodePages[e]={nodes:u,children:i,parents:o},this.nodeCount+=u.length,this.updateParentsAndLevel()},e.prototype.updateParentsAndLevel=function(){var e=this,t=[],r=function(r,i,o){var a=e.getPage(r);if(n.isSome(a)){var s=f(r,e.nodesPerPage);a.parents[s]=i;var u=a.nodes[s].node;u&&(u.level=o,t.push(r))}};for(r(this.rootIndex,-1,0);t.length;)for(var i=t.pop(),o=this.getNode(i),a=0;a<o.childCount;a++){r(this.getChildIndex(o,a),i,o.level+1)}},e.prototype.getPage=function(e){return this.nodePages[h(e,this.nodesPerPage)]},e.prototype.getNodeInternal=function(e){var t=this.getPage(e);return n.isNone(t)?null:t.nodes[f(e,this.nodesPerPage)]},e.prototype.addNode=function(e,t){null!=e.children&&this.populateChildren(t,e.children);var r=this.getParent(t),i=r?r.level+1:1;this._maxLevel=Math.max(this._maxLevel,i);var o=y(e.lodSelection),a=o.lodMetric,u=o.maxError,p=n.expect(this.getNodeInternal(t));return p.node={id:e.id,index:t,mbs:s.vec4f64.fromArray(e.mbs),obb:e.obb&&l.clone(e.obb),childCount:p.childCount,level:i,resources:e.resources,version:e.version,lodMetric:a,maxError:u,memory:null,numFeatures:e.numFeatures,failed:!1,cacheState:0},null==p.ref.mbs&&(p.ref.mbs=e.mbs),p.node.renderMbs=p.ref.renderMbs,p.node.renderObb=p.ref.renderObb,p.node},e.prototype.makeRefNode=function(e,t){var r=this.nodePages[0],n=r.nodes.length;return r.nodes.push({childOffset:0,childCount:0,node:null,ref:e,visibilityCache:d(this._visibilityCacheGeneration)}),this.nodeCount++,r.parents.push(t),e.renderMbs=s.vec4f64.fromArray([0,0,0,-1]),e.renderObb=l.create([0,0,0],[-1,-1,-1],[0,0,0,1]),n},e.prototype.populateChildren=function(e,t){var r=n.expect(this.getNodeInternal(e)),i=n.expect(this.getPage(e));r.childOffset=i.children.length,r.childCount=t.length;for(var o=0;o<t.length;o++){var a=this.makeRefNode(t[o],e);i.children.push(a)}},e.prototype.getNode=function(e){var t=this.getNodeInternal(e);return n.isSome(t)&&t.node},e.prototype.getIndexById=function(e){var t;return this.forAllNodes(function(r,n){(r.node?r.node.id:r.ref.id)===e&&(t=n)}),t},e.prototype.getNodeById=function(e){var t=this.getIndexById(e),r=null!=t?this.getNodeInternal(t):null;return n.isSome(r)?r.node:null},e.prototype.getChildIndex=function(e,t){var r=this.getPage(e.index);if(n.isNone(r))return-1;var i=r.nodes[f(e.index,this.nodesPerPage)];return r.children[i.childOffset+t]},e.prototype.getParentIndex=function(e){var t=this.getPage(e);return n.isSome(t)?t.parents[f(e,this.nodesPerPage)]:-1},e.prototype.getParent=function(e){return(e=this.getParentIndex(e))>=0?this.getNode(e):null},Object.defineProperty(e.prototype,"rootNode",{get:function(){var e=this.getNodeInternal(this.rootIndex);return n.isSome(e)?e.node:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.nodeCount},enumerable:!0,configurable:!0}),e.prototype.invalidateVisibilityCache=function(e){if(null!=e){var t=this.getNodeInternal(e);n.isSome(t)&&(t.visibilityCache=d(this._visibilityCacheGeneration))}else this._visibilityCacheGeneration=c(this._visibilityCacheGeneration)},e.prototype.isNodeVisible=function(e){var t=this.getNodeInternal(e);if(n.isNone(t)||t.ref&&!t.ref.mbs)return!0;if(!function(e,t){return(-2&e)===t}(t.visibilityCache,this._visibilityCacheGeneration)){var r=this.viewportQueries.isNodeVisible(t.ref||t.node);return t.visibilityCache=function(e,t){return t+(e?1:0)}(r,this._visibilityCacheGeneration),r}return function(e){return 1==(1&e)}(t.visibilityCache)},e.prototype.isGeometryVisible=function(e){if(!this.isNodeVisible(e))return!1;var t=this.getNodeInternal(e);return!!n.isNone(t)||!(t.node&&t.ref&&!t.ref.obb)||this.viewportQueries.isGeometryVisible(t.node)},Object.defineProperty(e.prototype,"maxLevel",{get:function(){return this._maxLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dirty",{get:function(){return this._dirty},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._updates.add.prune(),this._updates.update.prune()},e.prototype.requestUpdate=function(){this._dirty=!0,this._indexMissing=1,++this._version},e.prototype.update=function(e,t){var r=this;if(this._dirty){this._maxUnloadedPrio=Number.NEGATIVE_INFINITY,this._maxProcessingPrio=Number.NEGATIVE_INFINITY,this._missing.clear(),this._prefetch.clear(),this._updates.reset(e,this._missing),g.clear();var i=!0,o=new x,a=new x;this.traverseVisible(function(s,u){if(!u){var l=r.entryPriority(s),p=h(s,r.nodesPerPage);return g.set(p,Math.max(l,g.get(p)||0)),r._loading.has(p)||r._failedPages.has(p)||r._missing.push(p),void(r._maxProcessingPrio=Math.max(r._maxProcessingPrio,l))}var d=u.node;if(r._updateNodeFeatureEstimate(d,a),!d){var c=r.entryPriority(s);return r._loading.has(s)||r._failedNodes.has(s)||(r._missing.push(s),g.set(s,c)),void(r._maxProcessingPrio=Math.max(r._maxProcessingPrio,c))}var f=n.expect(r.getPage(s));if(0===r._missing.length&&0===r.nodesPerPage)for(var y=0;y<u.childCount;y++){var _=f.children[u.childOffset+y],m=r.getNodeInternal(_);!n.isSome(m)||m.node||r._loading.has(_)||r._failedNodes.has(_)||(g.set(_,r.entryPriority(_)),r._prefetch.push(_))}if(!d.failed&&d.resources.hasFeatureData)if(r._isLoaded(s)){if(o.known+=d.memory,++o.knownNodes,r._isSelected(d)?u.childCount>0&&(i=!1):(o.unremoved+=d.memory,i=!1),r._needsUpdate(d)){var b=r.entryPriority(s);g.set(s,b),r._maxProcessingPrio=Math.max(r._maxProcessingPrio,b),r._updates.update.push(s)}}else if(d.memory&&(o.known+=d.memory,++o.knownNodes),r._isSelected(d)){if(u.childCount>0&&(i=!1),d.memory?(o.missing+=d.memory,o.known+=d.memory,++o.knownNodes):++o.missingNodes,e.indexOf(d.index)>=0)return r._maxProcessingPrio=Math.max(r._maxProcessingPrio,r.entryPriority(s)),void(r._updates.cancel=r._updates.cancel.filter(function(e){return e!==d.index}));if(!t.done&&r._enable(d))return void t.madeProgress();var v=r.entryPriority(s);g.set(s,v),r._maxProcessingPrio=Math.max(r._maxProcessingPrio,v),r._updates.add.push(s)}}),this._unloadedMemoryEstimate=o.missing-o.unremoved,o.knownNodes>3&&o.missingNodes>0&&(this._unloadedMemoryEstimate+=o.known/o.knownNodes*o.missingNodes),this._unloadedMemoryEstimate=.8*Math.max(0,this._unloadedMemoryEstimate),this._featureEstimate.estimate=this._computeFeatureEstimate(a),this._featureEstimate.leafsReached=i,this._missing.sort(function(e,t){return e-t}),this._missing.filterInPlace(function(e,t){return t<1||r._missing.data[t-1]!==e}),this._missing.sort(function(e,t){return g.get(e)-g.get(t)}),this._missing.length>0?(this._maxUnloadedPrio=g.get(this._missing.back()),this._prefetch.clear()):this._prefetch.sort(function(e,t){return g.get(e)-g.get(t)}),this._updates.add.filterInPlace(function(e){return g.get(e)>=r._maxUnloadedPrio}).sort(function(e,t){return g.get(e)-g.get(t)}),this._updates.update.sort(function(e,t){return g.get(e)-g.get(t)}),this._indexMissing=this._loading.size+this._missing.length,this._dirty=this._indexMissing>0,g.clear()}},e.prototype.checkFeatureTarget=function(e,t){for(var r=this.viewportQueries.updateScreenSpaceErrorBias(t),n=t,i=t,o=r,a=10;a--;){var s=new x;if(this._updateFeatureEstimate(n,s),this._computeFeatureEstimate(s)<=e){if(n>=t||s.missingNodes>0||0===a)break;o=n,n=.5*(n+i)}else i=n,n=.5*(n+o)}return++this._version,this.viewportQueries.updateScreenSpaceErrorBias(r),Math.min(t,n)},e.prototype._updateFeatureEstimate=function(e,t){var r=this;++this._version,this.viewportQueries.updateScreenSpaceErrorBias(e),this.traverseVisible(function(e,n){return r._updateNodeFeatureEstimate(n&&n.node,t)})},e.prototype._updateNodeFeatureEstimate=function(e,t){if(e&&!e.failed&&null!=e.numFeatures)return this._isLoaded(e.index)?(t.known+=e.numFeatures,++t.knownNodes,void(this._isSelected(e)||(t.unremoved+=e.numFeatures))):void(this._isSelected(e)&&(e.numFeatures?(t.missing+=e.numFeatures,t.known+=e.numFeatures,++t.knownNodes):++t.missingNodes))},e.prototype._computeFeatureEstimate=function(e){var t=e.known-e.unremoved;return e.knownNodes>3&&e.missingNodes>0&&(t+=e.known/e.knownNodes*e.missingNodes),Math.max(0,t)},e.prototype.load=function(){return this._load(this._missing)},e.prototype.prefetch=function(){return this._load(this._prefetch)},e.prototype._load=function(e){if(0===e.length||!this._canRequest())return!1;for(;e.length>0&&this._canRequest();)0===this.nodesPerPage?this._loadNode(e.pop()):this.loadPage(e.pop());return!0},e.prototype.isLoading=function(){return this._indexMissing>0},e.prototype.getIndexLoading=function(){return this._loading.size},e.prototype.getIndexMissing=function(){return this._indexMissing},e.prototype.getUnloadedMemoryEstimate=function(){return this._unloadedMemoryEstimate},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),e.prototype.getFeatureEstimate=function(){return this._featureEstimate},e.prototype.nodeTraversalState=function(e){if(!e)return null;var t=this._nodeTraversalState[e.index];if(t&&t.version===this._version)return t;var r=this.viewportQueries.getLodLevel(e),n=this.viewportQueries.hasLOD(e),i=!0;if(n){var o=this.getParentIndex(e.index);if(o>=0){var a=this._nodeTraversalState[o];i=a&&r>a.lodLevel}else i=r>0}else i=0===e.childCount;return t?(t.lodLevel=r,t.isChosen=i,t.version=this._version,t):(this._nodeTraversalState[e.index]={nodeHasLOD:n,lodLevel:r,isChosen:i,version:this._version},this._nodeTraversalState[e.index])},e.prototype._loadNode=function(e){var t=this;this._loading.add(e);var r=n.expect(this.getNodeInternal(e)).ref.id,i=this.layerUrl+"/nodes/"+r,a=function(){t._loading.delete(e),0===t._missing.length&&0===t._loading.size&&t.requestUpdate()};this.streamDataController.request(i,"json").then(function(n){var i=t._validateNode(r,n);if(null!=i){i.obb&&t.invalidateVisibilityCache(e);var o=t.addNode(i,e);t.nodeTraversalState(o),a()}else a()},function(r){o.isAbortError(r)||(t.logger.error("Error loading node: "+i),t._failedNodes.add(e)),a()})},e.prototype._validateNode=function(e,t){var r=this;if(null==t||"object"!=typeof t||t.id!==e)return this.logger.error('Invalid node. Wrong type or wrong id "'+e+'"'),null;t.sharedResource&&"./shared"!==t.sharedResource.href&&"./shared/"!==t.sharedResource.href&&this.logger.warn('Invalid shared resource href on node "'+e+'"'),null==t.geometryData||Array.isArray(t.geometryData)&&1===t.geometryData.length&&"./geometries/0"===t.geometryData[0].href||this.logger.warn('Invalid geometry data on node "'+e+'"'),null==t.attributeData||Array.isArray(t.attributeData)&&!t.attributeData.some(function(e,t){return e.href!=="./attributes/f_"+t+"/0"})||this.logger.warn('Invalid attribute data on node "'+e+'"'),t.featureData&&t.featureData.length>1&&this.logger.warn("Node "+e+" has "+t.featureData.length+" bundles. Only the first bundle will be loaded.");var n=t.hasOwnProperty("obb")&&!this.ignoreServiceOBB?t.obb:null,i=t.featureData&&1===t.featureData.length&&t.featureData[0].featureRange?t.featureData[0].featureRange[1]-t.featureData[0].featureRange[0]+1:null,o=Array.isArray(t.children)?t.children.map(function(t){if(null==t)return null;var n=function(t){return r.logger.error("Invalid node reference on node "+e+": "+t)};if("number"==typeof t.id)n("id "+t.id+" is a number instead of a string.");else if("string"!=typeof t.id||!Array.isArray(t.mbs))return n("Missing or invalid id."),null;if(!Array.isArray(t.mbs))return n("Invalid bounding volume on reference "+t.id+"."),null;t.href&&t.href!=="../"+t.id&&r.logger.error('Invalid node href on node "'+e+'"');var i=t.hasOwnProperty("obb")&&!r.ignoreServiceOBB?t.obb:null;return{id:""+t.id,mbs:t.mbs,obb:i}}).filter(function(e){return null!=e}):null;return{id:e,mbs:t.mbs,obb:n,children:o,resources:{hasFeatureData:t.featureData&&t.featureData.length>0,hasSharedResource:null!=t.sharedResource,attributes:t.attributeData?e:null,texture:t.textureData&&t.textureData.length>0?e:null,geometry:null!=t.geometryData?e:null},version:"string"==typeof t.version?t.version:null,lodSelection:Array.isArray(t.lodSelection)?t.lodSelection:null,numFeatures:i}},e.prototype.resetFailedNodes=function(){this._failedNodes.clear(),this._failedPages.clear(),this.forAllNodes(function(e){e.node&&(e.node.failed=!1)})},e.prototype.entryPriority=function(e){var t=this.getNodeInternal(e),r=this.getParentIndex(e);if(n.isNone(t)||r<0&&null==t.node)return r<0?1/0:this.entryPriority(r);var i=0;if(t.node&&r>=0){var o=this._nodeTraversalState[r];null!=o&&(i=o.lodLevel)}for(var a=this.progressiveLoadPenalty,s=e;s>=0;s=this.getParentIndex(s))if(this._isLoaded(s)){a=0;break}var u=this.viewportQueries.distToPOI(t.ref||t.node);return-u-i*(u+this.progressiveLoadPenalty)+a},e.prototype.traverseVisible=function(e){var t=this.getNodeInternal(this.rootIndex);n.isSome(t)?this._traverse(this.rootIndex,t,e):e(this.rootIndex,null)},e.prototype._traverse=function(e,t,r){if(t.node&&0===t.childCount)this.isGeometryVisible(e)&&r(e,t);else if(this.isNodeVisible(e)&&(r(e,t),null!=t.node)){var i=this.nodeTraversalState(t.node);if(!i.nodeHasLOD||i.lodLevel!==this._maxLodLevel)for(var o=n.expect(this.getPage(e)),a=0;a<t.childCount;a++){var s=o.children[t.childOffset+a],u=this.getNodeInternal(s);n.isSome(u)?this._traverse(s,u,r):r(s,null)}}},e.prototype.traverse=function(e,t){t(e)&&this.traverseChildren(e,t)},e.prototype.traverseChildren=function(e,t){var r=e.index,i=this.getNodeInternal(r);n.isSome(i)&&this._traverseChildren(r,i,t)},e.prototype._traverseChildren=function(e,t,r){var i=this.getPage(e);if(!n.isNone(i))for(var o=0;o<t.childCount;++o){var a=i.children[t.childOffset+o],s=this.getNodeInternal(a);n.isSome(s)&&s.node&&r(s.node)&&this._traverseChildren(a,s,r)}},e.prototype.updateStats=function(e){if(this._updates.add.length>0&&(e.nodes+=" + "+this._updates.add.length),(this._indexMissing||this._prefetch.length>0)&&(e.index+=" + "+this._indexMissing||!1),e.prio=this._maxProcessingPrio,this._featureEstimate.estimate){var t=this._featureEstimate.estimate-e.features;t>0?e.features+=" + "+t:t<0&&(e.features+=" - "+-t)}},e.prototype.getPriority=function(){return Math.max(this._maxProcessingPrio,this._maxUnloadedPrio)},e.prototype.updateElevationInfo=function(e){this.forAllNodes(p),this.viewportQueries.updateElevationInfo(e)},e.prototype.invalidateBoundingVolumeCache=function(e){var t=this.getNodeInternal(e);n.isSome(t)&&p(t)},e.prototype.forAllNodes=function(e){for(var t=0;t<this.nodePages.length;t++){var r=this.nodePages[t];if(r)for(var n=t*this.nodesPerPage,i=0;i<r.nodes.length;i++)e(r.nodes[i],n+i)}},Object.defineProperty(e.prototype,"test",{get:function(){var e=this;return{addNode:function(t,r){return e.addNode(t,r)}}},enumerable:!0,configurable:!0}),e}();t.I3SIndex=m;var g=new Map,b=function(){function e(){this.update=new i({deallocator:null}),this.add=new i({deallocator:null}),this.cancel=[]}return e.prototype.reset=function(e,t){this.add.clear(),this.update.clear(),this.cancel=e,this.missing=t},e}(),v=[["maxScreenThreshold",1],["screenSpaceRelative",2],["removedFeatureDiameter",3],["distanceRangeFromDefaultCamera",4]];t.selectErrorMetric=y;var x=function(){return function(){this.known=0,this.knownNodes=0,this.missing=0,this.missingNodes=0,this.unremoved=0}}()}.apply(null,n))||(e.exports=i)},1753:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(75)],void 0===(i=function(e,t,r){var n=function(){function e(e){this.layerView=e,this._lodGlobalDirty=!1}return e.prototype.startNodeLoading=function(e,t,r,n,i,o,a){this._maxLodLevel=a.maxLodLevel,this._index=o,this._nodeTraversalState=n,this._isNodeVisible=e,this._isGeometryVisible=t,this._isNodeInScaleBounds=r,this._removeNodes=i},e.prototype.shouldLoadNode=function(e){var t=this._nodeTraversalState(e);return!!this.isChosenMaxLOD(t)||!!t.isChosen&&this._childrenRequireLoading(e)},e.prototype.setLodGlobalDirty=function(){this._lodGlobalDirty=!0},Object.defineProperty(e.prototype,"requiresLODGlobalHandling",{get:function(){return null!=this._index&&!0===this._lodGlobalDirty},enumerable:!0,configurable:!0}),e.prototype.lodGlobalHandling=function(e){if(!this.requiresLODGlobalHandling)return!1;var t=this.layerView.view.resourceController.memoryController.usedMemory,r=Math.max(0,Math.floor(10*(t-1)));i.clear(),this._lodGlobalHandlingRecursion(this._index.rootNode,r);var n=i.length;this._removeNodes(i,e);var o=i.length<n;return 0===i.length&&(this._lodGlobalDirty=!1),i.clear(),o},e.prototype._lodGlobalHandlingRecursion=function(e,t){if(null==e)return!1;var r=this._nodeTraversalState(e),n=this.isChosenMaxLOD(r),o=this.layerView.isNodeLoaded(e.index);if(o&&null!=this.layerView.updateNodeStatus&&this.layerView.updateNodeStatus(e.index,n?"leaf":"hole"),n&&o)return this._removeChildrenRecursive(e),!0;var a=!1;if(e.childCount>0){a=!0;for(var s=0;s<e.childCount;s++){var u=this._index.getChildIndex(e,s),l=this._index.getNode(u);l?this._isGeometryVisible(u)&&!this._lodGlobalHandlingRecursion(l,t)&&this._isNodeInScaleBounds(l)&&(a=!1):this._isNodeVisible(u)&&(a=!1)}}o&&!n&&(a||i.length<t)&&(i.push(e.index),o=!1);var p=!e.resources.hasFeatureData;return a||o||p},e.prototype._removeChildrenRecursive=function(e){this._index.traverseChildren(e,function(e){return i.push(e.index),!0})},e.prototype.childrenEmpty=function(e){var t=this,r=!0;return this._index.traverseChildren(e,function(e){return!(!r||!t._isNodeVisible(e.index)||t.layerView.isNodeLoaded(e.index)&&(r=!1,1))}),r},e.prototype._childrenRequireLoading=function(e){var t=this,r=!1,n=!0;return this._index.traverseChildren(e,function(e){if(!n||!t._isNodeVisible(e.index))return!1;var i=t._nodeTraversalState(e);return t.isChosenMaxLOD(i)&&t._isGeometryVisible(e.index)&&(r=!0),!t.layerView.isNodeLoaded(e.index)||(n=!1,!1)}),n&&r},e.prototype.isChosenMaxLOD=function(e){return e.isChosen&&(!e.nodeHasLOD||e.lodLevel===this._maxLodLevel)},e}(),i=new r({deallocator:null});return n}.apply(null,n))||(e.exports=i)},1754:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(11),r(18),r(15),r(7),r(31),r(1735),r(1678),r(1755),r(1641)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d){function c(e,t){if(!e||!t||!t.materialDefinitions)return e;var r=Object.keys(t.materialDefinitions)[0];return!t.materialDefinitions[r].params.vertexRegions&&e.vertexAttributes.region&&delete(e=o.clone(e)).vertexAttributes.region,e}function h(e,t){var r={bufferDefinition:null,bufferIndex:0};if(null==e||t.resources.geometryDefinition<0)return r;var n=t.resources.geometryDefinition>=0?e[t.resources.geometryDefinition].geometryBuffers:null;if(null==n)return r;for(var o=0;o<n.length;o++)if(null==n[o].compressedAttributes)r.bufferIndex=o,r.bufferDefinition=n[o];else if("draco"===n[o].compressedAttributes.encoding&&u.isSupported()&&!i("disable-feature:i3s-draco"))return r.bufferIndex=o,r.bufferDefinition=n[o],r;return r}function f(e){for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];_[i]&&(t[_[i]]={valueType:null})}return{header:null,byteOffset:0,byteCount:0,vertexAttributes:t}}var y=function(){function e(e,t,r,n,i,o){if(this.streamDataController=t,this.logger=r,this.defaultGeometrySchema=n,this.requiredAttributes=i,this.options=o,this.layerUrl=e.parsedUrl.path,this.geometryDefinitions=e.geometryDefinitions,e.materialDefinitions){var a=e.textureSetDefinitions;this.materialAndTextures=e.materialDefinitions.map(function(e){return p.getMaterialAndTextures(a,e)})}}return e.prototype.load=function(e,t,r){return this.streamDataController.request(e,t,{signal:r})},e.prototype.loadAttribute=function(e,t,r){var n=this.layerUrl+"/nodes/"+e.resources.attributes+"/attributes/"+t.key+"/0";return this.load(n,"binary",r).then(function(e){return l.readBinaryAttribute(t,e)})},e.prototype.loadAttributes=function(e,t,r){var n=this;return a.eachAlways(t.map(function(t){return n.loadAttribute(e,t.attributeStorageInfo,r)})).then(function(r){for(var i={},o=0;o<t.length;++o)r[o].value?i[t[o].name]=r[o].value:a.isAbortError(r[o].error)||n.logger.error("Failed to load attributeData for '"+t[o].name+"' on node '"+e.id+"'");return i})},e.prototype.loadNodeData=function(e,t){return n(this,void 0,void 0,function(){var n,i,o,s,u,d,y,_,m,g,b,v,x,A,w,I,D,S,E,P,C;return r(this,function(r){switch(r.label){case 0:return n=null!=this.requiredAttributes&&e.resources.attributes?this.loadAttributes(e,this.requiredAttributes,t):a.resolve({}),i=h(this.geometryDefinitions,e),o=i.bufferDefinition,s=i.bufferIndex,u=e.resources.geometry?this.loadGeometry(e,s,t):null,e.resources.hasSharedResource?[4,this.loadShared(e,t)]:[3,2];case 1:return y=r.sent(),[3,3];case 2:y=null,r.label=3;case 3:return d=y,_=this.materialAndTextures&&e.resources.materialDefinition>=0?this.materialAndTextures[e.resources.materialDefinition]:null!=d?p.getMaterialAndTexturesFromShared(d):null,m=_&&_.material,g=_&&_.textures,this.options.loadFeatureData?[4,this.loadFeatureData(e,t)]:[3,5];case 4:return v=r.sent(),[3,6];case 5:v=null,r.label=6;case 6:return b=v,x=this.options.loadFeatureData?this.collectGeometries(b):this.meshPyramidGeometryData(e,m),A=null!=g&&g.length>0?this.loadTextures(e,g,t):null,w=null,I=null,u?[4,u]:[3,8];case 7:w=r.sent(),D=c(this.defaultGeometrySchema,d),S=!(!o||!o.compressedAttributes||"draco"!==o.compressedAttributes.encoding),I=S?f(o.compressedAttributes.attributes):o?l.createGeometryIndexFromDefinition(o,e.vertexCount,e.numFeatures):l.createGeometryIndexFromSchema(w,D),r.label=8;case 8:return[4,A];case 9:return E=r.sent(),[4,n];case 10:return P=r.sent(),C=P?{attributeData:P,loadedAttributes:this.requiredAttributes}:null,[2,{allGeometryData:x,attributeDataInfo:C,geometryBuffer:w,geometryIndex:I,requiredTextures:g,textureData:E}]}})})},e.addAbsoluteHrefTexture=function(e,t){var r=e.textureDefinitions;if(null!=r)for(var n=0,i=Object.keys(r);n<i.length;n++)for(var o=0,a=r[i[n]].images;o<a.length;o++){var u=a[o];Array.isArray(u.href)?u.hrefConcat=u.href.map(function(e){return s.makeAbsolute(e,t)}):u.hrefConcat=s.makeAbsolute(u.href,t)}},e.fixTextureEncodings=function(e){var t=e.textureDefinitions;if(null!=t)for(var r in t){var n=t[r];if(Array.isArray(n.encoding))for(var i=0;i<n.encoding.length;i++){var o;"data:"===(o=n.encoding[i]).substring(0,5)&&(n.encoding[i]=o.substring(5))}else"data:"===(o=n.encoding).substring(0,5)&&(n.encoding=o.substring(5))}},e.prototype.loadShared=function(t,r){var n=this.layerUrl+"/nodes/"+t.resources.geometry+"/shared";return this.load(n,"json",r).then(function(t){return e.fixTextureEncodings(t),e.addAbsoluteHrefTexture(t,n),t})},e.prototype.loadTexture=function(e,t,r,n,i,o){return i===d.DDS_ENCODING_STRING?this.load(e,"binary",o).then(function(e){return{id:t,usage:r,data:e,encoding:i}}):this.load(e,"image",o).then(function(e){var o=e;if(n&&e.width*e.height>=4096){var a=Math.ceil(e.width/2),s=Math.ceil(e.height/2),u=document.createElement("canvas");u.width=a,u.height=s,u.getContext("2d").drawImage(e,0,0,a,s),o=u}return{id:t,usage:r,data:o,encoding:i}})},e.prototype.loadTextures=function(t,r,n){var i=this,o=this.options.textureFormat===e.TextureFormat.Compressed,s=this.options.textureFormat===e.TextureFormat.Downsampled,u=this.options.textureUsageMask;return a.all(r.map(function(e){if(0==(e.usage&u))return null;var r=d.selectEncoding(e.encodings,o);if(null==r)return i.logger.error("No known encoding for texture found on node "+t.id),a.reject();var l=t.resources.texture||t.id,p=i.layerUrl+"/nodes/"+l+"/textures/"+r.name;return i.loadTexture(p,e.id,e.usage,s,r.encoding,n)}))},e.prototype.meshPyramidGeometryData=function(e,t){return[{featureIds:[],geometries:[{type:"ArrayBufferView",params:{material:t}}],featureDataPosition:[0,0,0]}]},e.prototype.collectGeometries=function(e){for(var t=new Array,r=0,n=e.featureData;r<n.length;r++){var i=n[r],o=i.geometries;if(null!=o)for(var a=0,s=o;a<s.length;a++){var u=s[a];t.push({featureIds:[i.id],featureDataPosition:i.position,geometries:[u]})}else null!=i.position&&t.push({featureIds:[i.id],featureDataPosition:i.position,geometries:null})}return t},e.prototype.loadFeatureData=function(e,t){var r=this.layerUrl+"/nodes/"+e.id+"/features/0";return this.load(r,"json",t)},e.prototype.loadGeometry=function(e,t,r){var n=this.layerUrl+"/nodes/"+e.resources.geometry+"/geometries/"+t;return this.load(n,"binary",r)},e}(),_={position:"position",normal:"normal",uv0:"uv0",uv1:"uv1",color:"color","uv-region":"region"};return function(e){!function(e){e[e.Compressed=0]="Compressed",e[e.Normal=1]="Normal",e[e.Downsampled=2]="Downsampled"}(e.TextureFormat||(e.TextureFormat={}))}(y||(y={})),y}.apply(null,n))||(e.exports=i)},1755:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(13),r(9),r(50)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.getMaterialAndTextures=function(e,t){var r=new Map,a=function(e,t){if(n.isNone(e))return-1;if(r.has(e.id)){var i=r.get(e.id);return i.usage|=t,i.id}var o=r.size;return r.set(e.id,{id:o,usage:t}),o},s=t.pbrMetallicRoughness,u=s&&s.baseColorFactor,l=t.emissiveFactor,p=null==t.normalTexture&&null==t.emissiveTexture&&null==t.occlusionTexture&&(!s||null==s.metallicRoughnessTexture&&1===s.roughnessFactor&&(1===s.metallicFactor||0===s.metallicFactor)),d=p?i.defaultPBRMaterialParameters.metallicFactor:s?s.metallicFactor:1,c=p?i.defaultPBRMaterialParameters.roughnessFactor:s?s.roughnessFactor:1,h={baseColorFactor:u?[u[0],u[1],u[2],u[3]]:[1,1,1,1],baseColorTextureId:a(s&&s.baseColorTexture,1),metallicRoughnessTextureId:a(s&&s.metallicRoughnessTexture,2),metallicFactor:d,roughnessFactor:c},f={alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,cullFace:t.cullFace,normalTextureId:a(t.normalTexture,4),emissiveTextureId:a(t.emissiveTexture,16),occlusionTextureId:a(t.occlusionTexture,8),emissiveFactor:l?[l[0],l[1],l[2]]:[0,0,0],metallicRoughness:h,wrapTextures:!1,isSchematic:p},y=[];return r.forEach(function(t,r){var i=t.usage,a=n.isSome(e)&&e[r]&&e[r].formats,s=a?a.map(function(e){var t=e.name,r=e.format;return{name:t,encoding:o[r]}}):[];y.push({id:r,usage:i,encodings:s})}),{material:f,textures:y}};var o={jpg:"image/jpeg",png:"image/png",dds:"image/vnd-ms.dds","ktx-etc2":"image/ktx"};t.getMaterialAndTexturesFromShared=function(e){var t=e&&e.materialDefinitions?Object.keys(e.materialDefinitions)[0]:null,n=e&&e.textureDefinitions?Object.keys(e.textureDefinitions)[0]:null,i=t&&e.materialDefinitions[t],o=n&&e.textureDefinitions[n],s=a();if(null!=i){var u=i.params;u.diffuse&&(s.metallicRoughness.baseColorFactor=[u.diffuse[0],u.diffuse[1],u.diffuse[2],1]),null!=u.doubleSided&&(s.doubleSided=u.doubleSided,s.cullFace=u.doubleSided?"none":"back"),"none"!==u.cullFace&&"front"!==u.cullFace&&"back"!==u.cullFace||(s.cullFace=u.cullFace),u.transparency&&(s.metallicRoughness.baseColorFactor[3]=r.clamp(1-u.transparency,0,1)),(u.useVertexColorAlpha||s.metallicRoughness.baseColorFactor[3]<1)&&(s.alphaMode="blend")}var l=[];if(null!=o){!o.wrap||"repeat"!==o.wrap[0]&&"repeat"!==o.wrap[1]||(s.wrapTextures=!0),"rgba"===o.channels&&(s.alphaMode="blend");var p=o.images.length-1,d=o.images[p],c=function(e){return e&&e.split("/").pop()},h=Array.isArray(o.encoding)?o.encoding.map(function(e,t){return{name:c(d.href[t]),encoding:e}}):[{name:c(d.href),encoding:o.encoding}];l.push({id:0,usage:1,encodings:h}),s.metallicRoughness.baseColorTextureId=0}return{material:s,textures:l}};var a=function(){return{alphaMode:"opaque",alphaCutoff:.1,doubleSided:!0,cullFace:"none",normalTextureId:-1,emissiveTextureId:-1,occlusionTextureId:-1,emissiveFactor:[0,0,0],metallicRoughness:{baseColorFactor:[.8,.8,.8,1],baseColorTextureId:-1,metallicRoughnessTextureId:-1,metallicFactor:0,roughnessFactor:.6},wrapTextures:!1,isSchematic:!0}}}.apply(null,n))||(e.exports=i)},1756:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(7)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.requester=e,this.activeRequests=new Set}return Object.defineProperty(e.prototype,"busy",{get:function(){return this.requester.busy},enumerable:!0,configurable:!0}),e.prototype.request=function(e,t,i){var o=this,a=n.createAbortController();n.onAbortOrThrow(i,function(){return a.abort()}),i=r({},i,{signal:a.signal});var s=this.requester.request(e,t,i),u={response:s,abortController:a};return this.activeRequests.add(u),n.always(s,function(){return o.activeRequests.delete(u)}),s},e.prototype.cancelAll=function(){this.activeRequests.forEach(function(e){return e.abortController.abort()}),this.activeRequests.clear()},e}();t.I3SStreamDataController=i,t.default=i}.apply(null,n))||(e.exports=i)},1757:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8),r(5),r(60),r(35),r(103),r(424),r(192),r(93),r(1641),r(30),r(1655),r(41)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d,c,h){return function(){function e(e,t,r,i,o,s,u){void 0===u&&(u={}),this.indexSR=e,this._renderCoordsHelper=t,this.extent=i,this.elevationProvider=o,this.options=u,this.fp=d.frustum.create(),this._poi=n.vec3f64.create(),this.minDistance=1/0,this.maxDistance=0,this.maxLodLevel=2,this._tmp1=n.vec3f64.create(),this._tmp2=n.vec3f64.create(),this._tmp3=n.vec3f64.create(),this._tmp0=n.vec3f64.create(),this.screenspaceErrorBias=u.screenspaceErrorBias||1,this.progressiveLoadFactor=u.progressiveLoadFactor||1,this.updateCamera(r),this.engineSR=this._renderCoordsHelper.spatialReference,this.updateElevationInfo(s.elevationInfo),this.tmpPoint=a.makeDehydratedPoint(0,0,0,e)}return e.prototype.updateElevationInfo=function(e){null!=e?(this._elevationContext=new s,this._elevationContext.featureExpressionInfoContext=u.createContext(u.extractExpressionInfo(e,!1)),this._elevationContext.mixinApi(e)):this._elevationContext=null},e.prototype.updateCamera=function(e){d.frustum.fromMatrix(e.viewMatrix,e.projectionMatrix,this.fp),this._screenSizeFactor=1/(e.perScreenPixelRatio/2),this._camPos=e.eye,this.minDistance=1/0,this.maxDistance=0},e.prototype.setPointOfInterest=function(e){r.vec3.copy(this._poi,e)},e.prototype.updateScreenSpaceErrorBias=function(e){var t=this.screenspaceErrorBias;return this.screenspaceErrorBias=e,t},e.prototype.updateExtent=function(e){this.extent=e},e.prototype.getRenderMbs=function(e){var t=e.renderMbs;return t||(t=o.vec4f64.fromValues(e.mbs[0],e.mbs[1],e.mbs[2],-1),e.renderMbs=t),t[3]<0&&(i.vec4.copy(t,e.mbs),this._elevationContext&&t[3]<1e5&&(this.tmpPoint.x=t[0],this.tmpPoint.y=t[1],this.tmpPoint.z=t[2],t[2]=l.computeElevation(this.elevationProvider,this.tmpPoint,this._elevationContext,this._renderCoordsHelper,null)),h.mbsToMbs(t,this.indexSR,t,this.engineSR)),t},e.prototype.getRenderObb=function(e){if(e.obb&&!(e.obb.halfSize[0]<0)&&e.renderObb){var t=e.renderObb;if(t.halfSize[0]<0){var r=0;this._elevationContext&&e.mbs[3]<1e5&&(this.tmpPoint.x=e.obb.center[0],this.tmpPoint.y=e.obb.center[1],this.tmpPoint.z=e.obb.center[2],r=l.computeElevation(this.elevationProvider,this.tmpPoint,this._elevationContext,this._renderCoordsHelper,null)-e.obb.center[2]),p.transformObb(e.obb,this.indexSR,t,this.engineSR,r)}return t}},e.prototype.isNodeVisible=function(e){var t=this.getRenderMbs(e);if(!this.isMBSinExtent(t))return!1;if(e.obb){var r=this.getRenderObb(e);return c.isVisible(r,this.fp)}return this.isMBSVisible(t)},e.prototype.isGeometryVisible=function(e){var t=this.getRenderObb(e);return!t||c.isVisible(t,this.fp)},e.prototype.isMBSinExtent=function(e){return!this.extent||0!==p.intersectBoundingBoxWithMbs(this.extent,e)},e.prototype.isMBSVisible=function(e){return d.frustum.intersectsSphere(this.fp.planes,d.sphere.wrap(e[3],e))},e.prototype.screenSpaceDiameterMbs=function(e,t){var n=this.getRenderMbs(e),i=Math.sqrt(r.vec3.squaredDistance(n,this._camPos)),o=i-n[3];return this._updateMinMaxDistance(i),o<0?.5*Number.MAX_VALUE:t/o*this._screenSizeFactor},e.prototype.calcCameraDistance=function(e){return this.calcCameraDistanceToCenter(e)-this.getRenderMbs(e)[3]},e.prototype.calcCameraDistanceToCenter=function(e){var t=this.getRenderMbs(e),n=r.vec3.distance(t,this._camPos);return this._updateMinMaxDistance(n),n},e.prototype.calcAngleDependentLoD=function(e){var t=this.getRenderMbs(e),n=t[3],i=(Math.abs(t[0]*(t[0]-this._camPos[0])+t[1]*(t[1]-this._camPos[1])+t[2]*(t[2]-this._camPos[2]))/r.vec3.length(t)+n)/r.vec3.distance(t,this._camPos);return Math.min(1,i)},e.prototype.hasLOD=function(e){return 0!==e.lodMetric},e.prototype.getDistancePlanarMode=function(e,t){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=r*r+n*n,a=t[3];if(o<=a*a)return Math.abs(i);var s=Math.sqrt(o)-a;return Math.sqrt(i*i+s*s)},e.prototype.getDistanceGlobeMode=function(e,t){var n=r.vec3.length(t),i=r.vec3.length(e)-n;r.vec3.scale(this._tmp0,e,r.vec3.dot(e,t)/r.vec3.squaredLength(e));var o=r.vec3.squaredDistance(t,this._tmp0),a=t[3];if(o<=a*a)return Math.abs(i);var s=r.vec3.scale(this._tmp0,t,1/n),u=n,l=a*a/2/u,p=r.vec3.scale(this._tmp1,s,u-l),d=e,c=r.vec3.subtract(this._tmp2,d,p),h=r.vec3.subtract(this._tmp2,c,r.vec3.scale(this._tmp3,s,r.vec3.dot(s,c))),f=r.vec3.add(this._tmp2,p,r.vec3.scale(this._tmp2,h,a/r.vec3.length(h))),y=r.vec3.distance(d,f);if(i>=2e5){var _=r.vec3.subtract(this._tmp1,d,f),m=r.vec3.dot(_,s)/r.vec3.length(_);m<.08&&(m=1e-4),y/=m}return y},e.prototype.getDistance=function(e,t){return this.engineSR===h.SphericalECEFSpatialReference?this.getDistanceGlobeMode(e,t):this.getDistancePlanarMode(e,t)},e.prototype._updateMinMaxDistance=function(e){e>0?(this.minDistance=Math.min(this.minDistance,e),this.maxDistance=Math.max(this.maxDistance,e)):(this.minDistance=0,this.maxDistance=Math.max(this.maxDistance,-e))},e.prototype.getLodLevel=function(e){if(0===e.lodMetric||!e.resources.hasFeatureData)return 0;if(0===e.childCount)return this.maxLodLevel;if(this.progressiveLoadFactor<1){var t=this.progressiveLoadFactor*this.screenspaceErrorBias,r=this.screenspaceErrorBias;return this.evaluateLODmetric(e,t)?this.evaluateLODmetric(e,r)?2:1:0}return this.evaluateLODmetric(e,this.screenspaceErrorBias)?this.maxLodLevel:0},e.prototype.evaluateLODmetric=function(e,t){switch(e.lodMetric){case 2:var r=this.getRenderMbs(e),n=this.getDistance(this._camPos,r),i=2*n/this._screenSizeFactor,o=n+r[3];return this._updateMinMaxDistance(o),e.maxError*t<=i;case 1:var a=this.screenSpaceDiameterMbs(e,e.mbs[3]*t);return this.options.angleDependentLoD&&(a*=this.calcAngleDependentLoD(e)),a<e.maxError;case 3:return this.screenSpaceDiameterMbs(e,e.maxError)*t<10;case 4:return this.calcCameraDistance(e)>e.maxError*t}return!1},e.prototype.distToPOI=function(e){var t=this.getRenderMbs(e);return r.vec3.distance(t,this._poi)-t[3]},e.prototype.distCameraToPOI=function(){return r.vec3.distance(this._camPos,this._poi)},e}()}.apply(null,n))||(e.exports=i)},1760:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(0),r(635),r(1641)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var u=i.getLogger("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView");t.DefinitionExpressionSceneLayerView=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._definitionExpressionErrors=0,t._maxDefinitionExpressionErrors=20,t.logError=function(e){t._definitionExpressionErrors<t._maxDefinitionExpressionErrors&&u.error("Error while evaluating definitionExpression: "+e),++t._definitionExpressionErrors===t._maxDefinitionExpressionErrors&&u.error("Further errors are ignored")},t}return r(t,e),Object.defineProperty(t.prototype,"parsedDefinitionExpression",{get:function(){if(!this.layer||!this.layer.definitionExpression)return null;try{var e=a.WhereClause.create(this.layer.definitionExpression,this.layer.fieldsIndex);if(!e.isStandardized)return u.error("definitionExpression is using non standard function"),null;var t=[],r=e.fieldNames;return s.findFieldsCaseInsensitive(r,this.layer.fields,{missingFields:t}),t.length>0?(u.error("definitionExpression references unknown fields: "+t.join(", ")),null):(this._definitionExpressionErrors=0,e)}catch(e){return u.error("Failed to parse definitionExpression: "+e),null}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"definitionExpressionFields",{get:function(){return this.parsedDefinitionExpression?this.parsedDefinitionExpression.fieldNames:null},enumerable:!0,configurable:!0}),t.prototype._evaluateClause=function(e,t){try{return e.testFeature(t)}catch(e){return this.logError(e),!1}},t.prototype._addDefinitionExpressionToQuery=function(e){if(!this.parsedDefinitionExpression)return e;var t=this.layer.definitionExpression,r=e.clone();return r.where?r.where="("+t+") AND ("+r.where+")":r.where=t,r},n([o.property()],t.prototype,"layer",void 0),n([o.property({readOnly:!0,dependsOn:["layer.definitionExpression","layer.fieldsIndex"]})],t.prototype,"parsedDefinitionExpression",null),n([o.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],t.prototype,"definitionExpressionFields",null),n([o.subclass("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView")],t)}(o.declared(e))}}.apply(null,n))||(e.exports=i)},1761:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.defineFieldProperties=function(){return{requiredFields:{type:[String],readOnly:!0},availableFields:{type:[String],readOnly:!0,dependsOn:["layer.fields","layer.outFields","requiredFields"],get:function(){var e=this,t=e.layer,n=e.layer.fields,i=e.requiredFields;return t.outFields?r.fixFields(n,r.unpackFieldNames(n,t.outFields).concat(i)):r.fixFields(n,i)}}}}}.apply(null,n))||(e.exports=i)},1762:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(10),r(11),r(14),r(79),r(9),r(7),r(0),r(117),r(1657)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,p,d,c){Object.defineProperty(t,"__esModule",{value:!0}),t.PopupSceneLayerView=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._validateFetchPopupFeatures=function(e){var t=this.layer;return t.popupEnabled?c.getFetchPopupTemplate(t,e)?void 0:new a("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:t}):new a("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:t})},t.prototype.prepareFetchPopupFeatures=function(e){return o(this,void 0,void 0,function(){return i(this,function(e){return[2]})})},t.prototype.fetchPopupFeatures=function(e,t){return o(this,void 0,void 0,function(){var e,r,n,o,a,p,h,f,y,_,m;return i(this,function(i){switch(i.label){case 0:return(e=this._validateFetchPopupFeatures(t))?[2,l.reject(e)]:(r=u.isSome(t)?t.clientGraphics:null)&&0!==r.length?(n=[],o=[],p=d.unpackFieldNames,h=[this.layer.fields],[4,c.getRequiredFields(this.layer,c.getFetchPopupTemplate(this.layer,t))]):[2,l.resolve([])];case 1:return a=p.apply(void 0,h.concat([i.sent()])),[4,this.prepareFetchPopupFeatures(a)];case 2:for(i.sent(),f=new Set,y=0,_=r;y<_.length;y++)m=_[y],d.populateMissingFields(a,m,f)?o.push(m):n.push(m);return 0===o.length?[2,l.resolve(n)]:[2,this.whenGraphicAttributes(o,s.valuesOfSet(f)).catch(function(){return o}).then(function(e){return n.concat(e)})]}})})},n([p.subclass("esri.views.3d.layers.support.PopupSceneLayerView")],t)}(p.declared(e))}}.apply(null,n))||(e.exports=i)},1830:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9),r(71)],void 0===(i=function(e,t,r,n){return function(){function e(e){this.sourceSpatialReference=e.sourceSpatialReference,this.destSpatialReference=e.destSpatialReference}return e.prototype.adjust=function(e){var t=this._getVerticalUnitScale();1!==t&&this._scaleVerticalUnits(e,t)},e.prototype._getVerticalUnitScale=function(){return this.sourceSpatialReference&&!this.sourceSpatialReference.equals(this.destSpatialReference)?n.getMetersPerVerticalUnitForSR(this.sourceSpatialReference)/n.getMetersPerVerticalUnitForSR(this.destSpatialReference):1},e.prototype._vertexListsScaleZ=function(e,t){for(var r=0;r<e.length;++r)for(var n=e[r],i=0;i<n.length;++i){n[i][2]*=t}},e.prototype._scaleVerticalUnits=function(e,t){for(var n=0;n<e.length;++n){var i=e[n].geometry;!r.isNone(i)&&i.hasZ&&(this._geometryIsPoint(i)?null!==i.z&&(i.z*=t):this._geometryIsPolyline(i)?this._vertexListsScaleZ(i.paths,t):this._geometryIsPolygon(i)&&this._vertexListsScaleZ(i.rings,t))}},e.prototype._geometryIsPoint=function(e){return"point"===e.type},e.prototype._geometryIsPolygon=function(e){return"polygon"===e.type},e.prototype._geometryIsPolyline=function(e){return"polyline"===e.type},e}()}.apply(null,n))||(e.exports=i)},2556:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(10),r(11),r(4),r(97),r(43),r(58),r(79),r(6),r(9),r(7),r(25),r(0),r(5),r(45),r(33),r(170),r(103),r(1750),r(117),r(425),r(402),r(1640),r(1743),r(1830),r(1688),r(1641),r(1760),r(1761),r(1645),r(1762),r(76),r(2557),r(1655),r(41),r(1633),r(643),r(199),r(105)],void 0===(i=function(e,t,n,i,o,a,s,u,l,p,d,c,h,f,y,_,m,g,b,v,x,A,w,I,D,S,E,P,C,O,N,F,T,M,R,V,G,j,L,U,q){function B(e,t){for(var r=0;r<e.length;r++)for(var n=0,i=e[r].graphics;n<i.length;n++){var o=i[n];if(o.attributes||(o.attributes={}),t&&t.loadedAttributes)for(var a=0,s=t.loadedAttributes;a<s.length;a++){var u=s[a].name;t.attributeData[u]&&(o.attributes[u]=O.getCachedAttributeValue(t.attributeData[u],r))}}}var k=c.getLogger("esri.views.3d.layers.SceneLayerGraphicsView3D"),Q=F.defineFieldProperties(),z=function(e){function t(t){var r=e.call(this)||this;return r._nodesAddedToStage=new Map,r.overlayUpdating=!1,r.supportsDraping=!0,r._queryEngine=null,r._memCache=null,r.loadedGraphics=new V.GraphicsMap,r.progressiveLoadFactor=1,r.supportsHeightUnitConversion=!0,r._coordinatesOutsideExtentErrors=0,r._maxCoordinatesOutsideExtentErrors=20,r}return n(t,e),t.prototype.initialize=function(){var e=this;O.checkSpatialReferences(this.layer,this.view.spatialReference,this.view.viewingMode);for(var t=0,n=["layer.renderer","layer.labelingInfo","layer.labelsVisible","definitionExpressionFields","filter"];t<n.length;t++){var i=n[t];this.updatingHandles.add(this,i,function(){return e._updateRequiredFields()})}this.updatingHandles.add(this.layer,"rangeInfos",function(t){return e._rangeInfosChanged(t)},2),this.updatingHandles.add(this.layer,"renderer",function(t,r){return e._rendererChange(t,r)}),this.updatingHandles.add(this,"layer.objectIdFilter",function(){return e._filterChange()}),this.updatingHandles.add(this,"parsedDefinitionExpression",function(){return e._filterChange()}),this.handles.add(y.init(R,"I3S_TREE_SHOW_TILES",function(t){if(t&&!e._treeDebugger){var n=e._controller.crsIndex;new Promise(function(e,t){r.e(34).then(function(){var t=[r(1847)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}).then(function(t){var r=t.I3STreeDebugger;!e._treeDebugger&&R.I3S_TREE_SHOW_TILES&&(e._treeDebugger=new r({lv:e,view:e.view,nodeSR:n}))})}else t||!e._treeDebugger||R.I3S_TREE_SHOW_TILES||(e._treeDebugger.destroy(),e._treeDebugger=null)})),this._updateRequiredFields(),this._set("graphics3d",new E({owner:this,layer:this.layer,preferredUpdatePolicy:1,scaleVisibilityEnabled:!0,filterVisibilityEnabled:!0,timeExtentVisibilityEnabled:!1,frustumVisibilityEnabled:!1,elevationAlignmentEnabled:!0,elevationFeatureExpressionEnabled:!1,suspendResumeExtentMode:"data",dataExtent:this.layer.fullExtent,updateClippingExtent:function(t){return e._updateClippingExtent(t)}})),this.graphics3d.elevationAlignment&&this.graphics3d.elevationAlignment.events.on("invalidate-elevation",function(t){return e._invalidateElevation(t.extent,t.spatialReference)}),this.supportsHeightUnitConversion&&(this._verticalScale=new P({sourceSpatialReference:this.layer.spatialReference,destSpatialReference:this.view.spatialReference})),this.addResolvingPromise(this.graphics3d.setup()),this.drawingOrder=this.view.getDrawingOrder(this.layer.uid),this._memCache=this.view.resourceController.memoryController.getMemCache(this.layer.uid),this._controller=new A({layerView:this,scaleVisibilityEnabled:!1}),this.when(function(){e._queryEngine=new C.default({layerView:e,task:q.Task.FEATURE_QUERY_ENGINE}),e.updatingHandles.add(e,"maximumNumberOfFeatures",function(t){return e._controller.featureTarget=t},2),e.updatingHandles.add(e,"suspended",function(t){t&&e._removeAllNodeData()})})},t.prototype.destroy=function(){this._treeDebugger&&(this._treeDebugger.destroy(),this._treeDebugger=null),this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null)),this._controller&&(this._controller.destroy(),this._controller=null),this._queryEngine&&(this._queryEngine.destroy(),this._queryEngine=null),this._memCache.destroy(),this._memCache=null,this._nodesAddedToStage=null},Object.defineProperty(t.prototype,"maximumNumberOfFeatures",{get:function(){var e=this.graphics3d&&this.graphics3d.graphicsCore&&this.graphics3d.graphicsCore.displayFeatureLimit;return e?e.maximumNumberOfFeatures:0},set:function(e){null!=e?(this._override("maximumNumberOfFeatures",e),this._controller.fixedFeatureTarget=!0):(this._clearOverride("maximumNumberOfFeatures"),this._controller.fixedFeatureTarget=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximumNumberOfFeaturesExceeded",{get:function(){return!this.suspended&&!!this._controller&&!this._controller.leafsReached},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasM",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasZ",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.whenGraphicAttributes=function(e,t){return a(this,void 0,void 0,function(){var r,n=this;return o(this,function(i){return r=function(e){for(var t=new Map,r=[],i=0,o=e;i<o.length;i++){var a=o[i],s=n._findGraphicNodeAndIndex(a),u=t.get(s.node);u||(u={node:s.node,indices:[],graphics:[]},r.push(u)),u.indices.push(s.index),u.graphics.push(a)}return r},[2,O.whenGraphicAttributes(this.layer,e,this._getObjectIdField(),t,r,{ignoreUnavailableFields:!0,populateObjectId:!0})]})})},t.prototype.getGraphicFromGraphicUid=function(e){if(!this.loadedGraphics)return null;var t=x.hydrateGraphic(this.loadedGraphics.find(function(t){return t.uid===e}),this.layer),r=this._getObjectIdField();return t&&t.attributes&&t.attributes[r]?(t.layer=this.layer,t.sourceLayer=this.layer,t):null},t.prototype.whenGraphicBounds=function(e,t){return this.graphics3d.graphicsCore.whenGraphicBounds(e,t)},t.prototype.canResume=function(){return this.inherited(arguments)&&(!this._controller||this._controller.rootNodeVisible)},t.prototype.isUpdating=function(){return this.overlayUpdating||this._controller&&this._controller.updating||this.graphics3d&&this.graphics3d.updating},t.prototype.getRenderingInfo=function(e,t){var r=I.getRenderingInfo(e,{renderer:t});if(r&&r.color){var n=r.color;n[0]=n[0]/255,n[1]=n[1]/255,n[2]=n[2]/255}return r},t.prototype.getRenderingInfoAsync=function(e,t,r){return a(this,void 0,void 0,function(){return o(this,function(n){return[2,I.getRenderingInfoAsync(e,s({renderer:t},r))]})})},Object.defineProperty(t.prototype,"symbolUpdateType",{get:function(){return this.graphics3d.graphicsCore.symbolUpdateType},enumerable:!0,configurable:!0}),t.prototype._findGraphicNodeAndIndex=function(e){for(var t=e.attributes[this.layer.objectIdField],r=0,n=l.keysOfMap(this._nodesAddedToStage);r<n.length;r++){var i=n[r],o=this._nodesAddedToStage.get(i),a=this._findGraphicIndex(o.bundle,t);if(a>=0)return{node:o.node,index:a}}return null},t.prototype._findGraphicIndex=function(e,t){for(var r=0;r<e.length;r++)for(var n=0,i=e[r].featureIds;n<i.length;n++){if(i[n]===t)return r}return-1},t.prototype.highlight=function(e,t){return void 0===t&&(t={}),this.graphics3d.highlight(e,t,this.layer.objectIdField)},t.prototype.addNodeData=function(e,t){if(!this._nodesAddedToStage.has(e.index)){for(var r=t.allGeometryData,n=t.attributeDataInfo,i=this._controller.crsIndex,o=this.view.spatialReference,a=[0,0,0],s=this._getObjectIdField(),l=[],p=this.layer.fullExtent&&function(e,t){return e.xmin-=t,e.ymin-=t,e.xmax+=t,e.ymax+=t,e.hasZ&&(e.zmin-=t,e.zmax+=t),e.hasM&&(e.mmin-=t,e.mmax+=t),e}(this.layer.fullExtent.clone(),.5),d=[],c=[],y=0;y<r.length;y++){var _=r[y],m=_.featureDataPosition,g=m.length,b=_.geometries||[H[g]],A=_.featureIds;p&&!v.extentContainsCoords3D(p,m)&&(this._coordinatesOutsideExtentErrors<this._maxCoordinatesOutsideExtentErrors&&k.error("Service Error: Coordinates outside of layer extent"),this._coordinatesOutsideExtentErrors+1===this._maxCoordinatesOutsideExtentErrors&&k.error("Maximum number of errors reached. Further errors are ignored."),this._coordinatesOutsideExtentErrors++);for(var w=0;w<b.length;w++){var I=b[w];if("points"===I.params.type){var D=[],S=A[w<A.length?w:0],E={};null!=S&&(E[s]=S);var P=null==S?u.generateUID():S,C=void 0;"Embedded"===I.type&&(C=I.params.vertexAttributes.position);for(var O=0;O<C.length;O+=g){for(var N=0;N<g;N++)a[N]=m[N]+C[O+N];j.bufferToBuffer(a,i,0,W,o,0,1);var F=x.makeDehydratedPoint(W[0],W[1],W[2],o);g<3&&(F.z=void 0);var T=P,M=this.loadedGraphics.get(T);h.isSome(M)?D.push(M):D.push({uid:T,geometry:F,attributes:E,visible:!0}),e.obb||c.push(F.x,F.y,F.z?F.z:0)}d.push.apply(d,D),l.push({featureIds:_.featureIds,graphics:D})}}}e.numFeatures=d.length,this._updateNodeMemory(e);var R={bundle:l,attributeInfo:n,node:e};if(B(R.bundle,R.attributeInfo),c.length>0){var V=this.view.renderSpatialReference,L=this._controller.crsVertex;j.bufferToBuffer(c,o,0,c,V,0,c.length/3);var U={data:c,size:3,offsetIdx:0,strideIdx:3};e.obb=G.compute(U),j.vectorToVector(e.obb.center,V,e.obb.center,L),this._controller.updateVisibility(e.index)}return this._controller.isGeometryVisible(e)?(this._verticalScale&&this._verticalScale.adjust(d),this._nodesAddedToStage.set(e.index,R),this.loadedGraphics.addManyAndDeduplicate(d),this._filterNode(R),this._treeDebugger&&this._treeDebugger.update(),f.resolve()):(this._cacheNodeData(R),f.resolve())}k.error("I3S node "+e.id+" already added")},t.prototype.isNodeLoaded=function(e){return this._nodesAddedToStage.has(e)},t.prototype._updateNodeMemory=function(e){e.memory=4096+e.numFeatures*this.graphics3d.graphicsCore.usedMemoryPerGraphic},t.prototype._cacheNodeData=function(e){var t=e.bundle.reduce(function(e,t){return t.graphics.reduce(function(e,t){return x.estimateSize(t)+e},512+8*t.featureIds.length+e)},1024);this._memCache.put(this._getMemCacheKey(e.node),e,t)},t.prototype._getMemCacheKey=function(e){return""+e.index},t.prototype._removeAllNodeData=function(){var e=this;this._nodesAddedToStage.forEach(function(t){if(t){var r=t.node;e._updateNodeMemory(r),e._cacheNodeData(t)}}),this._nodesAddedToStage.clear(),this._treeDebugger&&this._treeDebugger.update(),this.loadedGraphics.clear()},t.prototype.removeNodeData=function(e,t){for(;e.length>0&&!t.done;){var r=e.pop(),n=this._removeNodeStageData(r);n&&(this._updateNodeMemory(n.node),this._cacheNodeData(n)),t.madeProgress()}},t.prototype._removeNodeStageData=function(e){var t=this._nodesAddedToStage.get(e);if(!t)return null;for(var r=0,n=t.bundle;r<n.length;r++){var i=n[r];this.loadedGraphics.removeMany(i.graphics)}return this._nodesAddedToStage.delete(e),this._treeDebugger&&this._treeDebugger.update(),t},t.prototype.loadCachedNodeData=function(e){return f.resolve(this._memCache.pop(this._getMemCacheKey(e)))},t.prototype.addCachedNodeData=function(e,t,r){if(!this._nodesAddedToStage.has(e.index)){for(var n=0,i=t.bundle;n<i.length;n++){var o=i[n];this.loadedGraphics.addManyAndDeduplicate(o.graphics)}return this._nodesAddedToStage.set(e.index,t),this._updateNodeMemory(e),this.setAttributeData(e.index,r),this._filterNode(t),this._treeDebugger&&this._treeDebugger.update(),f.resolve()}k.error("I3S node "+e.id+" already added")},t.prototype.getLoadedNodeIds=function(){var e=[];return this._nodesAddedToStage.forEach(function(t){return e.push(t.node.id)}),e.sort()},t.prototype.getLoadedNodes=function(){var e=new Array;return this._nodesAddedToStage.forEach(function(t){return e.push(t.node)}),e},t.prototype.getLoadedNodeIndices=function(e){this._nodesAddedToStage.forEach(function(t,r){return e.push(r)})},t.prototype.getLoadedAttributes=function(e){var t=this._nodesAddedToStage.get(e);if(t&&t.attributeInfo)return t.attributeInfo.loadedAttributes},t.prototype.getAttributeData=function(e){var t=this._nodesAddedToStage.get(e);if(t&&t.attributeInfo)return t.attributeInfo.attributeData},t.prototype.setAttributeData=function(e,t){var r=this._nodesAddedToStage.get(e);if(r&&(r.attributeInfo=t,B(r.bundle,t),this._filterNode(r),this.graphics3d.graphicsCore.labelsEnabled)){var n=r.bundle.map(function(e){return e.graphics.length&&e.graphics[0].uid});this.graphics3d.graphicsCore.updateLabelingInfo(n)}},t.prototype._updateClippingExtent=function(e){return this._controller&&this._controller.updateClippingArea(e),!1},t.prototype._getObjectIdField=function(){return this.layer.objectIdField||"OBJECTID"},t.prototype._rendererChange=function(e,t){return a(this,void 0,void 0,function(){var r,n,i,a;return o(this,function(o){switch(o.label){case 0:return r=this.layer.fields,n=new Set,e?[4,e.collectRequiredFields(n,r)]:[3,2];case 1:return o.sent(),i=d.valuesOfSet(n).sort(),[3,3];case 2:i=[],o.label=3;case 3:return n.clear(),t?[4,t.collectRequiredFields(n,r)]:[3,5];case 4:return o.sent(),a=d.valuesOfSet(n).sort(),[3,6];case 5:a=[],o.label=6;case 6:return i.length===a.length&&i.every(function(e,t){return i[t]===a[t]})?[2]:(this._reloadAllNodes(),[2])}})})},t.prototype._rangeInfosChanged=function(e){null!=e&&e.length>0&&k.warn("Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.")},t.prototype._filterChange=function(){var e=this;this._nodesAddedToStage.forEach(function(t){return e._filterNode(t)})},t.prototype._reloadAllNodes=function(){this._removeAllNodeData(),this._controller&&this._controller.restartNodeLoading()},t.prototype._filterNode=function(e){var t=this._getObjectIdField(),r=null;if(this.layer.objectIdFilter){var n=this.layer.objectIdFilter.ids,i="include"===this.layer.objectIdFilter.method;r=function(e){return n.indexOf(e)>=0===i}}for(var o=this.parsedDefinitionExpression,a=0,s=e.bundle;a<s.length;a++)for(var u=0,l=s[a].graphics;u<l.length;u++){var p=l[u],d=p.visible;r&&!r(p.attributes[t])?p.visible=!1:p.visible=!o||this._evaluateClause(o,p),d!==p.visible&&(J.graphic=p,J.property="visible",J.oldValue=d,J.newValue=p.visible,this.graphics3d.graphicsCore.graphicUpdateHandler(J))}},t.prototype._updateRequiredFields=function(){return a(this,void 0,void 0,function(){var e,t,r,n,i,a,s,u,l;return o(this,function(o){switch(o.label){case 0:return t=(e=this).layer,r=e.layer,n=r.fields,i=r.renderer,a=r.labelsVisible,s=e.filter,u=e.definitionExpressionFields,l=new Set,i?[4,i.collectRequiredFields(l,n)]:[3,2];case 1:o.sent(),o.label=2;case 2:return a?[4,w.collectLabelingFields(l,t)]:[3,4];case 3:o.sent(),o.label=4;case 4:return h.isSome(s)?[4,w.collectFilterFields(l,t,s)]:[3,6];case 5:o.sent(),o.label=6;case 6:return w.collectFields(l,n,u),this._set("requiredFields",d.valuesOfSet(l).sort()),[2]}})})},t.prototype._invalidateElevation=function(e,t){var r=this._controller.crsIndex;j.boundingRectToBoundingRect(e,t,Z,r);var n=Y;g.fromRect(n,Z),n[2]=-1/0,n[5]=1/0,this._controller.updateElevationChanged(n,r)},t.prototype.createQuery=function(){var e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference};return h.isSome(this.filter)?this.filter.createQuery(e):new D(e)},t.prototype.queryFeatures=function(e,t){return p.safeCast(this._queryEngine.executeQuery(this._ensureQuery(e),t&&t.signal))},t.prototype.queryObjectIds=function(e,t){return p.safeCast(this._queryEngine.executeQueryForIds(this._ensureQuery(e),t&&t.signal))},t.prototype.queryFeatureCount=function(e,t){return p.safeCast(this._queryEngine.executeQueryForCount(this._ensureQuery(e),t&&t.signal))},t.prototype.queryExtent=function(e,t){return p.safeCast(this._queryEngine.executeQueryForExtent(this._ensureQuery(e),t&&t.signal))},t.prototype._ensureQuery=function(e){return this._addDefinitionExpressionToQuery(h.isNone(e)?this.createQuery():D.from(e))},t.prototype.getUsedMemory=function(){var e=this.graphics3d&&this.graphics3d.graphicsCore;return e?e.usedMemory:0},t.prototype.getUnloadedMemory=function(){var e=this.graphics3d&&this.graphics3d.graphicsCore;return.8*((this._controller?this._controller.unloadedMemoryEstimate:0)+(e?e.unprocessedMemoryEstimate:0))},t.prototype.ignoresMemoryFactor=function(){return this._controller&&this._controller.fixedFeatureTarget},t.prototype.getNumberOfNodes=function(){return this._nodesAddedToStage.size},t.prototype.getNumberOfFeatures=function(){return this.loadedGraphics.length},t.prototype.getStats=function(){var e=this.graphics3d.graphicsCore.getStats();return e.nodes=this.getNumberOfNodes(),e.features=this.loadedGraphics.length,this._controller&&this._controller.updateStats(e),e},i([_.property()],t.prototype,"graphics3d",void 0),i([_.property()],t.prototype,"drawingOrder",void 0),i([_.property({aliasOf:"graphics3d.graphicsCore.hasDraped"})],t.prototype,"hasDraped",void 0),i([_.property({type:Boolean})],t.prototype,"overlayUpdating",void 0),i([_.property({type:Boolean})],t.prototype,"supportsDraping",void 0),i([_.property({type:U})],t.prototype,"filter",void 0),i([_.property()],t.prototype,"loadedGraphics",void 0),i([_.property()],t.prototype,"layer",void 0),i([_.property()],t.prototype,"_controller",void 0),i([_.property({dependsOn:["_controller.updating","graphics3d.updating","overlayUpdating"]})],t.prototype,"updating",void 0),i([_.property({dependsOn:["_controller.rootNodeVisible"]})],t.prototype,"suspended",void 0),i([_.property(T.updatingPercentage)],t.prototype,"updatingPercentage",void 0),i([_.property({aliasOf:"_controller.updatingPercentage"})],t.prototype,"updatingPercentageValue",void 0),i([_.property(Q.requiredFields)],t.prototype,"requiredFields",void 0),i([_.property(Q.availableFields)],t.prototype,"availableFields",void 0),i([_.property({type:Number,dependsOn:["graphics3d.graphicsCore.displayFeatureLimit"]})],t.prototype,"maximumNumberOfFeatures",null),i([_.property({readOnly:!0,dependsOn:["suspended","_controller.leafsReached"]})],t.prototype,"maximumNumberOfFeaturesExceeded",null),i([_.property({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.point.lodFactor"})],t.prototype,"lodFactor",void 0),i([_.property({readOnly:!0})],t.prototype,"hasM",null),i([_.property({readOnly:!0})],t.prototype,"hasZ",null),i([_.subclass("esri.views.3d.layers.SceneLayerGraphicsView3D")],t)}(_.declared(N.DefinitionExpressionSceneLayerView(M.PopupSceneLayerView(S.LayerView3D(L))))),H={2:{type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0]}}},3:{type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0,0]}}}},W=m.vec3f64.create(),J={graphic:null,property:null,oldValue:null,newValue:null},Y=g.create(),Z=b.create();return z}.apply(null,n))||(e.exports=i)},2557:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(3),r(49),r(79)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._map=new Map,t}return r(t,e),t.prototype.clear=function(){if(this._map.size>0){var e=this.toArray();this._map.clear(),this.emit("change",{added:[],removed:e})}},Object.defineProperty(t.prototype,"length",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.get=function(e){return this._map.get(e)},t.prototype.addManyAndDeduplicate=function(e){if(0!==e.length){for(var t=new Set,r=0;r<e.length;r++){var n=e[r],i=n.uid,o=this._map.get(i);o?(t.add(i),n!==o&&(e[r]=o),++o.refCount):(n.refCount=1,this._map.set(i,n))}var a=t.size>0?e.filter(function(e){return!t.has(e.uid)}):e;this.emit("change",{added:a,removed:[]})}},t.prototype.removeMany=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],o=i.uid,a=this._map.get(o);null!=a&&--a.refCount<=0&&this._map.delete(o)&&t.push(i)}t.length>0&&this.emit("change",{added:[],removed:t})},t.prototype.toArray=function(){return i.valuesOfMap(this._map)},t.prototype.find=function(e){var t;return i.everyMap(this._map,function(r){return!e(r)||(t=r,!1)}),t},t.prototype.forEach=function(e){this._map.forEach(function(t){return e(t)})},t}(n);t.GraphicsMap=o}.apply(null,n))||(e.exports=i)}}]);