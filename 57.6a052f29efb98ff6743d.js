(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/layers/LayerView":1633,"esri/views/3d/layers/LayerView3D":1640,"esri/views/3d/layers/support/projectExtentUtils":1664,"esri/layers/graphics/data/QueryEngineCapabilities":1680,"esri/views/3d/layers/support/attributeUtils":1681,"esri/views/3d/layers/graphics/QueryEngine":1688,"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":1692,"esri/views/3d/layers/graphics/Graphics3DFeatureLikeLayerView":1743,"esri/views/3d/layers/graphics/Graphics3DFilterVisibility":1744,"esri/views/3d/layers/FeatureLikeLayerView3D":1829,"esri/views/3d/layers/StreamLayerView3D":2561,"esri/views/layers/StreamLayerView":2562})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1633:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(16),i(49),i(282),i(284),i(6),i(225),i(7),i(0)],void 0===(n=function(e,t,i,r,n,s,o,a,u,l,p,c){return function(e){function t(t){var i=e.call(this)||this;return i.layer=null,i.parent=null,i}return i(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",r=e.layer&&e.layer.title||"no title";return u.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",t),p.reject(t)}})},t.prototype.destroy=function(){this.layer=this.parent=null},Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},r([c.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),r([c.property()],t.prototype,"layer",void 0),r([c.property()],t.prototype,"parent",void 0),r([c.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),r([c.property({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],t.prototype,"updating",null),r([c.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),r([c.subclass("esri.views.layers.LayerView")],t)}(c.declared(o.HandleOwnerMixin(a.IdentifiableMixin(l.EsriPromiseMixin(s.EventedMixin(n))))))}.apply(null,r))||(e.exports=n)},1640:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(7),i(25),i(0),i(408)],void 0===(n=function(e,t,i,r,n,s,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.LayerView3D=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slicePlaneEnabled=!1,t.supportsHeightUnitConversion=!1,t}return i(t,e),t.prototype.destroy=function(){this.view=null},t.prototype.postscript=function(e){this.inherited(arguments),a.mayHaveHeightModelInfo(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())},t.prototype._validateHeightModelInfo=function(){var e=this;return n.create(function(t,i){s.whenFalseOnce(e.view.defaultsFromMap,"isHeightModelInfoSearching",function(){var r=a.rejectLayerError(e.layer,e.view.heightModelInfo,e.supportsHeightUnitConversion);r?i(r):t()})})},r([o.property()],t.prototype,"view",void 0),r([o.property()],t.prototype,"slicePlaneEnabled",void 0),r([o.subclass("esri.views.3d.layers.LayerView3D")],t)}(o.declared(e))}}.apply(null,r))||(e.exports=n)},1664:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(58),i(7),i(63),i(412)],void 0===(n=function(e,t,i,r,n,s){Object.defineProperty(t,"__esModule",{value:!0}),t.toViewIfLocal=function(e){var t=e.view.spatialReference,o=e.layer.fullExtent,a=o&&o.spatialReference;return a?a.equals(t)?r.resolve(o.clone()):n.canProject(a,t)?r.resolve(n.project(o,t)):e.view.state.isLocal?i.safeCast(s.projectGeometry(o,t,e.layer.portalItem).then(function(t){return!e.destroyed&&t?t:void 0}).catch(function(){return null})):r.resolve(null):r.resolve(null)}}.apply(null,r))||(e.exports=n)},1680:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,r))||(e.exports=n)},1681:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.attributeLookup=function(e,t){for(var i=t.toLowerCase(),r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];if(s.toLowerCase()===i)return e[s]}return null}}.apply(null,r))||(e.exports=n)},1688:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1),i(2),i(10),i(11),i(36),i(16),i(9),i(0),i(37),i(1679),i(1575),i(402)],void 0===(n=function(e,t,i,r,n,s,o,a,u,l,p,c,d,h){Object.defineProperty(t,"__esModule",{value:!0});var y=c.default,f=function(e){function t(t){var i=e.call(this)||this;return i._dataQueryEngineInstance=null,i}return r(t,e),Object.defineProperty(t.prototype,"queryGeometryType",{get:function(){switch(this.layer.geometryType){case"multipoint":case"point":case"polygon":case"polyline":return this.layer.geometryType;case"mesh":return"polygon";default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultQueryJSON",{get:function(){return new h({outSpatialReference:this.spatialReference}).toJSON()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataQueryEngine",{get:function(){return this.ensureDataQueryEngine()},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.clear()},t.prototype.clear=function(){return!!this._dataQueryEngineInstance&&(this._dataQueryEngineInstance.destroy(),this._dataQueryEngineInstance=null,!0)},t.prototype.executeQueryForIdSet=function(e,t){return s(this,void 0,void 0,function(){return n(this,function(i){return[2,this.dataQueryEngine.executeQueryForIdSet(this._ensureQueryJSON(e),t)]})})},t.prototype.executeQueryForCount=function(e,t){return s(this,void 0,void 0,function(){return n(this,function(i){return[2,this.dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(e),t)]})})},t.prototype.executeQueryForExtent=function(e,t){return s(this,void 0,void 0,function(){var i,r,s,o;return n(this,function(n){switch(n.label){case 0:return[4,this.dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(e),t)];case 1:return i=n.sent(),r=i.count,s=i.extent,o=p.fromJSON(s),[2,{count:r,extent:o}]}})})},t.prototype.executeQueryForIds=function(e,t){return s(this,void 0,void 0,function(){return n(this,function(i){return[2,this.dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(e),t)]})})},t.prototype.executeQuery=function(e,t){return s(this,void 0,void 0,function(){var i,r,s=this;return n(this,function(n){switch(n.label){case 0:return[4,this.dataQueryEngine.executeQuery(this._ensureQueryJSON(e),t)];case 1:return i=n.sent(),(r=d.fromJSON(i)).features.forEach(function(e){e.layer=s.layer,e.sourceLayer=s.layer}),[2,r]}})})},t.prototype._ensureQueryJSON=function(e){return u.isNone(e)?this.defaultQueryJSON:("outSpatialReference"in e&&!e.outSpatialReference&&(e.outSpatialReference=this.spatialReference),e.toJSON())},t.prototype.ensureDataQueryEngine=function(){if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;var e="timeInfo"in this.layer&&this.layer.timeInfo&&this.layer.timeInfo.toJSON()||null,t=this.layer.objectIdField,i=o.featureGeometryTypeKebabDictionary.toJSON(this.queryGeometryType),r=this.layer.fields.map(function(e){return e.toJSON()}),n=this.layerView.view.resourceController.scheduler,s=this.task,a=this.spatialReference.toJSON(),u=this.layerView.graphics3d.graphicsCore.featureStore,l=this.layerView,p=l.hasZ,c=l.hasM;return this._dataQueryEngineInstance=new y({hasZ:p,hasM:c,geometryType:i,fields:r,timeInfo:e,spatialReference:a,objectIdField:t,featureStore:u,scheduler:n,task:s}),this._dataQueryEngineInstance},i([l.property({constructOnly:!0})],t.prototype,"layerView",void 0),i([l.property({constructOnly:!0})],t.prototype,"task",void 0),i([l.property({readOnly:!0,aliasOf:"layerView.view.spatialReference"})],t.prototype,"spatialReference",void 0),i([l.property({readOnly:!0,aliasOf:"layerView.layer"})],t.prototype,"layer",void 0),i([l.property({readOnly:!0,dependsOn:["layer.geometryType"]})],t.prototype,"queryGeometryType",null),i([l.property({readOnly:!0,dependsOn:["spatialReference"]})],t.prototype,"defaultQueryJSON",null),i([l.subclass("esri.views.3d.layers.graphics.QueryEngine")],t)}(l.declared(a));t.QueryEngine=f,t.default=f}.apply(null,r))||(e.exports=n)},1692:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(16),i(22),i(25),i(0),i(56),i(656),i(145)],void 0===(n=function(e,t,i,r,n,s,o,a,u,l,p){var c=-.3*u.earthRadius;return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suspended=!1,t.extent=null,t.extentIntersectionDirty=!0,t._isVisibleBelowSurface=!1,t.handles=new s,t.layerView=null,t.updating=!0,t}return i(t,e),t.prototype.setup=function(e){var t=this;this.layerView=e,this.extentIntersection=new l.FrustumExtentIntersection({renderCoordsHelper:e.view.renderCoordsHelper});var i=e.view,r=i.basemapTerrain,n=i.resourceController.scheduler;this.handles.add([i.on("resize",function(){return t.viewChange()}),i.state.watch("camera",function(){return t.viewChange()},!0),n.registerTask(p.Task.FRUSTUM_VISIBILITY,function(){return t.update()},function(){return t.updating}),r.on("elevation-bounds-change",function(){return t.elevationBoundsChange()})]),"local"===i.viewingMode?this.isVisibleBelowSurface=!0:this.handles.add([o.init(r,["opacity","wireframe"],function(){return t.updateIsVisibleBelowSurface()}),o.init(i,"map.ground.navigationConstraint.type",function(){return t.updateIsVisibleBelowSurface()})])},t.prototype.destroy=function(){this.layerView=null,this.extent=null,this.extentIntersection=null,this.handles&&(this.handles.destroy(),this.handles=null)},t.prototype._setDirty=function(){this.updating||this._set("updating",!0)},t.prototype.setExtent=function(e){this.extent=e,this.extentIntersectionDirty=!0,this._setDirty()},t.prototype.viewChange=function(){this._setDirty()},t.prototype.elevationBoundsChange=function(){this._setDirty(),this.extentIntersectionDirty=!0},Object.defineProperty(t.prototype,"isVisibleBelowSurface",{set:function(e){this._isVisibleBelowSurface=e,this._setDirty(),this.extentIntersectionDirty=!0},enumerable:!0,configurable:!0}),t.prototype.updateIsVisibleBelowSurface=function(){var e=this.layerView.view,t=e.basemapTerrain,i="local"===e.viewingMode,r=e.map.ground&&e.map.ground.navigationConstraint&&"none"===e.map.ground.navigationConstraint.type;this.isVisibleBelowSurface=i||!t.isOpaque()||r},t.prototype.updateExtentIntersection=function(){if(this.extentIntersectionDirty){this.extentIntersectionDirty=!1;var e,t=this.layerView.view;if(this._isVisibleBelowSurface)e=c;else{var i=t.basemapTerrain.elevationBounds,r=i.min,n=i.max;e=r-Math.max(1,(n-r)*(1.2-1))}this.extentIntersection.update(this.extent,t.spatialReference,e)}},t.prototype.update=function(){if(this._set("updating",!1),this.extent){this.updateExtentIntersection();var e=this.layerView.view.frustum;this._set("suspended",!this.extentIntersection.isVisibleInFrustum(e))}else this._set("suspended",!1)},r([a.property({readOnly:!0})],t.prototype,"suspended",void 0),r([a.property({readOnly:!0})],t.prototype,"updating",void 0),r([a.subclass("esri.views.3d.layers.graphics.Graphics3DFrustumVisibility")],t)}(a.declared(n))}.apply(null,r))||(e.exports=n)},1743:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(10),i(11),i(97),i(16),i(58),i(24),i(22),i(25),i(0),i(63),i(653),i(402),i(413),i(1717),i(1718),i(1744),i(1692),i(1719),i(1721),i(84),i(1681),i(292)],void 0===(n=function(e,t,i,r,n,s,o,a,u,l,p,c,d,h,y,f,g,v,b,w,m,E,_,x,V,C){var O=function(e){function t(t){var i=e.call(this)||this;return i._handles=new p,i.highlights=new E,i.watchUpdatingTracking=new C.WatchUpdatingTracking,i.suspendResumeExtentMode="computed",i.dataExtent=null,i.suspendResumeExtent=null,i}return i(t,e),Object.defineProperty(t.prototype,"suspended",{get:function(){return this.scaleVisibility&&this.scaleVisibility.suspended||this.frustumVisibility&&this.frustumVisibility.suspended},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.graphicsCore&&this.graphicsCore.updating||this.frustumVisibility&&this.frustumVisibility.updating||this.watchUpdatingTracking&&this.watchUpdatingTracking.updating)},enumerable:!0,configurable:!0}),t.prototype.normalizeCtorArgs=function(e){var t=e.frustumVisibilityEnabled?new m:null,i=e.scaleVisibilityEnabled?new _:null,r=(e.filterVisibilityEnabled||e.timeExtentVisibilityEnabled)&&"multipatch"!==e.layer.geometryType?new w.Graphics3DFilterVisibility:null,n=e.elevationAlignmentEnabled?new b:null;return{graphicsCore:new v({owner:e.owner,layer:e.layer,preferredUpdatePolicy:e.preferredUpdatePolicy,elevationFeatureExpressionEnabled:e.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1,hasZ:e.owner.hasZ,hasM:e.owner.hasM}),frustumVisibility:t,scaleVisibility:i,filterVisibility:r,elevationAlignment:n,updateClippingExtent:e.updateClippingExtent,suspendResumeExtentMode:e.suspendResumeExtentMode,dataExtent:e.dataExtent}},t.prototype.initialize=function(){var e=this;this.scaleVisibility&&this.watchUpdatingTracking.add(this.layer,"scaleRangeId",function(){return e.scaleVisibility.layerMinMaxScaleChangeHandler()}),this.filterVisibility&&(this.watchUpdatingTracking.add(this.owner,"filter",function(){return e.filterVisibility.filterChanged()}),this.watchUpdatingTracking.add(this.owner,"timeExtent",function(){return e.filterVisibility.filterChanged()})),this.elevationAlignment&&this.watchUpdatingTracking.add(this.layer,"elevationInfo",function(t,i){y.diff(t,i)&&e.graphicsCore.elevationInfoChange()}),this.watchUpdatingTracking.add(this.layer,"labelsVisible",function(){return e.graphicsCore.updateVisibilityInfo()}),this.watchUpdatingTracking.add(this.layer,"labelingInfo",function(t,i){y.diff(t,i)&&e.graphicsCore.updateLabelingInfo()})},t.prototype.setup=function(){return s(this,void 0,void 0,function(){var e,t,i,r,s=this;return n(this,function(n){switch(n.label){case 0:return this.frustumVisibility&&this.frustumVisibility.setup(this.owner),e=this.owner,t=this.owner.view.basemapTerrain,i=function(e,t,i){return s.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(e,t,i)},this.scaleVisibility&&this.scaleVisibility.setup(e,this.layer,i,this.graphicsCore,t),this.filterVisibility&&("filter"in e||"timeExtent"in e)&&this.filterVisibility.setup(e,this.graphicsCore),this.elevationAlignment&&(r=e.view.elevationProvider,this.elevationAlignment.setup(e,i,this.graphicsCore,r)),this.highlights&&this.highlights.setup(this.graphicsCore),this._set("labeling",this.owner.view.labeler.addGraphicsOwner(this.graphicsCore,this.scaleVisibility)),this._set("deconfliction",e.view.deconflictor.addGraphicsOwner(this.graphicsCore)),[4,u.result(this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,filterVisibility:this.filterVisibility,deconflictor:this.deconfliction,labeler:this.labeling,highlights:this.highlights}))];case 1:return n.sent(),this._handles.add([this.layer.watch("renderer",function(e){return s.graphicsCore.rendererChange(e)}),e.watch("fullOpacity",function(){return s.graphicsCore.opacityChange()})]),this.setupSuspendResumeExtent(),this.updateClippingExtent&&(this._handles.add(e.view.watch("clippingArea",function(){return s._updateClippingExtent()})),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),this.graphicsCore.labelsEnabled?[4,u.result(this.graphicsCore.updateLabelingInfo())]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null);for(var e=0,t=["watchUpdatingTracking","frustumVisibility","scaleVisibility","filterVisibility","elevationAlignment","highlights","graphicsCore"];e<t.length;e++){var i=t[e],r=this[i];r&&(r.destroy(),this._set(i,null))}this._set("layer",null),this._set("owner",null)},t.prototype.highlight=function(e,t,i){var r=this;if(e instanceof f){var n=this.highlights.acquireSet(t,i),s=n.set,a=n.handle;return this.owner.queryObjectIds(e).then(function(e){return r.highlights.setObjectIds(s,e)}),a}if("number"==typeof e)return this.highlight([e],t,i);if(e instanceof o)return this.highlight([e],t,i);if("toArray"in e&&(e=e.toArray()),Array.isArray(e)&&e.length>0){if(e[0]instanceof o){var u=e;if(!i||!u[0].attributes||null===V.attributeLookup(u[0].attributes,i)){var l=u.map(function(e){return e.uid}),p=this.highlights.acquireSet(t,null),c=p.set;a=p.handle;return this.highlights.setUids(c,l),a}e=u.map(function(e){return V.attributeLookup(e.attributes,i)})}if("number"==typeof e[0]){var d=e,h=this.highlights.acquireSet(t,i);c=h.set,a=h.handle;return this.highlights.setObjectIds(c,d),a}}return R},t.prototype._updateClippingExtent=function(){var e=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.owner.view.spatialReference)&&(this.updateClippingExtent(e)||this.graphicsCore.recreateAllGraphics())},t.prototype.setupSuspendResumeExtent=function(){var e=this;(this.frustumVisibility||this.scaleVisibility)&&this._handles.add(c.init(this,"suspendResumeExtentMode",function(){switch(e._handles.remove(I),e.suspendResumeExtentMode){case"computed":e._handles.add(c.init(e.graphicsCore,"computedExtent",function(t){return e.updateSuspendResumeExtent(t)}),I);break;case"data":e._handles.add(c.init(e,"dataExtent",function(t){return e.updateSuspendResumeExtent(t)}),I);break;default:l.neverReached(e.suspendResumeExtentMode)}}))},t.prototype.updateSuspendResumeExtent=function(e){e?this.suspendResumeExtentChanged(this.extentToSuspendResumeRect(e,this.suspendResumeExtent)):this.suspendResumeExtentChanged(null)},t.prototype.extentToSuspendResumeRect=function(e,t){var i=this.owner.view.spatialReference;if(!e.spatialReference.equals(i)){if(!h.canProject(e,i))return;e=h.project(e,i)}return x.enlargeExtent(e,t,g.SUSPEND_RESUME_EXTENT_OPTIMISM)},t.prototype.suspendResumeExtentChanged=function(e){this.frustumVisibility&&this.frustumVisibility.setExtent(e),this.scaleVisibility&&this.scaleVisibility.setExtent(e)},r([d.property({aliasOf:"graphicsCore.layer"})],t.prototype,"layer",void 0),r([d.property({aliasOf:"graphicsCore.owner"})],t.prototype,"owner",void 0),r([d.property({constructOnly:!0})],t.prototype,"updateClippingExtent",void 0),r([d.property({constructOnly:!0})],t.prototype,"graphicsCore",void 0),r([d.property({constructOnly:!0})],t.prototype,"scaleVisibility",void 0),r([d.property({constructOnly:!0})],t.prototype,"filterVisibility",void 0),r([d.property({constructOnly:!0})],t.prototype,"elevationAlignment",void 0),r([d.property({constructOnly:!0})],t.prototype,"frustumVisibility",void 0),r([d.property({readOnly:!0})],t.prototype,"deconfliction",void 0),r([d.property({readOnly:!0})],t.prototype,"labeling",void 0),r([d.property({readOnly:!0})],t.prototype,"highlights",void 0),r([d.property({readOnly:!0})],t.prototype,"watchUpdatingTracking",void 0),r([d.property()],t.prototype,"suspendResumeExtentMode",void 0),r([d.property()],t.prototype,"dataExtent",void 0),r([d.property({readOnly:!0,dependsOn:["scaleVisibility.suspended","frustumVisibility.suspended"]})],t.prototype,"suspended",null),r([d.property({readOnly:!0,dependsOn:["graphicsCore.updating","frustumVisibility.updating","watchUpdatingTracking.updating"]})],t.prototype,"updating",null),r([d.subclass("esri.views.3d.layers.graphics.Graphics3DFeatureLikeLayerView")],t)}(d.declared(a)),I="suspendResumeExtentMode",R={remove:function(){},pause:function(){},resume:function(){}};return O}.apply(null,r))||(e.exports=n)},1744:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(16),i(22),i(6),i(9),i(25),i(0),i(1688),i(643),i(145)],void 0===(n=function(e,t,i,r,n,s,o,a,u,l,p,c,d){Object.defineProperty(t,"__esModule",{value:!0});var h=o.getLogger("esri.views.3d.layers.graphics.Graphics3DFilterVisibility"),y=function(e){function t(){var t=e.call(this)||this;return t.filter=null,t._dirty=!1,t._querying=!1,t._handles=new s,t}return i(t,e),Object.defineProperty(t.prototype,"updating",{get:function(){return this._dirty||this._querying||null!=this._queryResult},enumerable:!0,configurable:!0}),t.prototype.setup=function(e,t){var i=this;this._layerView=e,this._core=t,this._objectIdField=e.layer.objectIdField,this._queryEngine=new p.default({layerView:this._layerView,task:d.Task.FILTER_VISIBILITY});var r=this._layerView.view.resourceController.scheduler;this._handles.add(r.registerTask(d.Task.FILTER_VISIBILITY,function(e){return i._update(e)},function(){return i._needsUpdate()})),this._handles.add(u.on(t.owner,"loadedGraphics","after-changes",function(e){return i._graphicsChanged(e)},function(){return i.dirty=!0}))},t.prototype.destroy=function(){this._handles.destroy(),this._handles=null,this.clear(),this._layerView=null,this._core=null},t.prototype.clear=function(){this._queryEngine.clear()&&(this._core.modifyGraphics3DGraphicVisibilities(function(e){return e.clearVisibilityFlag(2)}),this._queryResult=null,this._querying=!1),this.dirty=!1,this.notifyChange("updating")},t.prototype._graphicsChanged=function(e){this._queryEngine&&0==(1&e.type)||(this.dirty=!0)},t.prototype.updateVisibility=function(e){this.active&&(e.hasVisibilityFlag(2,0)||e.setVisibilityFlag(2,!1,0),this.dirty=!0)},t.prototype.filterChanged=function(){this.filter=this.recomputeFilter(),this.dirty=!0},Object.defineProperty(t.prototype,"active",{get:function(){return this.filter&&this._core.graphics3DGraphics.size>0},enumerable:!0,configurable:!0}),t.prototype.recomputeFilter=function(){var e="filter"in this._layerView?this._layerView.filter:null,t="timeExtent"in this._layerView?this._layerView.timeExtent:null;if(!t)return e;var i=a.isSome(e)?e.clone():new c;return i.timeExtent=i.timeExtent?i.timeExtent.intersection(t):t,i},t.prototype._needsUpdate=function(){return this._dirty&&!this._querying||null!=this._queryResult},t.prototype._update=function(e){var t=this;this.active?(!this._dirty||this._querying||e.done||(this._querying=!0,this.dirty=!1,this._queryEngine.executeQueryForIdSet(this.filter).then(function(e){t._queryResult=e,t._querying=!1}).catch(function(e){h.warn("FeatureFilter query failed: "+e),t._queryResult=new Set,t._core.graphics3DGraphics.forEach(function(e){return t._queryResult.add(t._getFeatureId(e.graphic))}),t._querying=!1}),e.madeProgress()),this._queryResult&&!e.done&&(this._core.modifyGraphics3DGraphicVisibilities(function(i){if(e.done)return!1;var r=t._queryResult.has(t._getFeatureId(i.graphic));return!!i.setVisibilityFlag(2,r,0)&&(e.madeProgress(),!0)}),e.done||(this._queryResult=null)),this.notifyChange("updating")):this.clear()},t.prototype._getFeatureId=function(e){return null==e.objectId?e.attributes[this._objectIdField]:e.objectId},Object.defineProperty(t.prototype,"dirty",{set:function(e){this._dirty!==e&&(this._dirty=e,this.notifyChange("updating"))},enumerable:!0,configurable:!0}),r([l.property({readOnly:!0})],t.prototype,"updating",null),r([l.subclass("esri.views.3d.layers.graphics.Graphics3DFilterVisibility")],t)}(l.declared(n));t.Graphics3DFilterVisibility=y}.apply(null,r))||(e.exports=n)},1829:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(10),i(11),i(4),i(58),i(14),i(9),i(7),i(25),i(0),i(103),i(425),i(402),i(1743),i(1688),i(1664),i(145)],void 0===(n=function(e,t,i,r,n,s,o,a,u,l,p,c,d,h,y,f,g,v,b,w){Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureLikeLayerView3D=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=null,t.asyncGraphicsUpdates=!1,t.suspendResumeExtentMode="computed",t.slicePlaneEnabled=!1,t.supportsDraping=!0,t.overlayUpdating=!1,t.fullExtentInLocalViewSpatialReference=null,t.suspendResumeExtent=null,t._controllerCreated=!1,t.clippingExtent=null,t.supportsHeightUnitConversion=!0,t.pendingController=null,t.queryEngine=null,t}return i(t,e),t.prototype.initialize=function(){var e=this;this.layer.isTable?this.addResolvingPromise(p.reject(new u("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer}))):(this._set("graphics3d",new g({owner:this,layer:this.layer,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,filterVisibilityEnabled:!0,timeExtentVisibilityEnabled:!0,elevationAlignmentEnabled:!0,elevationFeatureExpressionEnabled:!0,preferredUpdatePolicy:this.asyncGraphicsUpdates?1:0,suspendResumeExtentMode:this.suspendResumeExtentMode,updateClippingExtent:function(t){return e.updateClippingExtent(t)}})),this.updatingHandles.add(this,"asyncGraphicsUpdates",function(t){e.graphics3d.graphicsCore.preferredUpdatePolicy=t?1:0}),this.updatingHandles.add(this,"suspendResumeExtentMode",function(t){e.graphics3d.suspendResumeExtentMode=t}),this.drawingOrder=this.view.getDrawingOrder(this.layer.uid),this.addResolvingPromise(a.safeCast(this.graphics3d.setup()).then(function(){return e.validateGeometryType()}).then(function(){return e.queryEngine=new v.default({layerView:e,task:w.Task.FEATURE_QUERY_ENGINE})}).then(function(){return b.toViewIfLocal(e)}).then(function(t){return e.fullExtentInLocalViewSpatialReference=t}).then(function(){return e.initializeController()})),this.notifyChange("updating"))},t.prototype.destroy=function(){this.destroyPendingController(),this.controller&&(this.controller.destroy(),this.controller=null),this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null)),this.queryEngine&&(this.queryEngine.destroy(),this.queryEngine=null),this.loadedGraphics=null},t.prototype.destroyPendingController=function(){this.pendingController&&(this.pendingController.destroy(),this.pendingController=null)},Object.defineProperty(t.prototype,"drawingOrder",{set:function(e){this.graphics3d.graphicsCore.setDrawingOrder(e),this._set("drawingOrder",e)},enumerable:!0,configurable:!0}),t.prototype.getRenderingInfo=function(e,t){var i=y.getRenderingInfo(e,{renderer:t});if(i&&i.color){var r=i.color;r[0]=r[0]/255,r[1]=r[1]/255,r[2]=r[2]/255}return i},t.prototype.getRenderingInfoAsync=function(e,t,i){return s(this,void 0,void 0,function(){return n(this,function(r){return[2,y.getRenderingInfoAsync(e,o({renderer:t},i))]})})},t.prototype.getGraphicFromGraphicUid=function(e){var t=this,i=null;return this.loadedGraphics&&this.loadedGraphics.forEach(function(r){r.uid===e&&(i=h.hydrateGraphic(r,t.layer))}),i},Object.defineProperty(t.prototype,"graphics3DGraphics",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphics:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics3DGraphicsByObjectID",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"symbolUpdateType",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.symbolUpdateType:null},enumerable:!0,configurable:!0}),t.prototype.whenGraphicBounds=function(e,t){return this.graphics3d?this.graphics3d.graphicsCore.whenGraphicBounds(e,t):null},t.prototype.whenSymbolLayerSize=function(e,t){return this.graphics3d?a.safeCast(this.graphics3d.graphicsCore.whenSymbolLayerSize(e,t)):null},t.prototype.queryFeatures=function(e,t){return a.safeCast(this.queryEngine.executeQuery(this._ensureQuery(e),l.get(t,"signal")))},t.prototype.queryObjectIds=function(e,t){return a.safeCast(this.queryEngine.executeQueryForIds(this._ensureQuery(e),l.get(t,"signal")))},t.prototype.queryFeatureCount=function(e,t){return a.safeCast(this.queryEngine.executeQueryForCount(this._ensureQuery(e),l.get(t,"signal")))},t.prototype.queryExtent=function(e,t){return a.safeCast(this.queryEngine.executeQueryForExtent(this._ensureQuery(e),l.get(t,"signal")))},t.prototype._ensureQuery=function(e){return l.isNone(e)?this.createQuery():f.from(e)},t.prototype.highlight=function(e,t){return void 0===t&&(t={}),this.graphics3d.highlight(e,t,this.layer.objectIdField)},t.prototype.getStats=function(){var e=this.graphics3d.graphicsCore.getStats();return e.features=this.loadedGraphics.length,e.updating=this.updating,e.elevationUpdating=this.graphics3d.elevationAlignment.updating,e.visibilityFrustum=!this.graphics3d.frustumVisibility.suspended,e.visibilityScale=!this.graphics3d.scaleVisibility.suspended,e},t.prototype.canResume=function(){return!(!this.inherited(arguments)||this.graphics3d&&this.graphics3d.suspended)},t.prototype.isUpdating=function(){return!(!this.graphics3d||this.graphics3d.destroyed||!(!this._controllerCreated||this.controller&&this.controller.updating||this.overlayUpdating)&&this.view.basemapTerrain&&this.view.basemapTerrain.ready&&!this.graphics3d.updating)},t.prototype.initializeController=function(){return s(this,void 0,void 0,function(){var e;return n(this,function(t){switch(t.label){case 0:return[4,this.createController()];case 1:return e=t.sent(),this.pendingController=e,[4,e.when()];case 2:return t.sent(),this.setControllerWhenInitialized(e),[2]}})})},t.prototype.setControllerWhenInitialized=function(e){return s(this,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.when()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return this._controllerCreated=!0,this.notifyChange("updating"),this.isResolved()?[4,c.whenTrueOnce(this.view,"basemapTerrain.ready")]:(this.destroyPendingController(),[2]);case 4:return t.sent(),this.pendingController=null,this.controller=e,this.loadedGraphics=e.graphics,this.notifyChange("updating"),[2]}})})},t.prototype.updateClippingExtent=function(e){if(this.clippingExtent=e,!this.controller)return!1;switch(this.controller.type){case"stream":return!1;case"feature-tile-3d":return this.controller.extent=e,!0}},t.prototype.validateGeometryType=function(){var e=this.layer;switch(e.geometryType){case"multipatch":case"multipoint":return p.reject(new u("featurelayerview3d:unsupported-geometry-type","Unsupported geometry type ${geometryType}",{geometryType:e.geometryType}))}},r([d.property()],t.prototype,"loadedGraphics",void 0),r([d.property({dependsOn:["graphics3d.suspended"]})],t.prototype,"suspended",void 0),r([d.property({dependsOn:["graphics3d.updating","controller.updating","overlayUpdating"]})],t.prototype,"updating",void 0),r([d.property()],t.prototype,"controller",void 0),r([d.property()],t.prototype,"graphics3d",void 0),r([d.property({readOnly:!0})],t.prototype,"asyncGraphicsUpdates",void 0),r([d.property({readOnly:!0})],t.prototype,"suspendResumeExtentMode",void 0),r([d.property({type:Boolean})],t.prototype,"slicePlaneEnabled",void 0),r([d.property({aliasOf:"graphics3d.graphicsCore.hasDraped"})],t.prototype,"hasDraped",void 0),r([d.property({readOnly:!0,type:Boolean})],t.prototype,"supportsDraping",void 0),r([d.property({type:Boolean})],t.prototype,"overlayUpdating",void 0),r([d.property()],t.prototype,"drawingOrder",null),r([d.subclass("esri.views.3d.layers.FeatureLikeLayerView3D")],t)}(d.declared(e))}}.apply(null,r))||(e.exports=n)},2561:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(10),i(11),i(97),i(29),i(7),i(0),i(402),i(1829),i(1640),i(1633),i(2562)],void 0===(n=function(e,t,r,n,s,o,a,u,l,p,c,d,h,y,f){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.createQuery=function(){return new c({outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference})},t.prototype.createController=function(){return o(this,void 0,void 0,function(){var e,t,r;return s(this,function(n){switch(n.label){case 0:return e=u.ofType(a),[4,l.create(function(e){i.e(98).then(function(){var t=[i(2585)];e.apply(null,t)}.bind(this)).catch(i.oe)})];case 1:return t=n.sent(),[4,(r=new t({layer:this.layer,layerView:this,graphics:new e})).when()];case 2:return n.sent(),[2,r]}})})},n([p.property()],t.prototype,"controller",void 0),n([p.property({readOnly:!0,aliasOf:"layer.capabilities.data.supportsZ"})],t.prototype,"hasZ",void 0),n([p.property({readOnly:!0,aliasOf:"layer.capabilities.data.supportsM"})],t.prototype,"hasM",void 0),n([p.subclass("esri.views.3d.layers.StreamLayerView3D")],t)}(p.declared(f.StreamLayerView(d.FeatureLikeLayerView3D(h.LayerView3D(y)))))}.apply(null,r))||(e.exports=n)},2562:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(22),i(25),i(0),i(643)],void 0===(n=function(e,t,i,r,n,s,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.StreamLayerView=function(e){return function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.apply(this,t)||this;return r._handles=new n,r.connectionError=null,r.connectionStatus="disconnected",r.filter=null,r._handles.add(s.on(r,"controller","data-received",function(e){r.emit("data-received",e)})),r}return i(t,e),r([o.property({aliasOf:"controller.connection.connectionError",readOnly:!0})],t.prototype,"connectionError",void 0),r([o.property({aliasOf:"controller.connection.connectionStatus",readOnly:!0})],t.prototype,"connectionStatus",void 0),r([o.property()],t.prototype,"controller",void 0),r([o.property({type:a})],t.prototype,"filter",void 0),r([o.subclass("esri.layers.mixins.StreamLayerView")],t)}(o.declared(e))}}.apply(null,r))||(e.exports=n)}}]);