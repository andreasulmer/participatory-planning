(function(){(this||window).webpackJsonp.registerAbsMids({"esri/tasks/support/FeatureSet":1575,"esri/geometry/support/normalizeUtils":1635,"esri/tasks/geometry/cut":1636,"esri/tasks/geometry/simplify":1637,"esri/tasks/support/AttachmentQuery":1651,"esri/tasks/support/RelationshipQuery":1652,"esri/views/layers/support/popupUtils":1657,"esri/layers/support/PromiseQueue":1687,"esri/views/3d/layers/support/DefinitionExpressionSceneLayerView":1760,"esri/views/3d/layers/support/fieldProperties":1761,"esri/views/3d/layers/BuildingSublayerView3D":2076,"esri/views/3d/layers/BuildingSceneLayerView3D":2563,"esri/views/3d/layers/BuildingComponentSublayerView3D":2564,"esri/views/3d/layers/BuildingGroupSublayerView3D":2565})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[53,77,110],{1575:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(2),r(36),r(97),r(27),r(12),r(9),r(0),r(40),r(57),r(633)],void 0===(n=function(e,t,r,i,n,o,s,a,p,l,u,d,c){var f=new s.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"}),y=function(e){function t(t){var r=e.call(this,t)||this;return r.displayFieldName=null,r.exceededTransferLimit=!1,r.features=[],r.fields=null,r.geometryType=null,r.hasM=!1,r.hasZ=!1,r.queryGeometry=null,r.spatialReference=null,r}return i(t,e),t.prototype.readFeatures=function(e,t){for(var r=u.fromJSON(t.spatialReference),i=[],n=0;n<e.length;n++){var s=e[n],a=o.fromJSON(s),l=s.geometry&&s.geometry.spatialReference;p.isSome(a.geometry)&&!l&&(a.geometry.spatialReference=r),i.push(a)}return i},t.prototype.writeGeometryType=function(e,t,r,i){if(e)f.write(e,t,r,i);else{var n=this.features;if(n)for(var o=0,s=n;o<s.length;o++){var a=s[o];if(a&&p.isSome(a.geometry))return void f.write(a.geometry.type,t,r,i)}}},t.prototype.writeSpatialReference=function(e,t,r,i){if(e)t.spatialReference=e.toJSON();else{var n=this.features;if(n)for(var o=0,s=n;o<s.length;o++){var a=s[o];a&&p.isSome(a.geometry)&&a.geometry.spatialReference&&(t.spatialReference=a.geometry.spatialReference.toJSON())}}},t.prototype.toJSON=function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var i=t.features[r];if(i.geometry){var n=e&&e[r];i.geometry=n&&n.toJSON()||i.geometry}}return t},t.prototype.quantize=function(e){for(var t=e.scale,r=t[0],i=t[1],n=e.translate,o=n[0],s=n[1],a=this.features,l=this._getQuantizationFunction(this.geometryType,function(e){return Math.round((e-o)/r)},function(e){return Math.round((s-e)/i)}),u=0,d=a.length;u<d;u++)l(p.expect(a[u].geometry))||(a.splice(u,1),u--,d--);return this.transform=e,this},t.prototype.unquantize=function(){var e=this,t=e.geometryType,r=e.features,i=e.transform;if(!i)return this;for(var n=i.translate,o=n[0],s=n[1],a=i.scale,l=a[0],u=a[1],d=this._getHydrationFunction(t,function(e){return e*l+o},function(e){return s-e*u}),c=0,f=r;c<f.length;c++){var y=f[c].geometry;p.isSome(y)&&d(y)}return this},t.prototype._quantizePoints=function(e,t,r){for(var i,n,o=[],s=0,a=e.length;s<a;s++){var p=e[s];if(s>0){var l=t(p[0]),u=r(p[1]);l===i&&u===n||(o.push([l-i,u-n]),i=l,n=u)}else i=t(p[0]),n=r(p[1]),o.push([i,n])}return o.length>0?o:null},t.prototype._getQuantizationFunction=function(e,t,r){var i=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var n=d.isPolygon(e)?e.rings:e.paths,o=[],s=0,a=n.length;s<a;s++){var p=n[s],l=i._quantizePoints(p,t,r);l&&o.push(l)}return o.length>0?(d.isPolygon(e)?e.rings=o:e.paths=o,e):null}:"multipoint"===e?function(e){var n;return(n=i._quantizePoints(e.points,t,r)).length>0?(e.points=n,e):null}:"extent"===e?function(e){return e}:null},t.prototype._getHydrationFunction=function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var i,n,o=d.isPolygon(e)?e.rings:e.paths,s=0,a=o.length;s<a;s++)for(var p=o[s],l=0,u=p.length;l<u;l++){var c=p[l];l>0?(i+=c[0],n+=c[1]):(i=c[0],n=c[1]),c[0]=t(i),c[1]=r(n)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var i,n,o=e.points,s=0,a=o.length;s<a;s++){var p=o[s];s>0?(i+=p[0],n+=p[1]):(i=p[0],n=p[1]),p[0]=t(i),p[1]=r(n)}}:void 0},r([l.property({type:String,json:{write:!0}})],t.prototype,"displayFieldName",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"exceededTransferLimit",void 0),r([l.property({type:[o],json:{write:!0}})],t.prototype,"features",void 0),r([l.reader("features")],t.prototype,"readFeatures",null),r([l.property({type:[c],json:{write:!0}})],t.prototype,"fields",void 0),r([l.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:f.read}}})],t.prototype,"geometryType",void 0),r([l.writer("geometryType")],t.prototype,"writeGeometryType",null),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasM",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasZ",void 0),r([l.property({types:n.geometryTypes,json:{read:d.fromJSON,write:!0}})],t.prototype,"queryGeometry",void 0),r([l.property({type:u,json:{write:!0}})],t.prototype,"spatialReference",void 0),r([l.writer("spatialReference")],t.prototype,"writeSpatialReference",null),r([l.property({json:{write:!0}})],t.prototype,"transform",void 0),r([l.subclass("esri.tasks.support.FeatureSet")],t)}(l.declared(a.JSONSupport));return y.prototype.toJSON.isDefaultToJSON=!0,y||(y={}),y}.apply(null,i))||(e.exports=n)},1635:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(11),r(98),r(14),r(6),r(9),r(7),r(91),r(104),r(40),r(90),r(63),r(1636),r(1637)],void 0===(n=function(e,t,r,i,n,o,s,a,p,l,u,d,c,f,y,h){function g(e){return"polygon"===e.type}function v(e){return"polygon"===e[0].type}function m(e){return"polyline"===e[0].type}function w(e){return g(e)?e.rings:e.paths}function x(e,t){return Math.ceil((e-t)/(2*t))}function b(e,t){for(var r=0,i=w(e);r<i.length;r++)for(var n=0,o=i[r];n<o.length;n++){o[n][0]+=t}return e}function F(e){for(var t=[],r=0,i=0,n=0;n<e.length;n++){for(var o=e[n],s=null,a=0;a<o.length;a++)s=o[a],t.push(s),0===a?i=r=s[0]:(r=Math.min(r,s[0]),i=Math.max(i,s[0]));s&&t.push([(r+i)/2,0])}return t}function E(e,t){if(!(e instanceof u||e instanceof l)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw _.error(r),new o(r)}for(var i=[],n=0,s=w(e);n<s.length;n++){var a=s[n],p=[];i.push(p),p.push([a[0][0],a[0][1]]);for(var d=0;d<a.length-1;d++){var c=a[d][0],f=a[d][1],y=a[d+1][0],h=a[d+1][1],v=Math.sqrt((y-c)*(y-c)+(h-f)*(h-f)),m=(h-f)/v,x=(y-c)/v,b=v/t;if(b>1){for(var F=1;F<=b-1;F++){var E=F*t,S=x*E+c,j=m*E+f;p.push([S,j])}var O=(v+Math.floor(b-1)*t)/2,P=x*O+c,M=m*O+f;p.push([P,M])}p.push([y,h])}}return g(e)?new l({rings:i,spatialReference:e.spatialReference}):new u({paths:i,spatialReference:e.spatialReference})}function S(e,t,r){if(t){var i=E(e,1e6);e=f.webMercatorToGeographic(i,!0)}return r&&(e=b(e,r)),e}function j(e,t,r){var i;if(Array.isArray(e)){if((i=e[0])>t){var n=x(i,t);e[0]=i+n*(-2*t)}else if(i<r){n=x(i,r);e[0]=i+n*(-2*r)}}else if((i=e.x)>t){n=x(i,t);e=e.clone().offset(n*(-2*t),0)}else if(i<r){n=x(i,r);e=e.clone().offset(n*(-2*r),0)}return e}function O(e,t){for(var r=-1,i=0;i<t.cutIndexes.length;i++)!function(i){for(var n=t.cutIndexes[i],o=t.geometries[i],s=w(o),a=0;a<s.length;a++)!function(e){var t=s[e];t.some(function(r){if(r[0]<180)return!0;for(var i=0,n=0;n<t.length;n++){var s=t[n][0];i=s>i?s:i}for(var a=-360*x(i=Number(i.toFixed(9)),180),p=0;p<t.length;p++){var l=o.getPoint(e,p);o.setPoint(e,p,l.clone().offset(a,0))}return!0})}(a);if(n===r){if(v(e))for(var p=0,l=w(o);p<l.length;p++){var u=l[p];e[n]=e[n].addRing(u)}else if(m(e))for(var d=0,c=w(o);d<c.length;d++){var f=c[d];e[n]=e[n].addPath(f)}}else r=n,e[n]=o}(i);return e}Object.defineProperty(t,"__esModule",{value:!0});var _=s.getLogger("esri.geometry.support.normalizeUtils"),P={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new u({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:d.WebMercator}),minus180Line:new u({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:d.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new u({paths:[[[180,-180],[180,180]]],spatialReference:d.WGS84}),minus180Line:new u({paths:[[[-180,-180],[-180,180]]],spatialReference:d.WGS84})}};t.straightLineDensify=E,t.normalizeCentralMeridian=function e(t,o,s){return i(this,void 0,void 0,function(){var i,d,g,v,m,w,F,E,_,M,V,R,L,N,T,I,D,C,G,q,J,z,k,A,B,U,H,W,Q,X,Z,K,Y,$,ee,te,re;return r(this,function(r){switch(r.label){case 0:if(!Array.isArray(t))return[2,e([t],o)];for(i=o?o.url:n.geometryServiceUrl,M=0,V=[],R=[],L=0,N=t;L<N.length;L++)T=N[L],a.isNone(T)?R.push(T):(d||(d=T.spatialReference,g=c.getInfo(d),v=d.isWebMercator,m=P[F=v?102100:4326].maxX,w=P[F].minX,E=P[F].plus180Line,_=P[F].minus180Line),g?"mesh"===T.type?R.push(T):"point"===T.type?R.push(j(T.clone(),m,w)):"multipoint"===T.type?((I=T.clone()).points=I.points.map(function(e){return j(e,m,w)}),R.push(I)):"extent"===T.type?(C=T.clone(),D=C._normalize(!1,!1,g),R.push(D.rings?new l(D):D)):T.extent?(C=T.extent,G=x(C.xmin,w),J=0==(q=G*(2*m))?T.clone():b(T.clone(),q),C.offset(q,0),C.intersects(E)&&C.xmax!==m?(M=C.xmax>M?C.xmax:M,J=S(J,v),V.push(J),R.push("cut")):C.intersects(_)&&C.xmin!==w?(M=C.xmax*(2*m)>M?C.xmax*(2*m):M,J=S(J,v,360),V.push(J),R.push("cut")):R.push(J)):R.push(T.clone()):R.push(T));for(z=x(M,m),k=-90,A=z,B=new u;z>0;)U=360*z-180,B.addPath([[U,k],[U,-1*k]]),k*=-1,z--;return V.length>0&&A>0?[4,y.cut(i,V,B,s)]:[3,3];case 1:for(H=r.sent(),W=O(V,H),Q=[],X=[],ee=0;ee<R.length;ee++)"cut"!==(te=R[ee])?X.push(te):(re=W.shift(),Z=t[ee],a.isSome(Z)&&"polygon"===Z.type&&Z.rings&&Z.rings.length>1&&re.rings.length>=Z.rings.length?(Q.push(re),X.push("simplify")):X.push(v?f.geographicToWebMercator(re):re));return Q.length?[4,h.simplify(i,Q,s)]:[2,X];case 2:for(K=r.sent(),Y=[],ee=0;ee<X.length;ee++)"simplify"!==(te=X[ee])?Y.push(te):Y.push(v?f.geographicToWebMercator(K.shift()):K.shift());return[2,Y];case 3:for($=[],ee=0;ee<R.length;ee++)"cut"!==(te=R[ee])?$.push(te):(re=V.shift(),$.push(!0===v?f.geographicToWebMercator(re):re));return[2,p.resolve($)]}})})},t.getDenormalizedExtent=function(e){var t;if(!e)return null;var r=e.extent;if(!r)return null;var i=e.spatialReference&&c.getInfo(e.spatialReference);if(!i)return r;var n,o=i.valid,s=o[0],a=o[1],p=2*a,l=r.width,u=r.xmin,d=r.xmax;if(u=(t=[d,u])[0],d=t[1],"extent"===e.type||0===l||l<=a||l>p||u<s||d>a)return r;switch(e.type){case"polygon":if(!(e.rings.length>1))return r;n=F(e.rings);break;case"polyline":if(!(e.paths.length>1))return r;n=F(e.paths);break;case"multipoint":n=e.points}for(var f=r.clone(),y=0;y<n.length;y++){var h=n[y][0];h<0?(h+=a,d=Math.max(h,d)):(h-=a,u=Math.min(h,u))}return f.xmin=u,f.xmax=d,f.width<l?(f.xmin-=a,f.xmax-=a,f):r},t.normalizeMapX=function(e,t){var r=c.getInfo(t);if(r){var i=r.valid,n=i[0],o=i[1],s=o-n;if(e<n)for(;e<n;)e+=s;if(e>o)for(;e>o;)e-=s}return e}}.apply(null,i))||(e.exports=n)},1636:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(11),r(10),r(36),r(44),r(31),r(57)],void 0===(n=function(e,t,r,i,n,o,s,a,p){Object.defineProperty(t,"__esModule",{value:!0}),t.cut=function(e,t,l,u){return i(this,void 0,void 0,function(){var i,d,c,f,y,h,g;return n(this,function(n){switch(n.label){case 0:return i="string"==typeof e?a.urlToObject(e):e,d=t[0].spatialReference,c=r({},u,{query:r({},i.query,{f:"json",sr:JSON.stringify(d),target:JSON.stringify({geometryType:p.getJsonType(t[0]),geometries:t}),cutter:JSON.stringify(l)})}),[4,s(i.path+"/cut",c)];case 1:return f=n.sent(),y=f.data,h=y.cutIndexes,g=y.geometries,[2,{cutIndexes:h,geometries:(void 0===g?[]:g).map(function(e){return o.fromJSON(e).set(d)})}]}})})}}.apply(null,i))||(e.exports=n)},1637:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(11),r(10),r(44),r(31),r(57)],void 0===(n=function(e,t,r,i,n,o,s,a){Object.defineProperty(t,"__esModule",{value:!0}),t.simplify=function(e,t,p){return i(this,void 0,void 0,function(){var i,l,u,d;return n(this,function(n){switch(n.label){case 0:return i="string"==typeof e?s.urlToObject(e):e,l=t[0].spatialReference,u=a.getJsonType(t[0]),d=r({},p,{query:r({},i.query,{f:"json",sr:l.wkid?l.wkid:JSON.stringify(l),geometries:JSON.stringify(function(e){return{geometryType:a.getJsonType(e[0]),geometries:e.map(function(e){return e.toJSON()})}}(t))})}),[4,o(i.path+"/simplify",d)];case 1:return[2,function(e,t,r){var i=a.getGeometryType(t);return e.map(function(e){var t=i.fromJSON(e);return t.spatialReference=r,t})}(n.sent().data,u,l)]}})})}}.apply(null,i))||(e.exports=n)},1651:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(12),r(15),r(0),r(26)],void 0===(n=function(e,t,r,i,n,o,s,a){var p=function(e){function t(t){var r=e.call(this,t)||this;return r.attachmentTypes=null,r.globalIds=null,r.num=null,r.objectIds=null,r.returnMetadata=!1,r.size=null,r.start=null,r.where=null,r}var n;return r(t,e),n=t,t.prototype.writeStart=function(e,t,r){t.resultOffset=this.start,t.resultRecordCount=this.num||10},t.prototype.clone=function(){return new n(o.clone({attachmentTypes:this.attachmentTypes,where:this.where,globalIds:this.globalIds,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))},i([s.property({type:[String],json:{write:!0}})],t.prototype,"attachmentTypes",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"globalIds",void 0),i([s.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([s.property({type:Boolean,json:{default:!1,write:!0}})],t.prototype,"returnMetadata",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"size",void 0),i([s.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),i([s.writer("start"),s.writer("num")],t.prototype,"writeStart",null),i([s.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),n=i([s.subclass("esri.tasks.support.AttachmentQuery")],t)}(s.declared(n.JSONSupport));return p.from=a.default(p),p}.apply(null,i))||(e.exports=n)},1652:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(36),r(12),r(15),r(0),r(26)],void 0===(n=function(e,t,r,i,n,o,s,a,p){var l=function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.geometryPrecision=void 0,r.historicMoment=null,r.maxAllowableOffset=void 0,r.objectIds=null,r.outFields=null,r.outSpatialReference=null,r.relationshipId=void 0,r.returnGeometry=!1,r.source=null,r.where=null,r}var o;return r(t,e),o=t,t.prototype._writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.clone=function(){return new o(s.clone({gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&this.historicMoment.getTime(),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,source:this.source,where:this.where}))},i([a.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),i([a.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),i([a.property({type:Date})],t.prototype,"historicMoment",void 0),i([a.writer("historicMoment")],t.prototype,"_writeHistoricMoment",null),i([a.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([a.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),i([a.property({type:n.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),i([a.property({json:{write:!0}})],t.prototype,"relationshipId",void 0),i([a.property({json:{write:!0}})],t.prototype,"returnGeometry",void 0),i([a.property({json:{write:!0}})],t.prototype,"source",void 0),i([a.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),o=i([a.subclass("esri.tasks.support.RelationshipQuery")],t)}(a.declared(o.JSONSupport));return l.from=p.default(l),l}.apply(null,i))||(e.exports=n)},1657:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(11),r(229),r(9),r(117)],void 0===(n=function(e,t,r,i,n,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.getRequiredFields=function(e,t){return void 0===t&&(t=e.popupTemplate),i(this,void 0,void 0,function(){var i,a,p,l,u,d,c,f,y,h,g;return r(this,function(r){switch(r.label){case 0:return o.isSome(t)?[4,t.getRequiredFields(e.fields)]:[2,[]];case 1:return i=r.sent(),a=t.lastEditInfoEnabled,p=e.objectIdField,l=e.typeIdField,n.includes(i,"*")?[2,["*"]]:(d=s.fixFields,c=[e.fields],y=(f=i).concat,h=[[l]],(g=a)?[4,s.getFeatureEditFields(e)]:[3,3]);case 2:g=r.sent(),r.label=3;case 3:return(u=d.apply(void 0,c.concat([y.apply(f,h.concat([g||null]))])))&&p&&s.hasField(e.fields,p)&&-1===u.indexOf(p)&&u.push(p),[2,u]}})})},t.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:o.isSome(t)&&t.defaultPopupTemplateEnabled&&o.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}.apply(null,i))||(e.exports=n)},1687:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._deferreds=[],this._values=[]}return e.prototype.push=function(e){var t=this;return r.create(function(r,i){t._deferreds.push({resolve:r,reject:i}),t._values.push(e)})},e.prototype.unshift=function(e){var t=this;return r.create(function(r,i){t._deferreds.unshift({resolve:r,reject:i}),t._values.unshift(e)})},Object.defineProperty(e.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0}),e.prototype.process=function(){return 0!==this.length&&(this._deferreds.shift().resolve(this._values.shift()),!0)},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,i=this._deferreds;t<i.length;t++)i[t].reject(e);this._deferreds.length=0,this._values.length=0},e}();t.PromiseQueue=i}.apply(null,i))||(e.exports=n)},1760:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(0),r(635),r(1641)],void 0===(n=function(e,t,r,i,n,o,s,a){Object.defineProperty(t,"__esModule",{value:!0});var p=n.getLogger("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView");t.DefinitionExpressionSceneLayerView=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._definitionExpressionErrors=0,t._maxDefinitionExpressionErrors=20,t.logError=function(e){t._definitionExpressionErrors<t._maxDefinitionExpressionErrors&&p.error("Error while evaluating definitionExpression: "+e),++t._definitionExpressionErrors===t._maxDefinitionExpressionErrors&&p.error("Further errors are ignored")},t}return r(t,e),Object.defineProperty(t.prototype,"parsedDefinitionExpression",{get:function(){if(!this.layer||!this.layer.definitionExpression)return null;try{var e=s.WhereClause.create(this.layer.definitionExpression,this.layer.fieldsIndex);if(!e.isStandardized)return p.error("definitionExpression is using non standard function"),null;var t=[],r=e.fieldNames;return a.findFieldsCaseInsensitive(r,this.layer.fields,{missingFields:t}),t.length>0?(p.error("definitionExpression references unknown fields: "+t.join(", ")),null):(this._definitionExpressionErrors=0,e)}catch(e){return p.error("Failed to parse definitionExpression: "+e),null}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"definitionExpressionFields",{get:function(){return this.parsedDefinitionExpression?this.parsedDefinitionExpression.fieldNames:null},enumerable:!0,configurable:!0}),t.prototype._evaluateClause=function(e,t){try{return e.testFeature(t)}catch(e){return this.logError(e),!1}},t.prototype._addDefinitionExpressionToQuery=function(e){if(!this.parsedDefinitionExpression)return e;var t=this.layer.definitionExpression,r=e.clone();return r.where?r.where="("+t+") AND ("+r.where+")":r.where=t,r},i([o.property()],t.prototype,"layer",void 0),i([o.property({readOnly:!0,dependsOn:["layer.definitionExpression","layer.fieldsIndex"]})],t.prototype,"parsedDefinitionExpression",null),i([o.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],t.prototype,"definitionExpressionFields",null),i([o.subclass("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView")],t)}(o.declared(e))}}.apply(null,i))||(e.exports=n)},1761:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(117)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.defineFieldProperties=function(){return{requiredFields:{type:[String],readOnly:!0},availableFields:{type:[String],readOnly:!0,dependsOn:["layer.fields","layer.outFields","requiredFields"],get:function(){var e=this,t=e.layer,i=e.layer.fields,n=e.requiredFields;return t.outFields?r.fixFields(i,r.unpackFieldNames(i,t.outFields).concat(n)):r.fixFields(i,n)}}}}}.apply(null,i))||(e.exports=n)},2076:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(2),r(1),r(16),r(49),r(282),r(284),r(225),r(0)],void 0===(n=function(e,t,r,i,n,o,s,a,p,l,u){return function(e){function t(t){var r=e.call(this,t)||this;return r.layer=null,r.parent=null,r.view=null,r}return i(t,e),t.prototype.initialize=function(){},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},n([u.property()],t.prototype,"layer",void 0),n([u.property()],t.prototype,"parent",void 0),n([u.property({readOnly:!0,dependsOn:["view","visible","parent.suspended"]})],t.prototype,"suspended",null),n([u.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),n([u.property()],t.prototype,"view",void 0),n([u.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),n([u.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),n([u.subclass("esri.views.3d.layers.BuildingSublayerView3D")],t)}(u.declared(l.EsriPromiseMixin(a.HandleOwnerMixin(p.IdentifiableMixin(s.EventedMixin(o))))))}.apply(null,i))||(e.exports=n)},2563:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(2),r(1),r(10),r(11),r(97),r(29),r(9),r(7),r(25),r(0),r(2564),r(2565),r(1640),r(1641),r(1645),r(1633)],void 0===(n=function(e,t,r,i,n,o,s,a,p,l,u,d,c,f,y,h,g,v,m){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentLayerViews=new p,t.groupLayerViews=new p,t._abortController=u.createAbortController(),t._loadingComponents=0,t}return i(t,e),Object.defineProperty(t.prototype,"filterExpression",{get:function(){var e=this.layer.activeFilterId,t=null!=e?this.layer.filters.find(function(t){return t.id===e}):null,r=null!=t?t.filterBlocks.find(function(e){return"solid"===e.filterMode.type}):null;return r?r.filterExpression:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updatingPercentageValue",{get:function(){var e=this.componentLayerViews,t=this._loadingComponents,r=t+(e?e.length:0);return e.reduce(function(e,t){return e+t.updatingPercentage},100*t)/r},enumerable:!0,configurable:!0}),t.prototype.isUpdating=function(){return this._loadingComponents>0||this.componentLayerViews&&this.componentLayerViews.some(function(e){return e.updating})},t.prototype.initialize=function(){g.checkSpatialReference(this.layer.spatialReference,this.view.spatialReference,this.view.viewingMode),this.initializeSubLayerViews(this.layer.sublayers,this)},t.prototype.destroy=function(){this.groupLayerViews&&(this.groupLayerViews.forEach(function(e){return e.destroy()}),this.groupLayerViews=null),this.componentLayerViews&&(this.componentLayerViews.forEach(function(e){return e.destroy()}),this.componentLayerViews=null),this._abortController.abort(),this._abortController=null},t.prototype.initializeSubLayerViews=function(e,t){var r=this,i=this,n=this.view;e.forEach(function(e){if("building-group"===e.type){var o=new y({layer:e,view:n,parent:t});r.groupLayerViews.push(o),r.initializeSubLayerViews(e.sublayers,o)}else r._loadingComponents++,e.load({signal:r._abortController.signal}).then(function(){r._loadingComponents--;var o=new f({layer:e,layerView:i,view:n,parent:t});r.componentLayerViews.push(o),r.handles.add([d.init(o,"updating",function(){return r.notifyChange("updating")},!0),d.init(o,"updatingPercentage",function(){return r.notifyChange("updatingPercentageValue")},!0)])})})},t.prototype.getGraphicFromStageObject=function(e,t){var r=this.componentLayerViews.find(function(t){return t.hasStageObject(e)});return r?r.getGraphicFromStageObject(e,t):null},t.prototype.fetchPopupFeatures=function(e,t){return s(this,void 0,void 0,function(){var r;return o(this,function(i){return l.isSome(t)&&t.clientGraphics&&0!==t.clientGraphics.length?(r=this._findComponent(t.clientGraphics[0].sourceLayer),l.isNone(r)?[2,void 0]:[2,r.fetchPopupFeatures(e,t)]):[2,void 0]})})},t.prototype.whenGraphicBounds=function(e){var t=this._findComponent(e.sourceLayer);return l.isNone(t)?u.reject():t.whenGraphicBounds(e)},t.prototype._findComponent=function(e){return this.componentLayerViews.find(function(t){return e===t.layer})},t.prototype.highlight=function(e,t){void 0===t&&(t={}),e instanceof a?e=[e]:e instanceof p&&(e=e.toArray());var r=[];if(Array.isArray(e)&&e.length>0&&e[0]instanceof a){for(var i=e,n=new Map,o=0,s=i;o<s.length;o++){var l=s[o],u=n.get(l.sourceLayer);null==u&&(u=[],n.set(l.sourceLayer,u)),u.push(l)}this.componentLayerViews.forEach(function(e){var t=n.get(e.layer);t&&r.push(e.highlight(t))})}return{remove:function(){return r.forEach(function(e){return e.remove()})},pause:function(){return r.forEach(function(e){return e.pause()})},resume:function(){return r.forEach(function(e){return e.resume()})}}},t.prototype.getUsedMemory=function(){return this.componentLayerViews.reduce(function(e,t){return e+t.getUsedMemory()},0)},t.prototype.getUnloadedMemory=function(){return this.componentLayerViews.reduce(function(e,t){return e+t.getUnloadedMemory()},0)},t.prototype.ignoresMemoryFactor=function(){return!1},n([c.property()],t.prototype,"layer",void 0),n([c.property()],t.prototype,"componentLayerViews",void 0),n([c.property()],t.prototype,"groupLayerViews",void 0),n([c.property({readOnly:!0,dependsOn:["layer.filters","layer.activeFilterId"]})],t.prototype,"filterExpression",null),n([c.property(v.updatingPercentage)],t.prototype,"updatingPercentage",void 0),n([c.property({readOnly:!0})],t.prototype,"updatingPercentageValue",null),n([c.subclass("esri.views.3d.layers.BuildingSceneLayerView3D")],t)}(c.declared(h.LayerView3D(m)))}.apply(null,i))||(e.exports=n)},2564:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(2),r(1),r(10),r(11),r(97),r(14),r(6),r(9),r(7),r(0),r(635),r(117),r(2076),r(1780),r(1641),r(1760),r(1761),r(1657)],void 0===(n=function(e,t,r,i,n,o,s,a,p,l,u,d,c,f,y,h,g,v,m,w,x){var b=l.getLogger("esri.views.3d.layers.BuildingComponentSublayerView3D"),F=w.defineFieldProperties();return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerView=null,t._elevationContext="scene",t._isIntegratedMesh=!1,t.lodFactor=1,t.progressiveLoadFactor=1,t}return i(t,e),t.prototype.initialize=function(){var e=this;this._layerUid=this.layer.layer.uid,this.updatingHandles.add(this,"layer.renderer",function(){return e._updateRequiredFields()}),this.updatingHandles.add(this,"definitionExpressionFields",function(){return e._updateRequiredFields()}),this.updatingHandles.add(this,"filterExpressionFields",function(){return e._updateRequiredFields()}),this.updatingHandles.add(this.layer,"renderer",function(t){return e._rendererChange(t)},2),this.updatingHandles.add(this,"parsedDefinitionExpression",function(){return e._filterChange()}),this.updatingHandles.add(this,"parsedFilterExpression",function(){return e._filterChange()}),this.addResolvingPromise(this._updateRequiredFields())},Object.defineProperty(t.prototype,"parsedFilterExpression",{get:function(){if("Overview"===this.layer.modelName)return null;if(u.isNone(this.layerView.filterExpression))return null;var e;try{e=f.WhereClause.create(this.layerView.filterExpression,this.layer.fieldsIndex)}catch(e){return b.error("Failed to parse filterExpression: "+e),null}if(!e.isStandardized)return b.error("filterExpression is using non standard function"),null;var t=[],r=e.fieldNames;return v.findFieldsCaseInsensitive(r,this.layer.fields,{missingFields:t}),t.length>0?(b.error("filterExpression references unknown fields: "+t.join(", ")),null):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterExpressionFields",{get:function(){if(this.parsedFilterExpression){var e=this.parsedFilterExpression.fieldNames;return v.findFieldsCaseInsensitive(e,this.layer.fields)}return null},enumerable:!0,configurable:!0}),t.prototype._createLayerGraphic=function(e){var t=new a(null,null,e);return t.layer=this.layer.layer,t.sourceLayer=this.layer,t},t.prototype.canResume=function(){return this.inherited(arguments)&&(!this._controller||this._controller.rootNodeVisible)},t.prototype.isUpdating=function(){return this.updatingMeshView3D},t.prototype.fetchPopupFeatures=function(e,t){return s(this,void 0,void 0,function(){var e,r,i,n,s,a,p,l,c;return o(this,function(o){switch(o.label){case 0:return(e=this._validateFetchPopupFeatures(t))?[2,d.reject(e)]:u.isSome(t)&&t.clientGraphics&&0!==t.clientGraphics.length?(r=[],i=[],s=y.unpackFieldNames,a=[this.layer.fields],[4,x.getRequiredFields(this.layer,x.getFetchPopupTemplate(this.layer,t))]):[2,[]];case 1:for(n=s.apply(void 0,a.concat([o.sent()])),p=0,l=t.clientGraphics;p<l.length;p++)c=l[p],y.featureHasFields(n,c)?r.push(c):i.push(c);return 0===i.length?[2,d.resolve(r)]:[2,this.whenGraphicAttributes(i,n).catch(function(){return i}).then(function(e){return r.concat(e)})]}})})},t.prototype._updateRequiredFields=function(){return s(this,void 0,void 0,function(){var e,t,r,i;return o(this,function(n){switch(n.label){case 0:return t=y.fixFields,r=[this.layer.fields],this.layer.renderer?[4,this.layer.renderer.getRequiredFields(this.layer.fields)]:[3,2];case 1:return i=n.sent(),[3,3];case 2:i=[],n.label=3;case 3:return e=t.apply(void 0,r.concat([i.concat(this.definitionExpressionFields||[],this.filterExpressionFields||[])])),this._set("requiredFields",e),[2]}})})},t.prototype._validateFetchPopupFeatures=function(e){var t=this.layer;return t.popupEnabled?x.getFetchPopupTemplate(t,e)?void 0:new p("buildingscenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:t}):new p("buildingscenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:t})},t.prototype.getFilters=function(){var e=this.inherited(arguments);return this.addSqlFilter(e,this.parsedFilterExpression,this.filterExpressionFields,this.logError),this.addSqlFilter(e,this.parsedDefinitionExpression,this.definitionExpressionFields,this.logError),e},n([c.property()],t.prototype,"layer",void 0),n([c.property()],t.prototype,"layerView",void 0),n([c.property({dependsOn:["updatingMeshView3D"]})],t.prototype,"updating",void 0),n([c.property({dependsOn:["_controller.rootNodeVisible"]})],t.prototype,"suspended",void 0),n([c.property({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.3dObject.lodFactor"})],t.prototype,"lodFactor",void 0),n([c.property({readOnly:!0,dependsOn:["layerView.filterExpression","layer.fieldsIndex"]})],t.prototype,"parsedFilterExpression",null),n([c.property({type:[String],readOnly:!0,dependsOn:["parsedFilterExpression"]})],t.prototype,"filterExpressionFields",null),n([c.property(F.requiredFields)],t.prototype,"requiredFields",void 0),n([c.property(F.availableFields)],t.prototype,"availableFields",void 0),n([c.subclass("esri.views.3d.layers.BuildingComponentSublayerView3D")],t)}(c.declared(m.DefinitionExpressionSceneLayerView(g.I3SMeshView3D(h))))}.apply(null,i))||(e.exports=n)},2565:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(2),r(1),r(0),r(2076)],void 0===(n=function(e,t,r,i,n,o,s){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),n([o.subclass("esri.views.3d.layers.BuildingGroupSublayerView3D")],t)}(o.declared(s))}.apply(null,i))||(e.exports=n)}}]);